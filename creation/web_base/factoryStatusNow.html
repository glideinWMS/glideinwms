<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<script type="text/javascript" src="jslibs/factory_support.js"></script>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title id="brtitle">Glidein</title>

<script type="text/javascript">

var browser_title = "Glidein Factory Status";
var page_title = "Glidein Factory Status";
set_title_and_footer(browser_title, page_title);

var trColumnId; 
var prTr;        
var hover; 
var loading; 
var frontEndTable; 
var linkShown = 0; 
var loading = 1; 
var updating = 0; 
var col; 
var feArryMaster = new Array(); 
var thead; 
var updated; 
var numberRows = 0; 
var totalEntries; var totalEntriesMaster; var totalEntriesP; var totalEntriesPMaster;
var total; var totalP; var totalMaster; var totalPMaster;
var feEntries; var feEntriesP; var feTotal; var feTotalP;  
var sorted = 0;
var previousSort;
var currentSort; 
var frontEnds; 
var listMade = 0; 
var frontEnd = 0;
var table; var trTable; var tableP; 
var select;
var nameLast;
var txt2 = new Array(1000); 
var count = 0; 
var tableMade = 0;  
var sortColNum = 0; 
var active = 0; 
var entryName; 
var troubleshoot = 0; 
var childView;
var frontEndName;  
var trTable; 
var diffSorted; var diffSortedPrTr; var diffColName;
var tempTotal = new Array(); var tempTotalP = new Array();
var tempTotalEntries = new Array();; var tempTotalEntriesP = new Array(); 
var diffColNum; var diffColSort; 
var trSortColNum;  
var trSortAsc;
var periodV; 
var feChild; var feStatChild; var feReqChild; var feCMChild; var totChild; var dtChild; var ftFEChild; var totStatChild; var totReqChild; var totCMChild; 
var trChildArry = new Array(); var trFEChildArry = new Array();

var headColArry = new Array("Entry Name", "Status", "Running", "Idle", "Waiting", "Pending", "Staging in", "Staging out", "Unknown", "Held",
							"Max run", "Idle", 
							"Claimed", "User run here", "User running","Unmatched", "User idle", "Registered", "Info age");

var headColArryPR = new Array("Entry Name", "Running", "Idle", "Waiting", "Pending", "Staging in", "Staging out", "Unknown", "Held",
							  "Max run", "Idle", 
							  "Claimed", "User run here", "User running", "Unmatched", "User idle", "Registered", "Info age");		
												
var headColArryTR = new Array("Entry Name", "Downtime: Status", "Status: Running", "Client: Registered", "Diff(Status: Running, Client: Registered)", "Status: Idle", 
							  "Requested: Idle", "Diff(Status: Idle, Requested: Idle)", "Client: User Idle");	
							  
var headColArryTRPR = new Array("Entry Name", "Period", "Status: Running", "Client: Registered", "Diff(Status: Running, Client: Registered)", "Status: Idle", 
							    "Requested: Idle", "Diff(Status: Idle, Requested: Idle)", "Client: User Idle");

								 
var columnArray = new Array("entryName", "downtimeStatus","statusRunning", "statusIdle", "statusWait", "statusPending", "statusStageIn", "statusStageOut", "statusOther", 
						    "statusHeld", "requestMax", "requestIdle", "cmGlideinRunning", "cmGlideinJobsRunning", "cmGlideinJobsRunHere", "cmGlideinIdle", 
							"cmGlideinJobsIdle", "cmGlideinTotal", "cmGlideinInfoAge");
		
var exactColumns = new Array("Entry Name", "Downtime: Status", "Status: Running", "Status: Idle", "Status: Waiting", "Status: Pending", "Status: Stage in",
						     "Status: Stage out", "Status: Unknown", "Status: Held", "Requested: Max run", "Requested : Idle", "Client Monitor: Claimed", 
							 "Client Monitor: User Run Here", "Client Monitor: User Running", "Client Monitor: Unmatched", "Client Monitor: User idle",
							 "Client Monitor: Registered", "Client Monitor: Info age");  
							 
var exactColumnsTR = new Array("Entry Name", "Downtime: Status", "Status: Running", "Client Monitor: Registered", "Diff(Status: Running, Client: Registered)", 
							   "Status: Idle", "Requested: Idle", "Diff(Status: Idle, Requested: Idle)", "Client Monitor: User Idle");
							   
							   
var xmlAttPeriodArry = new Array("EntryName", "StatusRunning", "StatusIdle", "StatusWait", "StatusPending", "StatusStageIn", "StatusStageOut","StatusIdleOther", 
								 "StatusHeld", "ReqMaxRun", "ReqIdle", "ClientGlideRunning", "ClientJobsRunHere", "ClientJobsRunning", "ClientGlideIdle", 
								 "ClientJobsIdle", "ClientGlideTotal",  "ClientInfoAge"); /* ONE LESS ATT THAN DEFAULT */ 
								 
var xmlAttDTArry = new Array("Status"); 						 					
var xmlAttStatusArry = new Array("Running", "Idle", "Wait", "Pending", "StageIn", "StageOut", "IdleOther", "Held");
var xmlAttReqArry = new Array("MaxRun", "Idle"); 
var xmlAttCMArry = new Array("GlideRunning", "JobsRunHere", "JobsRunning", "GlideIdle", "JobsIdle", "GlideTotal", "InfoAge");
var xmlAttStatNumArry = new Array(); 
var xmlAttReqNumArry = new Array(); 
var xmlAttCMNumArry = new Array(); 
var xmlAttDTNumArry = new Array(); 
var FExmlAttStatNumArry = new Array(); 
var FExmlAttReqNumArry = new Array(); 
var FExmlAttCMNumArry = new Array();
var xmlAttPeriodNumArry = new Array();
var xmlAttTotalNumArry = new Array();            
var preFrontEndName = "Total"; 
var links = new Array(); 
var sortColName; 

/* HOVER POP UPS : TOTAL/ANY OF DEFAULT OR TROUBLESHOOT VIEW */
function showPopUp(hoveritem)
{	
	/* RETURN IF IN INCOMPTBLE VIEW */
	if(preFrontEndName != "Total" && preFrontEndName != "Any"){return;} 
	
	column = hoveritem.cellIndex; /* GET COL NUM */
	row = hoveritem.id;           /* GET ROW NUM */
		
	/* IF OLD HOVER POP UP EXISTS GET RID OF IT */
	if(frontEndTable){document.getElementById('hoverpopup').removeChild(frontEndTable);}
	
	/* ADJUST ENTRY ARRAY FOR DIFFSORTED TR VIEW */
	if(diffSorted && troubleshoot)
	{
		friend = totalEntries; 
		totalEntries = tempTotalEntries; 
	}
	
	entry = totalEntries[row - 1]; /* RETREIVE CURR ENTRY */
	
	/* SET UP POP UP BODY */
	frontEndTable = document.createElement('table'); 
	hover = document.getElementById("hoverpopup");
	head = document.getElementById("header");
    scrollDiv = document.getElementById("scroll"); 

	/* IF NO FE's EXIST */
	if(entry.childNodes[totChild].childNodes.length == 0)
	{
		
		/* POP UP TEXT CONTENTS */
		nameTxtNode = document.createTextNode(totalEntries[row - 1].attributes.getNamedItem("name").firstChild.data);
		if(troubleshoot)
			attTxtNode = document.createTextNode(exactColumnsTR[column]);
		else
			attTxtNode = document.createTextNode(exactColumns[column]);
		NFE = document.createTextNode("No Frontends Exist");

		/* BUILD POP UP TABLE */
		for(i = 0; i < 3; i++)
		{
			tr = document.createElement('tr');
			td = document.createElement('td');
			if(i == 0)  td.appendChild(nameTxtNode); 
			else if(i == 1) td.appendChild(attTxtNode);
		    else td.appendChild(NFE); 
			tr.appendChild(td);
			frontEndTable.appendChild(tr);
		}

		hover.appendChild(frontEndTable); 
		
		/* ADJUST POP UP POSITION */
		if(troubleshoot)
			hover.style.top = head.offsetTop + hoveritem.offsetTop - 45 - scrollDiv.scrollTop + "px";
		else
			hover.style.top = head.offsetTop + hoveritem.offsetTop - 15 - scrollDiv.scrollTop + "px";
		if(column == 16)
			hover.style.left = hoveritem.offsetLeft - 90 + "px";
		else
			hover.style.left = hoveritem.offsetLeft - 70 + "px";
		hover.style.visibility = "Visible";
		return; 
	}

	/* SET UP POP UP BODY */
	tr1 = document.createElement('tr'); tr2 = document.createElement('tr'); 
	td1 = document.createElement('td'); td2 = document.createElement('td');
	td3 = document.createElement('td'); td4 = document.createElement('td');
	nameTxtNode = document.createTextNode(totalEntries[row - 1].attributes.getNamedItem("name").firstChild.data);
	if(troubleshoot)
		attTxtNode = document.createTextNode(exactColumnsTR[column]);
	else
		attTxtNode = document.createTextNode(exactColumns[column]);
	
	/* ADJUST COLUMN IF IN TR VIEW */
	if(troubleshoot)
	{
		if(column == 3) column = 17; 
		else if(column == 5) column = 3; 
		else if(column == 6) column = 11; 
		else if(column == 8) column = 16; 
		else if(column == 4)
		{
			child1 = feStatChild;
			child2 = feCMChild;
			att1 = 4;
			att2 = 2;
		}
		else if(column == 7)
		{
			child1 = feStatChild;
			child2 = feReqChild; 
			att1 = 1; 
			att2 = 0; 
		}
	}
	
	/* SET UP POP UP (CONTINUED)*/
	td1.appendChild(nameTxtNode); td2.appendChild(attTxtNode);
	tr1.appendChild(td1); tr2.appendChild(td2);
	tr1.appendChild(td3); tr2.appendChild(td4);
	frontEndTable.appendChild(tr1);
	frontEndTable.appendChild(tr2);

	/* # OF FE's FOR CURR ENTRY (EACH ENTRY HAS DIFF # OF FE's) */
	numFE = totalEntries[row -1].childNodes[feChild].childNodes.length; 
	/* ARRAY OF FE's FOR CURR ENTRY */
	ends = totalEntries[row -1].childNodes[feChild];                    
	
	unsortedFE = new Array(); 
	sortedFE = new Array();
	
	 /* FILL ARRY WITH ENTRIES FE's */
	for(i = 1; i < numFE; i+=2) unsortedFE.push(ends.childNodes[i]);
	 
	/* SORT ENTRIES FE ORDER TO BE CONSISTENT (DROP DOWN LIST ORDER) */
	for(i = 0; i< feArryMaster.length; i++)
	{
		for(j = 0; j < unsortedFE.length; j++)
		{
			if(feArryMaster[i].attributes[0].value == unsortedFE[j].attributes[0].value)
				sortedFE.push(unsortedFE[j]); 	
		}
	} 
	/* IF ENTRY HAS NO FE's */
	if(numFE == 0)
	{
		tr3 = document.createElement('tr');
		td3 = document.createElement('td'); 
		cont3 = document.createTextNode("No Frontends Exist");
		td3.appendChild(cont3);
		tr3.appendChild(td3);
		frontEndTable.appendChild(tr3);
	}
	/* FE's EXIST */
	else
	{   i = 0;
		x = 0;
		/* FOR EVERY FE THAT THE ENTRY HAS */
		while(i < sortedFE.length)
		{ 
			tr = document.createElement('tr'); 
			td = document.createElement('td'); 
			txt = document.createTextNode(sortedFE[i].attributes[0].value + ":");
			td2 = document.createElement('td');
			
			/* DOWNTIME FIELD */
			if(column == 1)
			{
				y = sortedFE[i].childNodes[feDTChild].attributes[xmlAttDTNumArry[column - 1]].value; 
				if(y == "True"){ y = "&darr;"; table.rows[i].cells[1].style.color = "#B0171F";} /* DOWN ARROW*/
				else {y = "&uarr;"; table.rows[i].cells[1].style.color = "#008B00";  }          /* UP ARROW */
				txt2 = document.createTextNode("");
				td2.innerHTML = y;
			}
			/* DIFF COLS (TROUBLESHOOT) */
			else if((column == 4 || column == 7) && troubleshoot)
			{
				val1 = 0; val2 = 0; diff = 0; 
				try{ val1 = parseInt(sortedFE[i].childNodes[child1].attributes[att1].value); } catch(err){}
				try{ val2 = parseInt(sortedFE[i].childNodes[child2].attributes[att2].value); } catch(err){}
				diff = val1 - val2; 
				txt2 = document.createTextNode(diff);
			}
			/* STATUS COLS */
			else if(column > 1 && column < 10)
			{
				try{ txt2 = document.createTextNode(sortedFE[i].childNodes[feStatChild].attributes[xmlAttTotalNumArry[column - 1]].value);}
				catch(err){ txt2 = document.createTextNode(0);}
			} 
			/* REQ COLS */
			else if(column == 10 || column == 11)
			{
				try{ txt2 = document.createTextNode(sortedFE[i].childNodes[feReqChild].attributes[xmlAttTotalNumArry[column - 1]].value);}
				catch(err){ txt2 = document.createTextNode(0); }
			}
			/* CM COLS */
			else	
			{
				try{ txt2 = document.createTextNode(sortedFE[i].childNodes[feCMChild].attributes[xmlAttTotalNumArry[column - 1]].value);}
				catch(err){ txt2 = document.createTextNode(0);}
			}
 	
			td.appendChild(txt); 
			tr.appendChild(td);
			td2.appendChild(txt2);
			td2.setAttribute('align', 'right');  
			tr.appendChild(td2); 
			frontEndTable.appendChild(tr); 
			i++; 
			if(i > 1)
			{
				x++; /* INCREMENT COUNTER TO ADJUST FE HOVER UP BELOW */
			}
		}	
	}
	/* ADJUST POP UP POSITION AND VISIBILITY */
	hover.appendChild(frontEndTable);
	if(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data.length > 26 && column == 15){hover.style.left = hoveritem.offsetLeft - 150 + "px";}
	else if(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data.length > 31 && column == 16){hover.style.left = hoveritem.offsetLeft - 190 + "px";}
	else if(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data.length > 21 && column == 16){hover.style.left = hoveritem.offsetLeft - 130 + "px";}
	else hover.style.left = hoveritem.offsetLeft - 110 + "px";
	if(troubleshoot){hover.style.top = head.offsetTop + hoveritem.offsetTop - 45 - (30 * x) - scrollDiv.scrollTop + "px";}
	else hover.style.top = head.offsetTop + hoveritem.offsetTop - 20 - (25 * x) - scrollDiv.scrollTop + "px";	
	hover.style.visibility = "Visible";	
	if(diffSorted && troubleshoot){totalEntries = friend;}
}

/* POP UPS FOR PERIOD TABLES (PR || PR + TR) */
function showPopUpPeriod(hoveritem)
{
	diffCol = 0; dCol = 0; dCol2 = 0; 
    prFEChild = 0; child1 = 0; 
	child2 = 0; att1 = 0; 
	att2 = 0; pr = 0;
	timeFrame = " (Now)"; 
	
	/* IF NOT IN TOTAL VIEW ESCAPE */
	if(preFrontEndName != "Total" && preFrontEndName != "Any"){return;}
	
	/* RETRIEVE SELECTED SPECS */
	row = hoveritem.id; row--; 
	if(prTr){row++;}
	column = hoveritem.cellIndex; 
	column--; /* ADJUST BECAUSE DOWNTIME */ 
	if(row % 4 != 0) column++;
	row2 = Math.floor(row/4);
	if(periodV && (column == 0 || column == 1) && row % 4 != 0){ return; }   /* GET OUT DOWNTIME + PERIOD */
	else if(prTr && ((column == 1 && row % 4 != 0) || (column == 1 && row % 4 == 0))){ return; }                     /* GET OUT DOWNTIME + PERIOD + TR */
	else if(column == 0 && periodV){ column++; }                                        /* ADJUST FOR DOWNTIME */
			
	/* ASSIGN CHILD NODES ACCORDING TO TIME SPANS */
	if(row/4 != row2)
	{ 
		if((row - 1)/4 - row2 == 0)
		{
			timeFrame = " (2 Hours)"; pr = 3;  
		}
		else if((row - 1)/4 - row2 == 0.25)
		{
			timeFrame = " (24 Hours)"; pr = 5;
		}
		else
		{
			timeFrame = " (7 Days)"; pr = 1;
		}
	}
	
	/* CALCULATE ROW */
	row = Math.floor(row/4); 
	
	/* ADJUST COL IF IN PERIOD VIEW */
	if(periodV){ column--; } 
	
	/* ADJUST COLS FOR PERIOD + TROUBLESHOOT VIEW */
	if(prTr)
	{
		/* STAT RUNNING */ if(column == 2){ column = 1;}
		/* CM REG */       else if(column == 3){ column = 16;}
		/* STAT IDLE */    else if(column == 5){ column = 2;}
		/* REQ IDLE */     else if(column == 6){ column = 10;}
		/* CM USER IDLE */ else if(column == 8){ column = 15; }
		
		/* DIFF COL 1 */ else if(column == 4){ diffCol = 1; dCol = 1; dCol2 = 16;}
		/* DIFF COL 2 */ else if(column == 7){ diffCol = 2; dCol = 2; dCol2 = 10;}
	}
 	 
	/* IF HOVER EXISTS REMOVE */
	if(frontEndTable){ document.getElementById('hoverpopup').removeChild(frontEndTable);}

	entry = tempTotalEntries[row];                     /* GET CURR ENTRY */
	frontEndTable = document.createElement('table');
	hover = document.getElementById("hoverpopup");
	head = document.getElementById("header");
    scrollDiv = document.getElementById("scroll"); 
	
	/* IF NO FE's EXIST */
	if(entry.childNodes[totChild].childNodes.length == 0)
	{
		/* POP UP TEXT CONTENTS */
		nameTxtNode = document.createTextNode(tempTotalEntries[row].attributes.getNamedItem("name").firstChild.data);
		
		if(!diffCol)
			attTxtNode = document.createTextNode(exactColumns[column + 1] + timeFrame);
		else if(diffCol == 1)
			attTxtNode = document.createTextNode("Diff(Status: Running, Client: Registered) " + timeFrame);
		else
			attTxtNode = document.createTextNode("Diff(Status: Idle, Requested: Idle) " + timeFrame);
			
		NFE = document.createTextNode("No Frontends Exist");

		/* BUILD POP UP TABLE */
		for(i = 0; i < 3; i++)
		{
			tr = document.createElement('tr');
			td = document.createElement('td');
			if(i == 0)  td.appendChild(nameTxtNode); 
			else if(i == 1) td.appendChild(attTxtNode);
		    else td.appendChild(NFE); 
			tr.appendChild(td);
			frontEndTable.appendChild(tr);
		}

		hover.appendChild(frontEndTable);
		
		/* ADJUST POSITION AND VISIBILITY */
		if(!prTr)
			hover.style.top = head.offsetTop + hoveritem.offsetTop - 15 - scrollDiv.scrollTop + "px";
		else
			hover.style.top = head.offsetTop + hoveritem.offsetTop - 25 - scrollDiv.scrollTop + "px";
		if(column == 18)
			hover.style.left = hoveritem.offsetLeft - 90 + "px";
		else
			hover.style.left = hoveritem.offsetLeft - 70 + "px";
		hover.style.visibility = "Visible";
		return; 
	}

	hover.appendChild(frontEndTable); 
	tr1 = document.createElement('tr'); tr2 = document.createElement('tr'); 
	td1 = document.createElement('td'); td2 = document.createElement('td');
	td3 = document.createElement('td'); td4 = document.createElement('td');
	cont = document.createTextNode(tempTotalEntries[row].attributes.getNamedItem("name").firstChild.data);
	
	if(!diffCol)
		cont2 = document.createTextNode(exactColumns[column + 1] + timeFrame);
	else if(diffCol == 1)
		cont2 = document.createTextNode("Diff(Status: Running, Client: Registered) " + timeFrame);
	else
		cont2 = document.createTextNode("Diff(Status: Idle, Requested: Idle) " + timeFrame);
	
	td1.appendChild(cont); 
	td2.appendChild(cont2);
	tr1.appendChild(td1);
	tr2.appendChild(td2);
	tr1.appendChild(td3);
	tr2.appendChild(td4);
	frontEndTable.appendChild(tr1);
	frontEndTable.appendChild(tr2);

	numFE = tempTotalEntries[row].childNodes[feChild].childNodes.length; /* How many front ends the specified entry has. */
	ends = tempTotalEntries[row].childNodes[feChild];                    /* The front ends the specifed entry has. */
	unsortedFE = new Array(); 
	sortedFE = new Array();

	/* FILL ARRAY WITH ENTRIES FE's */
	for(i = 1; i < numFE; i+=2) unsortedFE.push(ends.childNodes[i]); 
	
	/* SORT ENTRIES FE ORDER TO BE CONSISTENT */
	for(i = 0; i< feArryMaster.length; i++)
	{
		for(j = 0; j < unsortedFE.length; j++)
		{
			if(feArryMaster[i].attributes[0].value == unsortedFE[j].attributes[0].value)
			{
				sortedFE.push(unsortedFE[j]); 	
			}
		}
	}
	/* NO FE's EXIST */
	if(numFE == 0)
	{
		tr3 = document.createElement('tr');
		td3 = document.createElement('td'); 
		cont3 = document.createTextNode("No Frontends Exist");
		td3.appendChild(cont3);
		tr3.appendChild(td3);
		frontEndTable.appendChild(tr3);
	}
	/* FE's EXIST */
	else
	{   i = 0;
		x = 0; 
		while(i < sortedFE.length)
		{ 
			if(pr)
			{
				for(j = 1; i < tempTotalEntriesP[row].childNodes[3].childNodes.length; j+=2)
				{
					if(tempTotalEntriesP[row].childNodes[3].childNodes[j].attributes[0].value == ("frontend_" + sortedFE[i].attributes[0].value))
					{
						prFEChild = j; break;  
					}
				}
			}
			tr = document.createElement('tr'); 
			td = document.createElement('td'); 
			txt = document.createTextNode(sortedFE[i].attributes[0].value + ":");
			td2 = document.createElement('td');

			/* DOWNTIME */
			if(column == 0)
			{
				y = sortedFE[i].childNodes[feDTChild].attributes[xmlAttDTNumArry[column]].value; 
				/* DOWN ARROW*/
				if(y == "True")
				{
					if(periodV){ y = "&darr;"; tableP.rows[i].cells[1].style.color = "#B0171F";}
					else if(prTr){ y = "&darr;"; trpr_Table.rows[i].cells[1].style.color = "#B0171F";}
				} 
				/* UP ARROW */
				else
				{
					if(periodV){ y = "&uarr;"; tableP.rows[i].cells[1].style.color = "#008B00";}
					else if(prTr){  y = "&uarr;"; trpr_Table.rows[i].cells[1].style.color = "#008B00";}
				}          
				txt2 = document.createTextNode("");
				td2.innerHTML = y;
			}
			/* DIFF COLUMN */
			else if(diffCol)
			{
				if(!pr)
				{
					/* FIRST DIFF COL */
					if(diffCol == 1)
					{						
						txt2 = document.createTextNode(sortedFE[i].childNodes[trFEChildArry[0]].attributes[xmlAttTotalNumArry[dCol]].value - 
						sortedFE[i].childNodes[trFEChildArry[1]].attributes[xmlAttTotalNumArry[dCol2]].value);
					
					}
					/* 2ND DIFF COL */
					else
					{
						txt2 = document.createTextNode(sortedFE[i].childNodes[trFEChildArry[3]].attributes[xmlAttTotalNumArry[dCol]].value - 
						sortedFE[i].childNodes[trFEChildArry[4]].attributes[xmlAttTotalNumArry[dCol2]].value);
					}
				}
				else
				{
					txt2 = document.createTextNode(Math.round((tempTotalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[xmlAttPeriodNumArry[dCol - 1]].value - tempTotalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[xmlAttPeriodNumArry[dCol2 - 1]].value) * 100)/100);}
				}
			/* STATUS */
			else if(column < 9)
			{
				if(sortedFE[i].childNodes.length >= 7)				 
				{
					if(!pr){txt2 = document.createTextNode(sortedFE[i].childNodes[feStatChild].attributes[xmlAttTotalNumArry[column]].value);}
					else{txt2 = document.createTextNode(Math.round(tempTotalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[xmlAttPeriodNumArry[column - 1]].value * 100)/100);}
				}
				else
					txt2 = document.createTextNode(0);
			} 
			/* REQ */
			else if(column == 9 || column == 10)
			{
				if(sortedFE[i].childNodes.length >= 5)
				{
					if(!pr){txt2 = document.createTextNode(sortedFE[i].childNodes[feReqChild].attributes[xmlAttTotalNumArry[column]].value);}
					else{txt2 = document.createTextNode(Math.round(tempTotalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[xmlAttPeriodNumArry[column - 1]].value * 100)/100);}
				}
				else
					txt2 = document.createTextNode(0);
			}
			/* CM */
			else	
			{
				if(sortedFE[i].childNodes.length >= 3)
				{
					if(!pr){txt2 = document.createTextNode(sortedFE[i].childNodes[feCMChild].attributes[xmlAttTotalNumArry[column]].value);}
					else{txt2 = document.createTextNode(Math.round(tempTotalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[xmlAttPeriodNumArry[column - 1]].value * 100)/100);}
				}
				else
					txt2 = document.createTextNode(0);
			}
			td.appendChild(txt); 
			tr.appendChild(td);
			td2.appendChild(txt2);
			td2.setAttribute('align', 'right');  
			tr.appendChild(td2); 
			frontEndTable.appendChild(tr); 
			i++; 
			if(i > 1) x++; 
		}	
	}
	
	/* ADJUST POSITION & VISIBILITY OF POP UP */
	hover.appendChild(frontEndTable);
	if(tempTotalEntries[row].attributes.getNamedItem("name").firstChild.data.length > 26 && column == 15){hover.style.left = hoveritem.offsetLeft - 150 + "px";}
	else if(tempTotalEntries[row].attributes.getNamedItem("name").firstChild.data.length > 31 && column == 16){hover.style.left = hoveritem.offsetLeft - 190 + "px";}
	else if(tempTotalEntries[row].attributes.getNamedItem("name").firstChild.data.length > 21 && column == 16){hover.style.left = hoveritem.offsetLeft - 130 + "px";}
	else hover.style.left = hoveritem.offsetLeft - 110 + "px";
	if(!prTr)
		hover.style.top = head.offsetTop + hoveritem.offsetTop - 20 - (25 * x) - scrollDiv.scrollTop + "px";
	else
		hover.style.top = head.offsetTop + hoveritem.offsetTop - 25 - (30 * x) - scrollDiv.scrollTop + "px";
	hover.style.visibility = "Visible";	
}

/* ONMOUSE OUT REMOVE POP UP */
function hidePopUp()
{
	if(preFrontEndName != "Total" && preFrontEndName != "Any") return; 
	hover = document.getElementById("hoverpopup");
	hover.style.visibility = "Hidden";
}

/* SHOW TIME DURING FILL IN TIME */
function showTime()
{
	updated = updated[0].childNodes[1].attributes[3].firstChild.value;	
	document.getElementById("update").innerHTML= "XML last update:   " + updated; 	
}

/* RESTORE TO DEFAULT SORT */
function sortAlphabetical()
{	
	if(!sorted && !diffSorted){ return; } /* IF NOT SORTED RETURN */
	trSortAsc = 0; diffSorted = 0; 
	sorted = 0; currentSort; sortColNum = -2; 
	sortSignal(); /* REMOVE COLORED COL */ 
	
	/* REMOVE TROUBLESHOOT TABLE */
	if(troubleshoot){troubleshooting(); troubleshoot = 1;}
	
	/* REMOVE TR + PERIOD TABLE */
	if(prTr){periodTrView(); prTr = 1;}

	/* REMOVE PERIOD */
	if(periodV){period(); periodV = 1;}
	
	/* TOTAL VIEW? */
	if(frontEnd == 0)
	{
		/* Reset everything for regular table. */
		totalEntries = totalEntriesMaster;
		total = totalMaster; 
		totalEntriesP = totalEntriesPMaster;
		totalP = totalPMaster; 
		numberRows = totalEntries.length;
		
		/* ACIVE? */
		if(active)
		{	
			active = 0; 
			friend = troubleshoot; troubleshoot = 0; 
			friend2 = periodV; periodV = 0; 
			friend3 = prTr; prTr = 0;
			selectActive(); 
			troubleshoot = friend; 
			periodV = friend2; 
			prTr = friend3; 
		} 
		
		/* RESTORE DEFAULT TABLE */
		fillIn();
		
		/* RESTORE PERIOD VIEW */ 
		if(periodV){periodV = 0; period(); fillInPeriod();}
		
		/* RESTORE TR + PERIOD TABLE */
		if(prTr){prTr = 0; periodTrView(); }
		
		/* RESTORE TROUBLESHOOT VIEW */
		if(troubleshoot){ troubleshoot = 0; troubleshooting(); }
	}
	/* FE OR ANY VIEW */ 
	else 
	{
		friend = troubleshoot; troubleshoot = 0; 
		friend2= prTr; prTr = 0;
		friend3 = periodV; periodV = 0; 
		friend4 = active; active = 0; 
		loadFrontEnd(nameLast);        /* LOAD CORRESPONDING FE (OR ANY) */
		troubleshoot = friend;
		prTr = friend2; 
		periodV = friend3; 
		active = friend4; 
		
		/* LOAD ACTIVE ENTRIES */
		if(active)
		{	
			active = 0; 
			friend = troubleshoot; troubleshoot = 0; 
			friend2 = periodV; periodV = 0; 
			friend3 = prTr; prTr = 0;
			selectActive(); 
			troubleshoot = friend; 
			periodV = friend2;
			prTr = friend3;  
		} 
		
		/* RESTORE PERIOD VIEW */ 
		if(periodV){periodV = 0; period(); fillInPeriod();}
		
		/* RESTORE TR + PERIOD TABLE */
		if(prTr){prTr = 0; periodTrView(); }
		
		/* RESTORE TROUBLESHOOT VIEW */
		if(troubleshoot){ troubleshoot = 0; troubleshooting(); }
	}
}

/* BUILD (FE's + ANY) DROP DOWN LIST */
function makeList()
{
	feArry = new Array(); 
    feArryMaster = feArry; 
	
	/* REMOVE ALREADY MADE DROP DOWN LIST */
	if(select) document.getElementById('tempList').removeChild(select);

	select = document.createElement("select");
	select.setAttribute('id','choose');
	select.setAttribute("onchange", "loadFrontEnd(document.getElementById('choose').value)"); 
	def = document.createElement("option"); 
	defTxt = document.createTextNode("Total (Default)");
	any = document.createElement("option"); 
	anyTxt = document.createTextNode("Any");
	def.appendChild(defTxt); 
	select.appendChild(def); 
	any.appendChild(anyTxt); 
	select.appendChild(any); 
	
	/* GO THROUGH ALL POSSIBLE FE's & GET ALL DIFFERENT FE's */
	for(i = 0; i < frontEnds.length; i++)
	{
		if(i == 0)
		{
			feArry.push(frontEnds[i]); 
			fe = document.createElement("option"); 
			txt1 = frontEnds[i].attributes.getNamedItem("name").firstChild.data;
			feTxt = document.createTextNode(txt1);
			fe.appendChild(feTxt); 
			select.appendChild(fe); 
			continue; 	
		}
		/* CHECK IF CURR FE ALREADY EXISTS */
		for(j = 0; j < feArry.length; j++)
		{
			if(feArry[j].attributes.getNamedItem("name").firstChild.data == frontEnds[i].attributes.getNamedItem("name").firstChild.data)
			{
				break; 	
			}
			if(j == (feArry.length - 1) && feArry[j].attributes.getNamedItem("name").firstChild.data != frontEnds[i].attributes.getNamedItem("name").firstChild.data)
			{
				feArry.push(frontEnds[i]); 
				fe = document.createElement("option"); 
				txt2[count] = frontEnds[i].attributes.getNamedItem("name").firstChild.data;
				feTxt = document.createTextNode(txt2[count]);
				fe.appendChild(feTxt);		
				select.appendChild(fe); 
				count++; 	
				break; 
			}
		}
	}
	listMade = 1;
	document.getElementById('tempList').appendChild(select);
}

/* CHECK FOR URL ARGUMENTS */ 
function checkUrl()
{
	url = window.location.search;
	contents = new Array();
	ARGS = 0; 
	pairsEqSplit = new Array(); 
	 
	/* ARGUMENTS EXIST */
	if(url) 
	{
		url = url.substring(1); 
		pairsAndSplit = url.split("&");
	 
	    for (i = 0; i < pairsAndSplit.length; i++)
		{
        	pairsEqSplit[i] = pairsAndSplit[i].split("=");
   		}
		for(i = 0; i< pairsEqSplit.length; i++)
		{
			contents[i] = pairsEqSplit[i];
		}
		for(b = 0; b < contents.length; b++)
		{
			ARGS = contents[b];
			for(a = 0; a < ARGS.length; a++)
			{
				if(ARGS[a].search(/view/i) >= 0)
				{
					/* FE VIEW */
					for(z = 0; z < feArryMaster.length; z++)
					{
						if(ARGS[a+1].search(feArryMaster[z].attributes.getNamedItem("name").firstChild.data) >= 0)	
						{
							loadFrontEnd(feArryMaster[z].attributes.getNamedItem("name").firstChild.data);
							select.selectedIndex = z + 2;
							troubleshoot = 0; 
						}
					}
					/* ANY VIEW */
					if(ARGS[a+1].search(/any/i) >= 0)
					{
						loadFrontEnd("Any");
						select.selectedIndex++;
					}
					/* ACTIVE */
					if(ARGS[a+1].search(/active/i) >= 0)
					{
						active = 0; 
						selectActive();
						document.getElementById("active").checked = true;
					}
					/* PERIOD + TROUBLESHOOT */
					if(ARGS[a+1].search(/period/i) >= 0 && ARGS[a+1].search(/troubleshoot/i) >= 0)
					{
						periodTrView(); 
						document.getElementById("period").checked = true;
						document.getElementById("troubleshoot").checked = true; 
					}
					/* PERIOD */
					else if(ARGS[a+1].search(/period/i) >= 0)
					{
						period();
						document.getElementById("period").checked = true;
					}
					/* TROUBLESHOOT */
					else if(ARGS[a+1].search(/troubleshoot/i) >= 0)
					{
						troubleshooting();
						document.getElementById("troubleshoot").checked = true;
					}
					break; 
				}
				/*
				 * COLUMN SORT CONDITIONALS------------------------------------------------------------------------------
				 */
				if(ARGS[a].search(/sort/i) >= 0)
				{
					for(l = 0; l < columnArray.length; l++)
					{
						ARGS[a+1] = ARGS[a+1].toLowerCase(); 
						
						/* NORMAL COLUMN SORT */
						if(ARGS[a+1].search(columnArray[l].toLowerCase()) >= 0)
						{
							if(periodV){period(); periodV = 1;} /* Reset table. */
							/* REMOVE TROUBLESHOOT VIEW */
							if(troubleshoot)
							{
								troubleshooting();
								troubleshoot = 1;  
							}
							/* REMOVE PERIOD + TROUBLESHOOT VIEW */
							if(prTr){periodTrView(); prTr = 1;}
							friend = periodV; periodV = 0;
							sortTableDescending(l);
							periodV = friend; 
							if(troubleshoot)
							{
								troubleshoot = 0; 
								troubleshooting(); 
								trSortSignal(trSortColNum);
							}
							if(prTr)
							{
								prTr = 0; 
								periodTrView(); 
								trSortSignal(trSortColNum);
							}
							if(periodV){periodV = 0; period(); fillInPeriod();} /* Put period table back. */
							return;   
						}
						/* DIFFERENCE COLUMN SORT */
						else
						{
							if(troubleshoot || prTr)
							{				
								if(ARGS[a + 1] == "diff(status:running,client:registered)")
								{
									sortTrCol("Diff(Status: Running, Client: Registered)");
									trSortSignal(4 + prTr); /* +1 FOR EXTRA PERIOD COL */
									return; 	
								}
								else if(ARGS[a + 1] == "diff(status:idle,requested:idle)")
								{
									sortTrCol("Diff(Status: Idle, Requested: Idle)");
									trSortSignal(7 + prTr); /* +1 FOR EXTRA PERIOD COL */
									return; 	
								}
							}
						}
					}
				}
			}			
		}
	}
} 

/* CHANGE TO A FRONT END OR ANY VIEW */
function loadFrontEnd(name)
{
	frontEndName = name; 
	preFrontEndName = name;
	currChild = 1; 
	diffHold = diffSorted; 

	/* REMOVE PERIOD VIEW */
	if(periodV){temp = sorted; sorted = 0; period(); periodV = 1; sorted = temp;}
	
	/* REMOVE TROUBLESHOOT VIEW */ 
	if(troubleshoot){temp = sorted; sorted = 0; troubleshooting(); troubleshoot = 1; sorted = temp;}
	
	/* REMOVE TROUBLESHOOT + PERIOD VIEW */ 
	if(prTr){temp = sorted; sorted = 0; periodTrView(); prTr = 1; sorted = temp;}
	
	diffSorted = diffHold; 
	
	/* HARD CODE FOR DESCENDING SORT PURPOSES */
	if(diffSorted)
	{
		diffSorted = 1; 	
	}
	
	/* CHANGE BACK TO TOTAL VIEW  */
	if(name == "Total (Default)")
	{
		/* RESET */
		childView = null;  
		preFrontEndName = "Total"; 
		totalEntries = totalEntriesMaster; 
		total = totalMaster;
		totalEntriesP = totalEntriesPMaster; 
		totalP = totalPMaster;
		numberRows = totalEntries.length;
 		makeTable(); 
		frontEnd = 0;
		
		/* ASCENDING SORT */
		if(sorted == 1 && currentSort == "ascending")
		{
			tableMade = 0;
			sorted = 0; 
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				friend3 = prTr; prTr = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
				prTr = friend3; 
			} 
			friend = periodV; 
			periodV = 0; 
			sortTableDescending(sortColNum); 
			sortTableAscending(sortColNum);
			periodV = friend; 
			/* RESTORE TROUBLESHOOT VIEW */
			if(troubleshoot)
			{
				troubleshoot = 0; 	
				troubleshooting(); 
			}
			/* RESTORE TROUBLESHOOT + PERIOD VIEW */
			if(prTr)
			{
				prTr = 0; 	
				periodTrView(); 
			}
			/* RESTORE PERIOD VIEW */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return; 
		}
		/* DESCENDING SORT */
		else if(sorted == 1 && currentSort == "descending")
		{
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				friend3 = prTr; prTr = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2;
				prTr = friend3; 
			}
			tableMade = 0;
			sorted = 0;
			friend = periodV;
			periodV = 0; 
			sortTableDescending(sortColNum); 
			periodV = friend; 
			/* RESTORE TROUBLESHOOT VIEW */
			if(troubleshoot)
			{
				troubleshoot = 0; 	
				troubleshooting(); 
			} 
			/* RESTORE TROUBLESHOOT + PERIOD VIEW */
			if(prTr)
			{
				prTr = 0; 	
				periodTrView(); 
			}
			/* RESTORE PERIOD VIEW */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return; 
		}
		else 
		{	
			/* SET UP ACCORDING TO ACTIVE VIEW */
			if(active) 
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				friend3 = prTr; prTr = 0;
				diffHolder = diffSorted; diffSorted = 0;   
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2;
				prTr = friend3;
				
				/* RESTORE TROUBLESHOOT VIEW */
				if(troubleshoot)
				{
					troubleshoot = 0;	
					troubleshooting(); 
				}
				/* RESTORE TROUBLESHOOT + PERIOD VIEW */
				if(prTr)
				{
					prTr = 0;
					periodTrView(); 
				}  
				
				diffSorted = diffHolder; 
				
				/* SORT DIFF COLUMNS */
				if(diffSorted)
				{
					diffSorted--; 
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)");
					}
					else
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)");
					}
				}
				
			}
			else 
			{
				fillIn(); 
				diffHold = diffSorted; diffSorted = 0;   
				
				/* RESTORE TROUBLESHOOT VIEW */
				if(troubleshoot)
				{
					troubleshoot = 0;	
					troubleshooting(); 
				}
				/* RESTORE TROUBLESHOOT + PERIOD VIEW */
				if(prTr)
				{
					prTr = 0;
					periodTrView(); 
				}  
				
				diffSorted = diffHold; 
				
				/* SORT DIFF COLUMNS */
				if(diffSorted)
				{
					diffSorted--; 
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)");
					}
					else
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)");
					}
				}
			}
		}
	}
	else /* FRONTEND OR ANY */
	{
   		nameLast = name; 
		feEntries = new Array();
		feTotal = new Array();
		feEntriesP = new Array();
		feTotalP = new Array();
		
		/* RESET EVERYTHING  */
		totalEntries = totalEntriesMaster; 
		total = totalMaster; 
		totalEntriesP = totalEntriesPMaster; 
		totalP = totalPMaster; 
		tableMade = 0; 
				
		/* CREATE ANY VIEW */  
		if(name == "Any")
		{
			childView = null; 
			for(i = 0; i< totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[feChild].childNodes.length > 1)
				{
					if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes.length > 0)
					{
						feEntries.push(totalEntries[i]); 
						feTotal.push(total[i]);
						feEntriesP.push(totalEntriesP[i]); 
						feTotalP.push(totalP[i]); 
					}
				}
			}			
		}	
		else /* VIEW SPECIFIED FRONTEND */
		{
			for(i = 0; i< totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[feChild].childNodes.length != 0)
				{
					for(j = 1; j< totalEntries[i].childNodes[feChild].childNodes.length; j+=2)
					{
						if(totalEntries[i].childNodes[feChild].childNodes[j].attributes.getNamedItem("name").firstChild.data == name)
						{	
							childView = j; 
							feEntries.push(totalEntries[i]); 
							feTotal.push(totalEntries[i].childNodes[feChild].childNodes[j]); 
							feEntriesP.push(totalEntriesP[i]);
							feTotalP.push(totalEntriesP[i].childNodes[3].childNodes[j]);
						}
					}
				}
			}			
		}

		frontEnd = 1;
		totalEntries = feEntries;
		totalEntriesP = feEntriesP;
		feTotal.push(1);
		total = feTotal;
		feTotalP.push(1);
		totalP = feTotalP;
		numberRows = totalEntries.length; 
		count = 0;
		
		/* ASCENDING SORT */
		if(sorted == 1 && currentSort == "ascending")
		{
			sorted = 0; 
			currentSort;
			makeTable(); 
			/* ACTIVE VIEW */ 
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0;
				friend3 = prTr; prTr = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
				prTr = friend3; 
			}
			friend = periodV; 
			periodV = 0;
			sortTableDescending(sortColNum); 
			sortTableAscending(sortColNum);
			periodV = friend; 
			
			/* RESTORE TROUBLESHOOT VIEW */
			if(troubleshoot)
			{
				troubleshoot = 0; 	
				troubleshooting(); 
			}
			/* RESTORE TROUBLESHOOT + PERIOD VIEW */
			if(prTr)
			{
				prTr = 0; 	
				periodTrView(); 
			}
			/* Restore period table. */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return;   	
		}
		/* DESCENDING SORT */
		else if(sorted == 1 && currentSort == "descending")
		{
			sorted = 0; 
			currentSort;
			makeTable();

			/* ACTIVE VIEW */
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				friend3 = prTr; prTr = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
				prTr = friend3; 
			}

			friend = periodV; 
			periodV = 0; 
			sortTableDescending(sortColNum); 
			periodV = friend; 
			
			/* RESTORE TROUBLESHOOT VIEW */
			if(troubleshoot)
			{	
				troubleshoot = 0; 	
				troubleshooting(); 
			} 	
			
			/* RESTORE TROUBLESHOOT + PERIOD VIEW */
			if(prTr)
			{
				prTr = 0; 	
				periodTrView(); 
			}		
			/* RESTORE PERIOD VIEW */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return; 
		}
		else 
		{
			/* SETUP ACCORDING TO ACTIVE ENTRIES */
			if(active)
			{
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				friend3 = prTr; prTr = 0;
				diffHolder = diffSorted; diffSorted = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
				prTr = friend3; 
				
				/* RESTORE TROUBLESHOOT VIEW */
				if(troubleshoot)
				{
					troubleshoot = 0;	
					troubleshooting(); 
				}
			
				/* RESTORE TROUBLESHOOT + PERIOD VIEW */
				if(prTr)
				{
					prTr = 0;
					periodTrView(); 
				}  
				
				diffSorted = diffHolder; 
				
				/* SORT DIFF COLUMNS */
				if(diffSorted)
				{
					diffSorted--; 
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)");
					}
					else
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)");
					}
				}
				
				/* RESTORE PERIOD VIEW */
				if(periodV){periodV = 0; period(); }
				return; 	
			}
			fillIn();
		}
		diffHold = diffSorted; diffSorted = 0;   
				
		/* RESTORE TROUBLESHOOT VIEW */
		if(troubleshoot)
		{
			troubleshoot = 0;	
			troubleshooting(); 
		}
		/* RESTORE TROUBLESHOOT + PERIOD VIEW */
		if(prTr)
		{
			prTr = 0;
			periodTrView(); 
		}  
		
		diffSorted = diffHold; 
		
		/* SORT DIFF COLUMNS */
		if(diffSorted)
		{
			diffSorted--; 
			if(diffColNum == 1)
			{
				sortTrCol("Diff(Status: Running, Client: Registered)");
			}
			else
			{
				sortTrCol("Diff(Status: Idle, Requested: Idle)");
			}
		}
	}
	/* RESTORE PERIOD VIEW */
	if(periodV){periodV = 0; period();}
}

/* UPDATE XML's */
function updateTable()
{ 
	updating = 1; 
	loadXMLRRD(); 
}

/* NAVIGATE TO PAGE FOR SPECiFIC ENTRY */
function entryClick(entry)
{
	entryName = entry;
	entryName = entryName.childNodes[0].wholeText; 
	document.location.href = "http://glidein-1.t2.ucsd.edu:8319/glidefactory/monitor/glidein_Production_v3_1/factoryEntryStatusNow.html?view=" + entryName; 
}

/* FILL IN DEFAULT TABLE */ 
function fillIn()
{
	problem = 0;
	linkCount = 0;
	currChild = 1; 
	  
	if(!tableMade) makeTable(); /* MAKE TABLE IF NOT ALREADY MADE */
	
	if(!listMade) makeList(); 	/* MAKE LIST IF NOT ALREADY MADE */

	document.getElementById("total").innerHTML= " &bull;" + "View has: " + numberRows + " Total Entries - (" + preFrontEndName + ")"; 
	var table = document.getElementById("table"); 

	/* FILL IN ENTRY NAMES */
	for( i = 0; i< numberRows; i++)
	{
		y = totalEntries[i].attributes.getNamedItem("name").firstChild.data;
		 
		/* IF NAME DOESNT FIT */
		if(y.length >= 32){y = y.substring(0, 27); y = y + "...";}
		table.rows[i].cells[0].innerHTML = "";
		links[i] = document.createElement('a');
		links[i].setAttribute("id", "entryLinks"); 
		links[i].innerHTML = y;
		links[i].setAttribute("onbrowseover", "showEntryName()"); 
		links[i].setAttribute("onbrowseover", "hideEntryName()"); 
		links[i].setAttribute("href", "factoryEntryStatusNow.html?entry=" + y);
		links[i].setAttribute("onclick", "entryClick(this)");
		table.rows[i].cells[0].appendChild(links[i]); 
	}
	
	/* FILL IN 0's FOR EMPTY ENTRIES */
	for(j = 2; j < 18; j++)
	{	
		for(i = 0; i< total.length - 1; i++)
		{
			if(total[i].childNodes.length == 0)
			{
				table.rows[i].cells[j].innerHTML = "0";					
			}	
		}
	}
		
	/* FILL DOWNTIME FIELDS */
	for(var i = 0; i< totalEntries.length; i++)
	{
		if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
		{
			var item = total[i].childNodes[feDTChild].attributes[xmlAttDTNumArry[0]].value;
		}
		else
			var item = totalEntries[i].childNodes[dtChild].attributes[xmlAttDTNumArry[0]].value;
		
		if(item == "True"){ item = "&darr;"; table.rows[i].cells[1].style.color = "#B0171F";} /* DOWN ARROW*/
		else { item = "&uarr;"; table.rows[i].cells[1].style.color = "#008B00";  }            /* UP ARROW */
		table.rows[i].cells[1].innerHTML = item; 
	}
	
	/* 
	 * FILL STATUS FIELDS  
	 */
	for(var counter = 2; counter<= 9; counter++)
	{
		for(var i = 0; i< totalEntries.length; i++)
		{
			if(total[i].childNodes.length >= 7 && total[i].childNodes.length != 0)
			{
				if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
				{
					var item = total[i].childNodes[feStatChild].attributes[xmlAttStatusArry[counter - 2]].value;
				}
				else
					var item = total[i].childNodes[totStatChild].attributes[xmlAttStatusArry[counter - 2]].value;
				table.rows[i].cells[counter].innerHTML = item; 
			}
			else
			{
				table.rows[i].cells[counter].innerHTML = 0; 
			}
		}	
 	}
	
	/*
	 * FILL REQUESTED FIELDS 
	 */
	for(var counter = 10; counter <= 11; counter++)
	{
		for(var i = 0; i< totalEntries.length; i++)
		{
			if(total[i].childNodes.length >= 5 && total[i].childNodes.length != 0)
			{
				if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
				{
					var item = total[i].childNodes[feReqChild].attributes[xmlAttReqArry[counter - 10]].value; 
				}
				else
					var item = total[i].childNodes[totReqChild].attributes[xmlAttReqArry[counter - 10]].value; 
				table.rows[i].cells[counter].innerHTML = item; 
			}
			else
			{
				table.rows[i].cells[counter].innerHTML = 0; 
			}
		}
	}
	
	/* 
     * FILL CM FIELDS  
 	 */
	for(var counter = 12; counter <= 18; counter++)
	{
		for(i = 0; i< totalEntries.length; i++)
		{	
			if(total[i].childNodes.length >= 3 && total[i].childNodes.length != 0)
			{
				if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
				{
					item = total[i].childNodes[feCMChild].attributes[xmlAttCMArry[counter - 12]].value;
				}
				else
					item = total[i].childNodes[totCMChild].attributes[xmlAttCMArry[counter - 12]].value;
				table.rows[i].cells[counter].innerHTML = item; 
			}
			else
			{
				table.rows[i].cells[counter].innerHTML = 0; 
			}
		}
	}
}

/* LOAD RRD XML */
function loadXMLRRD()
{
	if(window.XMLHttpRequest)
	{
		xmlhttp=new XMLHttpRequest();
	}
	else
	{
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
		
	xmlhttp.onreadystatechange=function()
	{
		if(xmlhttp.readyState==4) 
    	{
			/* RESET */
			xmlAttStatNumArry = new Array(); 
			xmlAttReqNumArry = new Array(); 
			xmlAttCMNumArry = new Array(); 
			xmlAttDTNumArry = new Array(); 
			FExmlAttStatNumArry = new Array(); 
			FExmlAttReqNumArry = new Array(); 
			FExmlAttCMNumArry = new Array();
			xmlAttPeriodNumArry = new Array();
			xmlAttTotalNumArry = new Array();
			
			/* GET ALL NECESSARY INFO FROM RRD XML */
			totalEntriesPMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			totalPMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			frontEndsP = xmlhttp.responseXML.documentElement.getElementsByTagName("frontend"); 
			totalEntriesP = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			totalP = xmlhttp.responseXML.documentElement.getElementsByTagName("total"); 
			loadXMLDoc(); 
			
			/* FIND ALL CORRESPONDING ATTRIBUTES LOCATIONS */
			for(i = 0; i < totalEntriesP.length; i++)
			{	
				/* IF ENTRY IS NOT EMPTY */
				if(totalP[i].childNodes[1].childNodes[1].attributes.length > 1)
				{
					/* FIND ALL NECESSARY ATT's */
					for(j = 0; j < xmlAttPeriodArry.length; j++)
					{
						for(z = 0; z < totalP[i].childNodes[1].childNodes[1].attributes.length; z++)
						{
							if(xmlAttPeriodArry[j] == totalP[i].childNodes[1].childNodes[1].attributes[z].name)
							{
								xmlAttPeriodNumArry.push(z); break;  	
							}
						}	
					}
					break; 
				}
			}
		}
	}
	xmlhttp.open("GET", "rrd_Status_Attributes.xml",true);
	xmlhttp.send(null);
}

/* LOAD SCHEDD_STATUS */ 
function loadXMLDoc()
{	
	if(window.XMLHttpRequest)
	{
		xmlhttp=new XMLHttpRequest();
	}
	else
	{
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
	  
	xmlhttp.onreadystatechange=function()
	{	
		if(!active) document.getElementById("active").checked = false; /* Reset active check box. */
		if(!updating && !period && !prTr) document.getElementById("period").checked = false; /* Reset troubleshoot box. */
		if(!updating && !troubleshoot && !prTr) document.getElementById("troubleshoot").checked = false; /* Reset troubleshoot box. */
		if(!periodV && !prTr) document.getElementById("period").checked = false; /* Reset active check box. */
		
		if(xmlhttp.readyState==4)  
    	{
			/* RESET PERIOD */
			if(periodV){ period(); periodV = 1;}
			 
			/* GET ALL NECESSARY INFO FROM THE XML */ 
			updated = xmlhttp.responseXML.documentElement.getElementsByTagName("updated"); 
			showTime(); 
			totalEntriesMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			totalMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			frontEnds = xmlhttp.responseXML.documentElement.getElementsByTagName("frontend"); 
			totalEntries = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			total = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			totalEntriesHold = totalEntries; 
			numberRows = totalEntries.length;
			totalHold = total;
			
			/*
			 * FIND CHILD NODE # FOR TOTAL, FE, DOWNTIME 
			 */ 
			for(i = 0; i < totalEntries.length; i++)
			{
				if(total[i].childNodes.length != 7){continue;} /* ALL THREE ATT's MUST BE PRESENT */
				for(m = 1; m < totalEntries[i].childNodes.length; m+=2)
				{
					if(totalEntries[i].childNodes[m].tagName == "total")
					{
						totChild = m; 
						continue; 
					}
					else if(totalEntries[i].childNodes[m].tagName == "frontends")
					{
						feChild = m;
						continue;  
					}
					else if(totalEntries[i].childNodes[m].tagName == "downtime")
					{
						dtChild = m;
						continue;  
					}
				}
				if(totChild && feChild && dtChild)
				{
					break; 	
				}
			} 

			/* TOTAL */
			for(i = 0; i < totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[totChild].childNodes.length != 0)
				{
					if(total[i].childNodes.length != 7){continue;} /* If entry does not have all three attributes. */
					for(k = 1; k < totalEntries[i].childNodes[totChild].childNodes.length; k+=2)
					{
						if(totalEntries[i].childNodes[totChild].childNodes[k].tagName == "Status")
						{
							totStatChild = k; 
						}
						else if(totalEntries[i].childNodes[totChild].childNodes[k].tagName == "ClientMonitor")
						{
							totCMChild = k; 	
						}
						else if(totalEntries[i].childNodes[totChild].childNodes[k].tagName == "Requested")
						{
							totReqChild = k; 	
						}
					}
					break; 
				}	
			}
		 
		 	/* FRONTEND */
			for(i = 0; i < totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[feChild].childNodes.length > 1)
				{
					if(total[i].childNodes.length != 7){continue;} /* If entry does not have all three attributes. */
					for(k = 1; k < totalEntries[i].childNodes[feChild].childNodes[1].childNodes.length; k+=2)
					{
						if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes[k].tagName == "Status")
						{
							feStatChild = k; 
						}
						else if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes[k].tagName == "ClientMonitor")
						{
							feCMChild = k; 	
						}
						else if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes[k].tagName == "Requested")
						{
							feReqChild = k; 	
						}
						else if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes[k].tagName == "Downtime")
						{
							feDTChild = k; 	
						}
					}
					break; 
				}	
			}
			
			/* DOWNTIME ATTRIBUTES*/
			for(i = 0; i < totalEntries.length; i++)
			{
				for(j = 0; j < xmlAttDTArry.length; j++)
				{
					for(z = 0; z < totalEntries[i].childNodes[dtChild].attributes.length; z++)
					{
						if(xmlAttDTArry[j].toLowerCase() == totalEntries[i].childNodes[dtChild].attributes[z].name.toLowerCase())
						{
							xmlAttDTNumArry.push(z); xmlAttTotalNumArry.push(z); break;  	
						}
					}	
				}
				break; 
			}
			
			/* TOTAL ATTRIBUTES (FE ATTS ARE SAME) */
			for(i = 0; i < totalEntries.length; i++)
			{	
				if(total[i].childNodes.length != 7){continue;} /* If entry does not have all three attributes. */
				if(total[i].childNodes.length != 0)
				{
					for(j = 0; j < xmlAttStatusArry.length; j++)
					{
						/*
						 * Find corresponding STATUS attributes. 
						 */
						for(z = 0; z < total[i].childNodes[totStatChild].attributes.length; z++)
						{
							if(xmlAttStatusArry[j] == total[i].childNodes[totStatChild].attributes[z].name)
							{
								xmlAttStatNumArry.push(z); xmlAttTotalNumArry.push(z); break;  	
							}
						}	
					}
					for(j = 0; j < xmlAttReqArry.length; j++)
					{
						/*
						 * Find corresponding REQ attributes. 
						 */
						for(z = 0; z < total[i].childNodes[totStatChild].attributes.length; z++)
						{
							if(xmlAttReqArry[j] == total[i].childNodes[totReqChild].attributes[z].name)
							{
								xmlAttReqNumArry.push(z); xmlAttTotalNumArry.push(z); break;  	
							}
						}
					}
					for(j = 0; j < xmlAttCMArry.length; j++)
					{
						/*
						 * Find corresponding CM attributes. 
						 */
						for(z = 0; z < total[i].childNodes[totCMChild].attributes.length; z++)
						{
							if(xmlAttCMArry[j] == total[i].childNodes[totCMChild].attributes[z].name)
							{
								xmlAttCMNumArry.push(z); xmlAttTotalNumArry.push(z); break;  	
							}
						}
					}
					break; 
				}
			}
			
			/* UPDATE BUTTON */
			if(updating == 1)
			{
				diffH = diffSorted; diffSorted = 0; 
				
				/* REMOVE TROUBLESHOOT VIEW */
				if(troubleshoot)
				{
					troubleshooting(); 
					troubleshoot = 1; 
				}
				
				/* REMOVE PERIOD + TROUBLESHOOT */
				if(prTr){periodTrView(); prTr = 1;}
				
				diffSorted = diffH; 
				
				/* DESCENDING SORT */
				if(sorted != 0 && currentSort == 'descending' && frontEnd == 0)
				{ 
					currentSort;
					sorted = 0;
					updating = 0;
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0;
						friend3 = prTr; prTr = 0;  
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						prTr = friend3; 
						document.getElementById("active").checked = true; 
					} 
					else
					{
						makeTable();
					}
					tableMade = 0;  
					friend = periodV; periodV = 0; 
					friend2 = prTr; prTr = 0; 
					sortTableDescending(sortColNum);
					prTr = friend2; 
					periodV = friend;  
					;
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(prTr){ prTr = 0; periodTrView(); }
					if(periodV){periodV = 0; period();} /* Return to period view. */
					return; 
				}
				/* ASCENDING SORT */
				else if(sorted != 0 && currentSort == 'ascending' && frontEnd == 0)
				{
					currentSort;
					sorted = 0;
					updating = 0; 
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0;
						friend3 = prTr; prTr = 0;  
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						prTr = friend3; 
						document.getElementById("active").checked = true; 
					}
					else
					{
						makeTable();
					}
					tableMade = 0; 
					friend = periodV; periodV = 0;
					friend2 = prTr; prTr = 0; 
					sortTableDescending(sortColNum);
					sortTableAscending(sortColNum);
					periodV = friend; 
					prTr = friend2; 
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(prTr){ prTr = 0; periodTrView(); }
					if(periodV){periodV = 0; period();} /* Return to period view. */
					return; 
				}
				/* FRONTEND VIEW */
				else if(sorted == 0 && frontEnd != 0)
				{
					frontEnd = 0;
					updating = 0;
					makeTable();
					diffH = diffSorted; diffSorted = 0; 
					friend = troubleshoot; troubleshoot = 0;
					friend2 = periodV; periodV = 0;
					friend3 = active; active = 0; 
					friend4 = prTr;  prTr = 0;   
					loadFrontEnd(preFrontEndName);
					periodV = friend2; 
					troubleshoot = friend; 
					active = friend3;
					prTr = friend4; 

					/* RESTORE ACTIVE */ 
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						friend3 = prTr; prTr = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						prTr = friend3; 
						document.getElementById("active").checked = true; 
					} 
										
					/* RESTORE TROUBLESHOOT */
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					/* RESTORE PERIOD + TROUBLESHOOT */
					if(prTr){prTr = 0; periodTrView(); }
					
					diffSorted = diffH; 
										
					/* SORT DIFF COL */
					if(diffSorted)
					{
						diffSorted--; 
						if(diffColNum == 1)
						{
							sortTrCol("Diff(Status: Running, Client: Registered)"); 
						}
						else if(diffColNum == 2)
						{
							sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
						}
					}
					
					/* RESTORE PERIOD */
					if(periodV){periodV = 0; period();}
					return; 
				}
				/* FRONTEND + ASCENDING SORT */
				else if(sorted != 0 && currentSort == 'ascending' && frontEnd != 0)
				{
					currentSort;
					sorted = 0; 
					frontEnd = 0; 
					updating = 0;
					friend = troubleshoot; troubleshoot = 0; 
					friend2 = periodV; periodV = 0; 
					friend3 = active; active = 0;
					friend4 = prTr; prTr = 0;  
					loadFrontEnd(preFrontEndName);
					active = friend3; 
					periodV = friend2;
					prTr = friend4;  
					troubleshoot = friend;
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						friend3 = prTr; prTr = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						prTr= friend3; 
						document.getElementById("active").checked = true; 
					} 
					tableMade = 0; 
					friend = periodV; periodV = 0; 
					sortTableDescending(sortColNum); 
					sortTableAscending(sortColNum);
					periodV = friend; 
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(prTr){ prTr = 0; periodTrView(); }
					if(periodV){periodV = 0; period(); }
					return; 
				}
				/* FRONTEND + DESCENDING SORT */
				else if(sorted != 0 && currentSort == 'descending' && frontEnd != 0)
				{
					currentSort;
					sorted = 0; 
					frontEnd = 0;
					updating = 0; 
					friend = troubleshoot; troubleshoot = 0; 
					friend2 = periodV; periodV = 0;
					friend3 = active; active = 0;
					friend4 = prTr; prTr = 0;  
					loadFrontEnd(preFrontEndName);
					periodV = friend2; 
					active = friend3;
					prTr = friend4;  
					troubleshoot = friend;
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						friend3 = prTr; prTr = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2;
						prTr= friend3; 
						document.getElementById("active").checked = true; 
					}
					tableMade = 0; 
					friend = periodV; periodV = 0; 
					sortTableDescending(sortColNum);
					periodV = friend; 
					;
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(prTr){ prTr = 0; periodTrView(); }
					if(periodV){periodV = 0; period(); }
					return; 
				}
			}
			
			diffH = diffSorted; diffSorted = 0; 

			/* ACTIVE */
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; friend3 = prTr; prTr = 0;  
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
				prTr = friend3; 
				document.getElementById("active").checked = true; 
			}
			
			preFrontEndName = "Total"; 
			tableMade = 0; 
    		frontEnd = 0; 
			sorted = 0;
			listMade = 0; 
			currentSort;
			document.getElementById("destination").selectedIndex = 0; 
			fillIn(); /* FILL IN TABLE */
			
			/* RESTORE TROUBLESHOOT */
			if(troubleshoot)
			{
				troubleshoot = 0; 
				troubleshooting();
				document.getElementById("troubleshoot").checked = true; 
			}
	
			/* RESTORE PERIOD + TROUBLESHOOT */
			if(prTr){prTr = 0; periodTrView(); 	document.getElementById("period").checked = true;}
			
			/* RESTORE PERIOD */
			if(periodV){periodV = 0; period();}  

			diffSorted = diffH;
			
			if(diffSorted)
			{
				diffSorted--; 
				if(diffColNum == 1)
				{
					sortTrCol("Diff(Status: Running, Client: Registered)"); 
				}
				else if(diffColNum == 2)
				{
					sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
				}
			}
			
			if(!updating){checkUrl();}
			updating = 0; 
		} 
			 
	}
	xmlhttp.open("GET", "schedd_status.xml",true);
	xmlhttp.send(null);
} 

/* BUILD MAIN TABLE */
function makeTable() 
{
	/* IF TABLE EXISTS REMOVE IT*/
	if(table)
	{ 
		document.getElementById('scroll').removeChild(table);
		document.getElementById('header').removeChild(thead); 
	}
	
	row = new Array();
	cell = new Array();
	cell2 = new Array();
	row2 = document.createElement('tr'); 
	
	row_num = numberRows + 1;
	cell_num = exactColumns.length; 
	
	thead = document.createElement('table');
	thBody = document.createElement('tbody');
	thead.setAttribute('id', 'thead');
	
	table = document.createElement('table');
	tBody=document.createElement('tbody');
	table.setAttribute('id','table');
	colSpanArry = new Array(1, 1, 8, 2, 7); 
	headTxt = new Array("" , "" ,"Status: ", "Requested: ", "Client Monitor: ");
	headId = new Array('empty', 'downtime','status', 'requested', 'client');  
	headClr = new Array('#DCDCDC', '#DCDCDC', '#FAF0E6', '#FFDAB9', '#CDAF95'); 
	
	/* HEADER */
	for(x = 0; x < headTxt.length; x++)
	{
		cell2[x] = document.createElement('td');
		cell2[x].appendChild(document.createTextNode(headTxt[x])); 
		cell2[x].setAttribute('bgColor', headClr[x]);
		cell2[x].setAttribute('id', headId[x]);
		cell2[x].setAttribute("colspan", colSpanArry[x]);
		if(x == 0) cell2[x].setAttribute("width", "18%");	
		if(x == 1) cell2[x].setAttribute("width", "2%");		
		row2.appendChild(cell2[x]); 
	}
	thBody.appendChild(row2); 
	
	/* TABLE BODY + HEADER 2 */
	for(c = 0; c < row_num; c++)
	{
		row[c] = document.createElement('tr');
		
		row[c].setAttribute('id', 'entries');
		/* HIGHLIGHT ON MOUSEOVER */ 
		if(c > 0)
		{
			row[c].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
			row[c].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 
		}
		for(k = 0; k < cell_num; k++) 
		{
			cell[k] = document.createElement('td');
		
			/* ATTACH POP UP EVENT ON ALL VALUES */
			if(c > 0 && k > 0)
			{
				cell[k].setAttribute('onmouseover', 'showPopUp(this)');
				cell[k].setAttribute('onmouseout', 'hidePopUp()');
				cell[k].setAttribute('id', c);  				
			}
			if(c > 0 && k == 0) cell[k].setAttribute('width', '18%');  				
			if(c > 0 && k == 1) cell[k].setAttribute('width', '2%');  
			/* ENTRY NAME COL */				
			if(c == 0 && k == 0)
			{
				cont = document.createTextNode("Entry Name")
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', 'entryName'); 
				cell[k].setAttribute("onclick", "sortAlphabetical()");
				cell[k].setAttribute('bgColor', '#DCDCDC');  	 
			}
			/* SECOND ROW (HEADER #2) */
			else if(c == 0)
			{
				cont = document.createTextNode(headColArry[k])
				if(k == 1) cont = document.createTextNode(""); 
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', columnArray[k]);
				cell[k].style.textAlign = "center";
				y = "sortTableDescending(" + k + ")"; 
				cell[k].setAttribute("onclick", y);
				if(k == 1) cell[k].setAttribute('bgColor', headClr[1]);
				else if(k < 10 && k > 1) cell[k].setAttribute('bgColor', headClr[2]); 
				else if(k > 9 && k < 12) cell[k].setAttribute('bgColor', headClr[3]); 
				else cell[k].setAttribute('bgColor', headClr[4]); 	 
			}
			/* PLACE 0 IN EACH CELL INITIALLY */
			if(c > 0)
			{
				cont = document.createTextNode(0+"");
				cell[k].appendChild(cont);
			}
			if(c > 0 && k == 1)
			{
				cell[k].innerHTML ="&darr;"; 
				cell[k].style.textAlign = "center"; 
			}
			row[c].appendChild(cell[k]);
		}
		if(c == 0)
		{
			thBody.appendChild(row[c]); 
		}
		else
		{
			tBody.appendChild(row[c]);
		}
		tableMade = 1;
	}
	
	thead.appendChild(thBody); 
	table.appendChild(tBody); 
	document.getElementById('header').appendChild(thead); 
	document.getElementById('scroll').appendChild(table);
	document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 
} 

/* ADJUST HEIGHT OF TABLE */
function setHeight()
{
	document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 
}

/* CHANGE BG COLOR OF SORTED COLS (TOAL + PERIOD VIEW)  */
function sortSignal()
{	
	/* RESTORE (INCLUDE DOWNTIME) */
	for(i = 0; i < columnArray.length; i++)
	{
		for(j = 0; j < totalEntries.length; j++)
		{
			if(i != sortColNum)
			{
				table.rows[j].cells[i].bgColor = "#F2F2F2";  
			}
		}
	}
    if(sortColNum == -2) return; /* INCOMPATIBLE COL */ 	

	/* COLOR SELECTED COLS */
	for(i = 0; i < totalEntries.length; i++)
	{	
		if(sortColNum > 0 && sortColNum <= 1 + xmlAttStatNumArry.length)
		{
			table.rows[i].cells[sortColNum].bgColor =  "#FAF0E6";
		}
		else if(sortColNum == 10 || sortColNum == 11)
		{
			table.rows[i].cells[sortColNum].bgColor =  "#FFDAB9";
		}
		else
			table.rows[i].cells[sortColNum].bgColor =  "#CDAF95"; 
	}
	
	/* COLOR COLS IF IN PERIOD VIEW ALSO */
	if(periodV)
	{
		/* RESTORE */
		for(i = 3; i < columnArray.length + 1; i++)
		{
			for(j = 0; j < totalEntriesP.length * 4; j++)
			{
				if(j % 4 == 0)
				{
					tableP.rows[j].cells[1].bgColor = "#F2F2F2"; 
				}
				else
					tableP.rows[j].cells[0].bgColor = "#F2F2F2"; 
					
				if(i != (sortColNum + 1))
				{
					if(j % 4 == 0)
					{
						tableP.rows[j].cells[i].bgColor = "#F2F2F2"; 
					}
					else
						tableP.rows[j].cells[i - 1].bgColor = "#F2F2F2";  
				}
			}
		}
		if(sortColNum == -2) return; /* INCOMPATIBLE COL */  	

		/* COLOR SELECTED COLS */
		for(i = 0; i < totalEntries.length * 4; i++)
		{
			if((sortColNum + 1) >= 3 && (sortColNum + 1) < 11)
			{
				if(i % 4 == 0)
				{
					tableP.rows[i].cells[(sortColNum + 1)].bgColor = "#FAF0E6"; 
				}
				else
					tableP.rows[i].cells[sortColNum].bgColor = "#FAF0E6";
			}
			else if((sortColNum + 1) == 11 || (sortColNum + 1) == 12)
			{
				if(i % 4 == 0)
				{
					tableP.rows[i].cells[(sortColNum + 1)].bgColor = "#FFDAB9"; 
				}
				else
					tableP.rows[i].cells[sortColNum].bgColor = "#FFDAB9";
			}
			else
			{
				if(i % 4 == 0)
				{
					tableP.rows[i].cells[(sortColNum + 1)].bgColor = "#CDAF95"; 
				}
				else
					tableP.rows[i].cells[sortColNum].bgColor = "#CDAF95";
			}
		}	
	}
}

/* ASCENDING SORT (REVERSED) */
function sortTableAscending(column)
{
	total.splice(total.length - 1, 1);
	totalP.splice(totalP.length - 1, 1);
	total.reverse(); 
	totalEntries.reverse(); 
	totalP.reverse();  
	totalEntriesP.reverse();
	total.push(0); 
	totalP.push(0);

	currentSort = "ascending"; 
	previousSort = column;
	sorted = 1;
	if(periodV){fillInPeriod();} 
	else fillIn();
}

/* DESCENDING SORT */
function sortTableDescending(column)
{
	/* PERIOD VIEW ACCESS NAME OF COL */
	if(periodV){column = column.cellIndex; column--; /* ADJUST BECAUSE OF DOWNTIME */}
	
	/* DONT SORT DOWNTIME STATUS COL */
	if(column == 1){ return; } 
	
	sortColNum = column; 
	column = columnArray[column];  
	sortColName = column; 
	
	lengthArry =       new Array(0,7,7,7,7,7,7,7,7,5,5,3,3,3,3,3,3,3);       /* 1 DT + 8 STAT + 2 REQ + 7 CM  = 18 */
	trSortColNumArry = new Array(0,0,2,5,0,0,0,0,0,0,0,6,0,0,0,0,8,3); 
	feChildArry = new Array(feStatChild, feReqChild, feCMChild); 
	totChildArry = new Array(totStatChild, totReqChild, totCMChild); 
	newTotal = new Array(); 
	newEntries = new Array();
	newTotalP = new Array(); 
	newEntriesP = new Array();

	/* IF THERE IS CURR SORT */
	if(previousSort != column)
	{
		sorted = 0; 
	}
	/* IF SECOND CLICK SORT ASCENDING */
	if(sorted == 1 && currentSort != "ascending")
	{
		sorted = 0; 
 		sortTableAscending(column);
   		return; 
	}
	
	/* SET INFO ACCORDINGLY */
	length = lengthArry[sortColNum - 1]; att = xmlAttTotalNumArry[sortColNum - 1]; trSortColNum = trSortColNumArry[sortColNum]; ;
	if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
	{
		if(sortColNum < 10){child = feChildArry[0];}else if(sortColNum < 12){child = feChildArry[1];}else{child = feChildArry[2];}
	}
	else
		if(sortColNum < 10){child = totChildArry[0];}else if(sortColNum < 12){child = totChildArry[1];}else{child = totChildArry[2];}
	
			
	/* GET EVERYTHING NOT 0 */
	for(var i = 0; i < totalEntries.length; i++)
	{
		if(total[i].childNodes.length != 0 && total[i].childNodes.length >= length)
		{
		   if(total[i].childNodes[child].attributes[att].value > 0)
		   {
			   newTotal.push(total[i]); 
			   newEntries.push(totalEntries[i]); 
			  
			   newTotalP.push(totalP[i]); 
			   newEntriesP.push(totalEntriesP[i]); 
		   }	
		}
	}

	/* SORT ALL NONE ZERO ELEMENTS */	
	for(var i = 0; i < newTotal.length - 1; i++)    // element to be compared
	{
   		for(var j = i + 1; j < newTotal.length; j++)   // rest of the elements
   	 	{
			if(parseInt(newTotal[i].childNodes[child].attributes[att].value) <= parseInt(newTotal[j].childNodes[child].attributes[att].value))          
       		 {
       	    	temp = newTotal[i];              // swap
				newTotal[i] = newTotal[j];
        	    newTotal[j] = temp;
				temp = newEntries[i];            // swap
				newEntries[i] = newEntries[j];
    	       	newEntries[j] = temp;
				
				temp = newTotalP[i];              // swap
				newTotalP[i] = newTotalP[j];
        	    newTotalP[j] = temp;
				temp = newEntriesP[i];            // swap
				newEntriesP[i] = newEntriesP[j];
    	       	newEntriesP[j] = temp;
        	}
		}
	}

	/* GET 0 ENTRIES */
	for(var i = totalEntries.length - 1; i >= 0; i--)
	{	
		if(total[i].childNodes.length != 0 && total[i].childNodes.length >= length)
		{
			if(parseInt(total[i].childNodes[child].attributes[att].value) == 0)
			{
				newTotal.push(total[i]); 
				newEntries.push(totalEntries[i]); 
				
				newTotalP.push(totalP[i]); 
				newEntriesP.push(totalEntriesP[i]);
			}
		}
	}
	
	/* EMPTY ENTRIES */
	for(var i = totalEntries.length -1; i >= 0; i--)
	{
		if(total[i].childNodes.length == 0 || total[i].childNodes.length < length)
		{		
			newTotal.push(total[i]); 
			newEntries.push(totalEntries[i]); 
			
			newTotalP.push(totalP[i]); 
			newEntriesP.push(totalEntriesP[i]); 		
		}
	}
	
	/* MAKE SURE ENTRIE COL IS NOT ALL 0's */
	for(i = 0 ; i < newTotal.length; i++)
	{
		if(newTotal[i].childNodes.length != 0 && newTotal[i].childNodes.length >= length)
		{ 
			if(newTotal[i].childNodes[child].attributes[att].value != 0)
			{
				break;
			}
		}
	}

	/* 
	 * UPDATE ALL INFO FOR NEWLY SORTED ENTRIES 
	 */
	currentSort = "descending";
	newTotal.push(1);
	newTotalP.push(1);
	previousSort = column; 
	total = newTotal; 
	totalEntries = newEntries;
	totalP = newTotalP; 
	totalEntriesP = newEntriesP;
	tempTotalEntries = newEntries; 
	tempTotalEntriesP = newEntriesP;
	tempTotal = newTotal; 
	tempTotalP = newTotalP; 
	sorted = 1;
 
 	/* FILL IN INFO DEPENDING ON VIEW */
	if(periodV){fillInPeriod();}
	else fillIn();
	
	sortSignal(); /* COLOR SORTED COL */
}

/* SET URL ARGS ACCORDING TO VIEW */
function goToLink()
{
	var constructed;
	var holder = document.URL.split('?');
	
	/* FRONTEND + SORTED VIEWS */
	if(frontEnd && (sorted || diffSorted))
	{
		/* ACTIVE + TROUBLESHOOT + PERIOD */
		if(active && prTr)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot+period" + "&sort=diff(Status:Running,Client:Registered)";
				}
				else 
					constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot+period" + "&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else 
				constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot+period" + "&sort=" + sortColName;
		}
		/* TROUBLESHOOT + PERIOD */
		else if(!active && prTr)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot+period" + "&sort=diff(Status:Running,Client:Registered)";
				}
				else 
					constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot+period" + "&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else 
				constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot+period" + "&sort=" + sortColName;
		}
		/* ACTIVE + TROUBLESHOOT */
		else if(active && troubleshoot && !periodV)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot" + "&sort=diff(Status:Running,Client:Registered)";
				}
				else 
					constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot" + "&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else 
				constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot" + "&sort=" + sortColName;
		}
		/* ACTIVE */
		else if(active && !troubleshoot && !periodV && !prTr)
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "+active" + "&sort=" + sortColName;
		}
		/* ACTIVE + PERIOD */
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "+active+period&sort=" + sortColName;// + "&sort=" + col;
		}
		/* PERIOD */
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "+period&sort=" + sortColName;//&sort=" + col;
		}
		/* TROUBLESHOOT */
		else if(!active && troubleshoot && !periodV)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot" + "&sort=diff(Status:Running,Client:Registered)";
				}
				else
					constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot" + "&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else  
				constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot" + "&sort=" + sortColName;
		}
		else 
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "&sort=" + sortColName;
		}
		
	}
	/* FRONTEND VIEW  */
	else if(frontEnd && !sorted)
	{
		/* ACTIVE + TROUBLESHOOT + PERIOD */
		if(active && prTr)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+active+troubleshoot+period";
		}
		/* ACTIVE + TROUBLESHOOT */
		else if(active && troubleshoot && !periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+active+troubleshoot";
		}
		/* PERIOD + TROUBLESHOOT */
		else if(!active && prTr)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+troubleshoot+period";
		}
		/* ACTIVE + PERIOD */
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+active+period";
		}
		/* ACTIVE */
		else if(active && !troubleshoot && !periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+active";
		}
		/* PERIOD */
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+period";
		}
		/* TROUBLESHOOT */
		else if(!active && troubleshoot && !periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+troubleshoot";
		}
		else
		{
			constructed = holder[0]+ "?view=" + preFrontEndName;
		}
	}
	/* SORTED */
	else if(!frontEnd && (sorted || diffSorted))
	{
		/* ACTIVE + TROUBLESHOOT + PERIOD */
		if(active && prTr)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=total+active+troubleshoot+period&sort=diff(Status:Running,Client:Registered)";
				}
				else 
					constructed = holder[0] + "?view=total+active+troubleshoot+period&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else 
				constructed = holder[0] + "?view=total+active+troubleshoot+period&sort=" + sortColName;
		}
		/* TROUBLESHOOT + PERIOD */
		else if(!active && prTr)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=total+troubleshoot+period&sort=diff(Status:Running,Client:Registered)";
				}
				else 
					constructed = holder[0] + "?view=total+troubleshoot+period&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else 
				constructed = holder[0] + "?view=total+troubleshoot+period&sort=" + sortColName;
		}
		/* ACTIVE + TROUBLESHOOT */
		else if(active && troubleshoot && !periodV)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=total+active+troubleshoot&sort=diff(Status:Running,Client:Registered)";
				}
				else 
					constructed = holder[0] + "?view=total+active+troubleshoot&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else 
				constructed = holder[0] + "?view=total+active+troubleshoot&sort=" + sortColName;
		}
		/* ACTIVE */
		else if(active && !troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=total+active&sort=" + sortColName;
		}
		/* ACTIVE + PERIOD */
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+active+period&sort=" + sortColName;
		}
		/* PERIOD */
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+period&sort=" + sortColName;
		}
		/* TROUBLESHOOT */
		else if(!active && troubleshoot && !periodV)
		{
			/* DIFF COLUMN SORT */
			if(diffSorted)
			{
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=total+troubleshoot&sort=diff(Status:Running,Client:Registered)";
				}
				else 
					constructed = holder[0] + "?view=total+troubleshoot&sort=diff(Status:Idle,Requested:Idle)";
			}
			/*  REGULAR COLUMN SORT */
			else 
				constructed = holder[0] + "?view=total+troubleshoot&sort=" + sortColName;
		}
		else
		{
			constructed = holder[0] + "?sort=" + sortColName;
		}
	}
	/* TOTAL */
	else 
	{
		/* ACTIVE + TROUBLESHOOT + PERIOD*/
		if(active && prTr)
		{
			constructed = holder[0] + "?view=total+active+troubleshoot+period";
		}
		/* ACTIVE */
		else if(active && !prTr && !troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=total+active";
		}
		/* ACTIVE + TROUBLESHOOT */
		else if(active && troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=total+active+troubleshoot";
		}
		/* ACTIVE + PERIOD */
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+active+period";
		}
		/* PERIOD + TROUBLESHOOT */
		else if(!active && prTr)
		{
			constructed = holder[0] + "?view=total+troubleshoot+period";
		}
		/* TROUBLESHOOT */
		else if(!active && troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=total+troubleshoot";
		}
		/* PERIOD */
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+period";
		}
		else
		{
			constructed = holder[0];
		}
	}
	document.location.href = constructed; /* NAVIGATE TO NEW ADDRESS */
			
}

/* SELECT ONLY ACTIVE ENTRIES */
function selectActive()
{
	found = 0; activeEntries = new Array(); activeTotal = new Array(); activeEntriesP = new Array(); activeTotalP = new Array(); currChild = 0; 
	diffHold = diffSorted; diffSorted = 0; 
	
	/* REMOVE TROUBLESHOOT VIEW */
	if(troubleshoot)
	{
		troubleshooting(); 
		troubleshoot = 1;
	}
	/* REMOVE TROUBLESHOOT + PERIOD VIEW */
	if(prTr)
	{	
		periodTrView(); 
		prTr = 1;
	} 
	
	diffSorted = diffHold; 
	
	/* IF ALREADY IN ACTIVE VIEW */
	if(active)
	{
		if(frontEnd)
		{
			/* REMOVE PERIOD VIEW */
			if(periodV){period(); periodV = 1; }
			
			totalEntries = feEntries;
			totalEntriesP = feEntriesP;
			total = feTotal;
			totalP = feTotalP;
			tableMade = 0; 
			numberRows = totalEntries.length;		
			fillIn(); 
			active = 0; 
			/* RESTORE DESCENDING SORT */
			if(sorted != 0 && currentSort == 'descending')
			{
				currentSort;
				sorted = 0; 
				tableMade = 0; 
				friend = periodV; periodV = 0; 
				sortTableDescending(sortColNum);
				;	
				periodV = friend; 
			}
			/* RESTORE ASCENDING SORT */
			else if(sorted != 0 && currentSort == 'ascending')
			{
				currentSort;
				sorted = 0;
				tableMade = 0; 
				friend = periodV; periodV = 0; 
				sortTableDescending(sortColNum);
				sortTableAscending(sortColNum);
				periodV = friend; 
			}
			diffHold = diffSorted; diffSorted = 0; 
			
			/* RESTORE TROUBLESHOOT VIEW */
			if(troubleshoot)
			{
				troubleshoot = 0;	
				troubleshooting(); 
			}
			/* RESTORE TROUBLESHOOT + PERIOD VIEW */
			if(prTr)
			{
				prTr = 0;
				periodTrView(); 
			}  
			
			diffSorted = diffHold; 
			
			/* SORT DIFF COLUMNS */
			if(diffSorted)
			{
				diffSorted--; 
				if(diffColNum == 1)
				{
					sortTrCol("Diff(Status: Running, Client: Registered)");
				}
				else
				{
					sortTrCol("Diff(Status: Idle, Requested: Idle)");
				}
			}
	
			/* RESTORE PERIOD VIEW */
			if(periodV){periodV = 0; period(); }
			return;	
		}
		else
		{
			/* Reset everything back to total. */
			totalEntries = totalEntriesMaster;
			totalEntriesP = totalEntriesPMaster;
			total = totalMaster;
			totalP = totalPMaster;
			tableMade = 0; 
			numberRows = totalEntries.length;

			/* REMOVE PERIOD VIEW */
			if(periodV){period(); periodV = 1;}

			fillIn(); 
			active = 0;
			/* RESTORE DESCENDING SORT */
			if(sorted != 0 && currentSort == 'descending')
			{
				currentSort;
				sorted = 0; 
				tableMade = 0; 
				friend = periodV; periodV = 0; 
				sortTableDescending(sortColNum);
				;
				periodV = friend; 
				if(troubleshoot == 1) /* Restore table if needed. */
				{
					troubleshoot = 0; 
					troubleshooting(); 	
				}
				if(periodV){periodV = 0; period();} 
				return; 
			}
			/* RESTORE ASCENDING SORT */
			if(sorted != 0 && currentSort == 'ascending')
			{
				currentSort;
				sorted = 0;
				tableMade = 0;  
				friend = periodV; periodV = 0; 
				sortTableDescending(sortColNum);
				sortTableAscending(sortColNum);
				periodV = friend; 
				if(troubleshoot == 1) /* Restore table if needed. */
				{
					troubleshoot = 0; 
					troubleshooting(); 	
				} 
				if(periodV){periodV = 0; period(); 	} 
				return; 
			} 
			
			diffHold = diffSorted; diffSorted = 0; 
			
			/* RESTORE TROUBLESHOOT VIEW */
			if(troubleshoot)
			{
				troubleshoot = 0;	
				troubleshooting(); 
			}
			/* RESTORE TROUBLESHOOT + PERIOD VIEW */
			if(prTr)
			{
				prTr = 0;
				periodTrView(); 
			}  
			
			diffSorted = diffHold; 
			
			/* SORT DIFF COLUMNS */
			if(diffSorted)
			{
				diffSorted--; 
				if(diffColNum == 1)
				{
					sortTrCol("Diff(Status: Running, Client: Registered)");
				}
				else
				{
					sortTrCol("Diff(Status: Idle, Requested: Idle)");
				}
			}
			
			/* RESTORE PERIOD VIEW */
			if(periodV)
			{
				periodV = 0; 
				period(); 	
			}
			return;
		}
	}
	
	
	/* 
	 * CREATE THE ACTIVE VIEW
	 */
	for(i = 0; i < totalEntries.length; i++)
	{
		found = 0; 
		if(total[i].childNodes.length != 0)
		{
			if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			{
				currChild = feCMChild; 
			}
			else
				currChild = totCMChild; 
			for(j = 0; j < total[i].childNodes[currChild].attributes.length; j++)
			{
				if(total[i].childNodes[currChild].attributes[j].name == "InfoAge")
				{
					continue; 	
				}
				if(parseInt(total[i].childNodes[currChild].attributes[j].value) != 0)
				{
					activeEntries.push(totalEntries[i]);
					activeTotal.push(total[i]);
					activeEntriesP.push(totalEntriesP[i]);
					activeTotalP.push(totalP[i]);
					found = 1; 
					break;
				}
			}	
			if(found)
			{
				continue; 	
			}
			if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			{
				currChild = feReqChild; 
			}
			else
				currChild = totReqChild;
			for(k = 0; k < total[i].childNodes[currChild].attributes.length; k++)
			{
				if(total[i].childNodes[currChild].attributes[k].name == "MaxRun")
				{
					continue; 	
				}
				if(parseInt(total[i].childNodes[currChild].attributes[k].value) != 0)
				{
					activeEntries.push(totalEntries[i]);
					activeTotal.push(total[i]);
					activeEntriesP.push(totalEntriesP[i]);
					activeTotalP.push(totalP[i]);
					found = 1; 
					break;
				}
			}
			if(found)
			{
				continue; 	
			}
			if(total[i].childNodes.length != 7)
			{
				continue; 	
			}
			if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			{
				currChild = feStatChild; 
			}
			else
				currChild = totStatChild;
			for(l = 0; l < total[i].childNodes[currChild].attributes.length; l++)
			{
				if(parseInt(total[i].childNodes[currChild].attributes[l].value) != 0)
				{
					activeEntries.push(totalEntries[i]);
					activeTotal.push(total[i]);
					activeEntriesP.push(totalEntriesP[i]);
					activeTotalP.push(totalP[i]);
					break;
				}
			}
		}
	}
	
	active = 1;
	activeTotal.push(1);
	activeTotalP.push(1);
	total = activeTotal; 
	totalEntries = activeEntries;
	totalP = activeTotalP; 
	totalEntriesP = activeEntriesP;
	numberRows = totalEntries.length;	
	
	/* REMOVE PERIOD VIEW */
	if(periodV){period(); periodV = 1;}
	
	tableMade = 0; 
	fillIn();  /* FILL IN DEFAULT TABLE WITH NEWLY ACTIVE FILTER */
	
	/* RESTORE DESCENDING SORT WITH ACTIVE */
	if(sorted != 0 && currentSort == 'descending')
	{
		currentSort;
		sorted = 0; 
		tableMade = 0; 
		friend = periodV; periodV = 0; 
		sortTableDescending(sortColNum);
		periodV = friend; 
	}
	/* RESTORE ASCENDING SORT WITH ACTIVE */
	else if(sorted != 0 && currentSort == 'ascending')
	{
		currentSort;
		sorted = 0;
		tableMade = 0; 
		friend = periodV; periodV = 0; 
		sortTableDescending(sortColNum);
		sortTableAscending(sortColNum);
		periodV = friend; 
	}
	
	diffHold = diffSorted; diffSorted = 0; 
			
	/* RESTORE TROUBLESHOOT VIEW */
	if(troubleshoot)
	{
		troubleshoot = 0;	
		troubleshooting(); 
	}
	/* RESTORE TROUBLESHOOT + PERIOD VIEW */
	if(prTr)
	{
		prTr = 0;
		periodTrView(); 
	}  
	
	diffSorted = diffHold; 
	
	/* SORT DIFF COLUMNS */
	if(diffSorted)
	{
		diffSorted--; 
		if(diffColNum == 1)
		{
			sortTrCol("Diff(Status: Running, Client: Registered)");
		}
		else
		{
			sortTrCol("Diff(Status: Idle, Requested: Idle)");
		}
	}
	
	/*  RESTORE PERIOD VIEW */
	if(periodV)
	{
		periodV = 0;   
		period(); 	
	}
}

/* GO TO SPECIFIC ENTRY PAGE */
function goToDestination(option)
{
	document.location.href = option.value; 
	document.getElementById("destination").selectedIndex = 0;
}

/* BUILD TR TABLE */
function troubleshooting()
{	 
	/* RESTORE PERIOD + TR VIEW */
	if(prTr){ troubleshoot = 0; periodV = 1; periodTrView();  return;}
	
	/* RESTORE PERID VIEW */
	if(periodV){ periodTrView(); return;}
	
	currChild = 1; 
	hrefs = new Array(); 
	
	/* TROUBLESHOOT VIEW CHECKED*/
	if(!troubleshoot)
	{
		/* IF EXISTING SORT NOT COMPATIBLE WITH TR VIEW RESTORE ENTRY ARRAY TO DEFAULT */
		if(!diffSorted && sorted && sortColName != "statusRunning" && sortColName != "cmGlideinTotal" && sortColName != "statusIdle" && sortColName != "requestIdle" && 
		sortColName != "cmGlideinJobsIdle")
		{
			tempTotalEntries = totalEntriesMaster; 
		}
		/* IF SORTED BUT NOT DIFF SORTED SET ARRAY TO SORTED ARRAY */
		else if(!diffSorted)
		{
			tempTotalEntries = totalEntries; 
		}
		
		troubleshoot = 1; 
		document.getElementById("scroll").removeChild(table); 
		document.getElementById('header').removeChild(thead);
		columnText = new Array("Entry Name","", "Status: Running", "Client: Registered", "Diff(Status: Running, Client: Registered)", "Status: Idle", "Requested: Idle", 
		"Diff(Status: Idle, Requested: Idle)", "Client: User Idle"); 
		trColumnId = new Array("entryLinks","downtime", "status", "client","difference", "status", "requested", "difference","client"); 
		colors = new Array("#DCDCDC","DCDCDC","#FAF0E6", "#CDAF95", "#7D9EC0","#FAF0E6", "#FFDAB9","#7D9EC0", "#CDAF95"); 
		
		/* SET CHILD ARRAY */
		if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			child = new Array(feStatChild, feCMChild, feStatChild, feReqChild, feCMChild); 
		else	 
			child = new Array(totStatChild, totCMChild, totStatChild, totReqChild, totCMChild); 
			
		count = 0; 
		att = new Array(4, 2, 1, 0, 4); 
		rows = new Array(); 
		cols = new Array();
		trTable = document.createElement('table'); 
		trTable.setAttribute('id', 'trTable'); 
		trHeader = document.createElement('table'); 
		trHeader.setAttribute('id', 'trHeader'); 
		
		/* BUILD TR TABLE */
		for(i = 0; i < tempTotalEntries.length + 1; i++) 
		{
			if(childView && i > 0)
			{
				for(n = 1; n < tempTotalEntries[i - 1].childNodes[feChild].childNodes.length; n+=2)
				{
					if(tempTotalEntries[i - 1].childNodes[feChild].childNodes[n].attributes[0].value == frontEndName)
					{
						childView = n; 
						break; 	
					}
				}
			}
			count = 0; 
			rows[i] = document.createElement('tr');
			rows[i].setAttribute('id', 'entries'); 
			if(i != 0)
			{
				rows[i].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
				rows[i].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 
			}
			for(j = 0; j < columnText.length; j++) 
			{
				cols[j] = document.createElement('td'); 
				if(i > 0 && j > 0)
				{
					cols[j].setAttribute('onmouseover', 'showPopUp(this)');
					cols[j].setAttribute('onmouseout', 'hidePopUp()');
					cols[j].setAttribute('id', i); 
				}
				if(i == 0)
				{
					cols[j].appendChild(document.createTextNode(columnText[j]));
					cols[j].setAttribute('id', trColumnId[j]); 
					cols[j].setAttribute('bgColor', colors[j]);
					if(j == 0) cols[j].setAttribute('onclick', 'sortAlphabetical()'); 
					if(j == 1) cols[j].setAttribute('width', '2%'); 
					if(j > 1) cols[j].setAttribute('onclick', 'sortTrCol(this)'); 
				}
				else
				{
					if(j == 0)
					{						
						y = tempTotalEntries[i - 1].attributes.getNamedItem("name").firstChild.data; 
						hrefs[i - 1] = document.createElement('a');
						hrefs[i - 1].setAttribute("id", "entryLinks"); 
						hrefs[i - 1].innerHTML = y; 
						hrefs[i - 1].setAttribute("href", "factoryEntryStatusNow.html?entry=" + y);
						hrefs[i - 1].setAttribute("onclick", "entryClick(this)");
						cols[j].appendChild(hrefs[i - 1]); 
					}
					else if(j == 1)
					{
						val = document.createTextNode("ARROW"); 
						cols[j].setAttribute('width', '2%'); 
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
							item = tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[feDTChild].attributes[xmlAttDTNumArry[0]].value;
						else
							item = tempTotalEntries[i - 1].childNodes[dtChild].attributes[xmlAttDTNumArry[0]].value;
						
						if(item == "True"){ item = "&darr;"; cols[j].style.color = "#B0171F";} /* DOWN ARROW*/
						else { item = "&uarr;"; cols[j].style.color = "#008B00";  }            /* UP ARROW */
						cols[j].appendChild(document.createTextNode("")); 
						cols[j].innerHTML = item; 
					}
					else
					{
						val1 = 0; 
						val2 = 0;
						diff = 0;  

						/* IF DIFF COL */
						if(j == 4 || j == 7)
						{
							if(!childView)
							{
								try{ val1 = parseInt(tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count - 2]].attributes[att[count - 2]].value); }
								catch(err){ val1 = 0; }
								try{ val2 = parseInt(tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count - 1]].attributes[att[count - 1]].value); }
								catch(err){ val2 = 0; }
							}
							else
							{
								try{ val1 = parseInt(tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count - 2]].attributes[att[count - 2
								]].value);}
								catch(err){ val1 = 0; }
								try{ val2 = parseInt(tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count - 1]].attributes[att[count - 1
								]].value);}
								catch(err){ val2 = 0; }	
							}
						
							diff = val1 - val2; 
							cols[j].appendChild(document.createTextNode(diff));
						}
						else
						{
							if(!childView)
							{
								if((tempTotalEntries[i - 1].childNodes[totChild].childNodes.length < 7 && child[count] == totStatChild) || tempTotalEntries[i - 1].
								childNodes[totChild].childNodes.length == 0)	
								{
									cols[j].appendChild(document.createTextNode("0"));
								}
								else
								{
									val = tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count]].attributes[att[count]].value; 
									cols[j].appendChild(document.createTextNode(val));
								}	
							}
							else
							{
								if((tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length < 7 && child[count] == feStatChild) || 
								tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length == 0)	
								{
									cols[j].appendChild(document.createTextNode("0"));
								}
								else
								{
									val = tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count]].attributes[att[count]].value; 
									cols[j].appendChild(document.createTextNode(val));
								}	
							}
							count++; 
						}
					}
				}
				if(j == 0)
				{
					cols[j].setAttribute('width', '25%'); 	
				}
				rows[i].appendChild(cols[j]); 
			}
			if(i == 0)
			{
				trHeader.appendChild(rows[i]); 	
			}
			else
			{
				trTable.appendChild(rows[i]); 
			}	
		}
		
		document.getElementById("scroll").appendChild(trTable); 
		document.getElementById('header').appendChild(trHeader);
		
		/* SORT NORMAL COLUMN NONE DIFFERENCE COLUMN */
		if(sorted && (sortColName == "statusRunning" || sortColName == "cmGlideinTotal" || sortColName == "statusIdle" || sortColName == "requestIdle" || sortColName 
		== "cmGlideinJobsIdle"))
		{
			trSortSignal(trSortColNum);   	
		}
		/* DIFFERENCE COLUMN SORT */
		if(diffSorted)
		{
			trSortSignal(diffColSort); 	
		}
	}
	/* TROUBLESHOOT UNCHECKED HERE */
	else
	{
		/* RESET EVERYTHING */
		troubleshoot = 0; 
		diffSorted = 0; 
		trSortAsc = 0; 
		document.getElementById("scroll").removeChild(trTable); 
		document.getElementById('header').removeChild(trHeader);
		document.getElementById("scroll").appendChild(table); 
		document.getElementById('header').appendChild(thead);
		if(!diffSorted && sorted && sortColName != "statusRunning" && sortColName != "cmGlideinTotal" && sortColName != "statusIdle" && sortColName != "requestIdle" && 
		sortColName != "cmGlideinJobsIdle")
		{
			sortAlphabetical();
		}
	}
}

/* SORT TROUBELSHOOT || TROUBLESHOOT + PERIOD VIEW */
function sortTrCol(col)
{
	diffArry = new Array;
	exists = 0;  
	holder = diffSorted; diffSorted = 0; 
	
	/* REMOVE TROUBELSHOOT VIEW */
	if(!prTr)
	{
		troubleshoot = 1; 
		troubleshooting();	
	}
	/* REMOVE PERIOD + TROUBELSHOOT VIEW */
	else
	{
		periodTrView();	
		prTr = 1; 
	}
	
	diffSorted = holder; 
	
	/* GET NAME OF SORTED COL */ 
	if(col.innerHTML)
	{
		col = col.innerHTML;
	}

	entryLog = new Array(); 
	colMaster = new Array("Status: Running", "Client: Registered", "diff", "Status: Idle", "Requested: Idle", "diff", "Client: User Idle");
	sortColNum = new Array("statusRunning", "cmGlideinTotal", "diff", "statusIdle", "requestIdle", "diff", "cmGlideinJobsIdle"); 
	diffCol = new Array("Diff(Status: Running, Client: Registered)", "Diff(Status: Idle, Requested: Idle)");
	
	if(!prTr) diffCell = new Array(4, 7);
	else diffCell = new Array(5, 8);
	
	/* FRONTEND VIEW */
	if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
	{
		child = new Array(feStatChild, feCMChild, feStatChild, feReqChild); 
	} 
	/* TOTAL VIEW */
	else	 
		child = new Array(totStatChild, totCMChild, totStatChild, totReqChild); 
		
	att = new Array(4, 2, 1, 0); 
	diffColSort = 0; 

	/* REGULAR NONE DIFF SORT */
	for(i = 0; i < colMaster.length; i++)
	{
		if(col == colMaster[i])
		{
			tempHold = i;
			col = sortColNum[i];

			/* FIND INDEX OF SORTED COL */
			for(j = 0; j < columnArray.length; j++)
			{ 
				if(col == columnArray[j])
				{ 
					col = j; break;
				} 
			}
			sortTableDescending(col);
 			diffSorted = 0;
			/* RESTORE TROUBLESHOOT VIEW */
			if(!prTr)
			{
				hold = sorted; sorted = 0; 
				troubleshooting();
				sorted = hold; 
			}
			/* RESTORE TR + PEIROD VIEW */
			else
			{
				prTr = 0; temp = sorted; sorted = 0; 
				periodTrView();
				sorted = temp; 
			}
			trSortSignal(tempHold + 2); /* ENTRY NAME COL + DOWNTIME STATUS COL = 2 */
			return; 
		}
	}
				
	/* DIFF SORT ALGORITHM */
	for(j = 0; j < diffCol.length; j++)
	{
		/* DETERMINE WHICH DIFFERENCE COLUMN */
		if(col == diffCol[j])
		{
			diffColSort = diffCell[j];
			diffColName = diffCol[j];
			if(diffColNum != (j + 1))
			{			
				diffSorted = 0; 
				diffColNum = (j + 1); 	
			}
			if(!diffSorted)
			{
				tempTotalEntries = new Array(); 
				tempTotalEntriesP = new Array(); 
				tempTotalP = new Array(); 
				tempTotal = new Array(); 
			}
			/* FIRST GET ALL OF THE DIFF VALUES */
			if(!prTr)
			{
				for(k = 0; k < trTable.rows.length; k++)
				{
					diffArry.push(parseInt(trTable.rows[k].cells[diffCell[j]].innerHTML));
				}
			}
			else
			{
				for(k = 0; k < trpr_Table.rows.length; k++)
				{
					if(k % 4 == 0)
					{
						diffArry.push(parseInt(trpr_Table.rows[k].cells[diffCell[j]].innerHTML));
					}
				}
			}
			diffArry.sort(sortNumber); /* SORT THE DIFF VALUES */ 
			
			if(diffSorted != 1 && diffSorted != 2)
			{
				diffSorted = 1; 	
			}
			else if(diffSorted == 1)
			{
				tempTotalEntries.reverse();
				tempTotalEntriesP.reverse();
				
				tempTotalP.reverse(); 
				tempTotal.reverse(); 
				tempTotalP.splice(0,1); 
				tempTotal.splice(0,1); 

				tempTotal.push(1);
				tempTotalP.push(1);
				
				/* RESTORE TROUBLESHOOT VIEW */
				if(!prTr)
				{
					friend = sorted; sorted = 0; 
					troubleshooting();
					sorted = friend; 
				}
				/* RESTORE TR + PEIROD VIEW */
				else
				{
					prTr = 0; friend = sorted; sorted = 0; 
					periodTrView();
					sorted = friend; 
				}
				sorted = 0; 
				trSortSignal(diffColSort);
				diffSorted = 2; 
				return; 
			}
			else if(diffSorted == 2)
			{
				tempTotalEntries.reverse(); 
				tempTotalEntriesP.reverse();
				tempTotalP.reverse(); 
				tempTotal.reverse();
				
				tempTotalP.splice(0,1); 
				tempTotal.splice(0,1); 

				tempTotal.push(1);
				tempTotalP.push(1);
				
				/* RESTORE TROUBLESHOOT VIEW */
				if(!prTr)
				{
					friend = sorted; sorted = 0; 
					troubleshooting();
					sorted = friend; 
				}
				/* RESTORE TR + PEIROD VIEW */
				else
				{
					prTr = 0; friend = sorted; sorted = 0; 
					periodTrView();
					sorted = friend; 
				}
				sorted = 0; 
				trSortSignal(diffColSort);
				diffSorted = 1;
				return;  
			} 

			diffColNum = (j + 1); 
			
			/* SORT ATUAL ENTRY CONTENTS */
			for(l = 0; l < diffArry.length; l++)
			{
				for(k = 0; k < totalEntries.length; k++)
				{
					if(childView)
					{
						for(n = 1; n < totalEntries[k].childNodes[feChild].childNodes.length; n+=2)
						{
							if(totalEntries[k].childNodes[feChild].childNodes[n].attributes[0].value == frontEndName)
							{
								childView = n; 
								break; 	
							}
						}
					}
					if(childView)
					{ 
						val1 = 0; val2 = 0; helper = j; 
						if(helper == 1) helper++; 	
						try
						{
							val1 = parseInt(totalEntries[k].childNodes[feChild].childNodes[childView].childNodes[child[helper]].attributes[att[helper]].value); 
						}
						catch(err){}
						try
						{
							val2 = 	parseInt(totalEntries[k].childNodes[feChild].childNodes[childView].childNodes[child[helper + 1]].attributes[att[helper + 1]].
							value); 
						}
						catch(err){}
						diff =  val1 - val2; 
						if(val1 == 0 && val2 == 0)
						{
							diff = 0; 	
						}
						if(diff == diffArry[l])
						{
							for(p = 0; p < entryLog.length; p++)
							{
								if(k == entryLog[p])
								{
									exists = 1; 
									break; 	
								}	
							}
							if(exists == 1)
							{
								exists = 0; 
								continue; 	
							}
							entryLog.push(k);
							tempTotalEntries.push(totalEntries[k]);
							tempTotal.push(total[k]);
							
							tempTotalEntriesP.push(totalEntriesP[k]);
							tempTotalP.push(totalP[k]);
							break;  
						}	
					}	
					else	
					{
						val1 = 0; 
						val2 = 0;
						helper = j; 
						if(helper == 1)
						{
							helper++; 	
						} 
						try
						{
							val1 = parseInt(totalEntries[k].childNodes[totChild].childNodes[child[helper]].attributes[att[helper]].value); 
						}
						catch(err){}
						try
						{
							val2 = 	parseInt(totalEntries[k].childNodes[totChild].childNodes[child[helper + 1]].attributes[att[helper + 1]].value); 
						}
						catch(err){}
						diff =  val1 - val2;
						if(val1 == 0 && val2 == 0)
						{
							diff = 0; 	
						}
						if(diff == diffArry[l])
						{
							for(p = 0; p < entryLog.length; p++)
							{
								if(k == entryLog[p])
								{
									exists = 1; 
									break; 	
								}	
							}
							if(exists == 1)
							{
								exists = 0; 
								continue; 	
							}
							entryLog.push(k);
							tempTotalEntries.push(totalEntries[k]);
							tempTotal.push(total[k]);
							
							tempTotalEntriesP.push(totalEntriesP[k]);
							tempTotalP.push(totalP[k]);
							break;  
						}
					}
				}
			}
			tempTotal.push(1);
			tempTotalP.push(1);

			/* RESTORE TROUBLESHOOT VIEW */
			if(!prTr)
			{
				friend = sorted; sorted = 0; 
				troubleshooting();
				sorted = friend; 
			}
			/* RESTORE TR + PEIROD VIEW */
			else
			{
				prTr = 0; friend = sorted; sorted = 0; 
				periodTrView();
				sorted = friend; 
			}
			sorted = 0; 
			trSortSignal(diffColSort);
			return;  
		}
	}
}

/* SORTING ARRAY CONTENT  FUNCTION */
function sortNumber(a, b)
{
	return b - a; 
}

/* COLOR SORTED COL OF TR TABLE */
function trSortSignal(col)
{
	/* 
	 * FIND CORRECT DIFF COL INDEX TO COLOR
	 */
	if(prTr && diffSorted)
	{
		for(i = 0; i < trpr_THeader.rows[0].cells.length; i++)
		{
			if(trpr_THeader.rows[0].cells[i].innerHTML == diffColName){ col = i; break;} 
		}
		
	}
	else if(troubleshoot && diffSorted)
	{
		for(i = 0; i < trHeader.rows[0].cells.length; i++)
		{
			if(trHeader.rows[0].cells[i].innerHTML == diffColName){ col = i; break;}
		}
	}
	
	/* NONE COMPATIBLE SORT */
	if(col > headColArryTR.length) return; 
	
	/*
	 * COLOR SORTED COLUMN ACCORDING TO VIEW-------------------------------------------------------
	 */
	
	/* TR TABLE */
	if(!prTr)
	{	 
		for(i = 0; i < headColArryTR.length; i++)
		{
			for(j = 0; j < trTable.rows.length; j++)
			{
				if(i == col)
				{
					if(i == 2 || i == 5)
					{
						trTable.rows[j].cells[i].bgColor = "#FAF0E6";
					}
					else if(i == 3 || i == 8)
					{
						trTable.rows[j].cells[i].bgColor = "#CDAF95";
					}
					else if(i == 4 || i == 7)
					{
						trTable.rows[j].cells[i].bgColor = "#7D9EC0";
					}
					else if(i == 6)
					{
						trTable.rows[j].cells[i].bgColor = "#FFDAB9";
					}
				}
				else
				{
					trTable.rows[j].cells[i].bgColor = "#F2F2F2";
				}
			}
		}
	}
	
	if(prTr && diffSorted){ col--; }
	/* TR + PR TABLE */
	try
	{
		for(i = 2; i < headColArryTRPR.length; i++)
		{
			for(j = 0; j < trpr_Table.rows.length; j++)
			{
				temp = i;
				if(j % 4 == 0)
				{
					trpr_Table.rows[j].cells[1].bgColor = "#F2F2F2"; 
				}
				else
					trpr_Table.rows[j].cells[0].bgColor = "#F2F2F2";
					 
				if(j % 4 == 0){ temp++; }
				if(i == col)
				{
					if(i == 2 || i == 5)
					{
						trpr_Table.rows[j].cells[temp].bgColor = "#FAF0E6";
					}
					else if(i == 3 || i == 8)
					{
						trpr_Table.rows[j].cells[temp].bgColor = "#CDAF95";
					}
					else if(i == 4 || i == 7)
					{
						trpr_Table.rows[j].cells[temp].bgColor = "#7D9EC0";
					}
					else if(i == 6)
					{
						trpr_Table.rows[j].cells[temp].bgColor = "#FFDAB9";
					}
				}
				else
				{
					trpr_Table.rows[j].cells[temp].bgColor = "#F2F2F2";
				}
			}
		}
	}
	catch(err){}
}

/* PERIOD + TR VIEW */
function periodTrView()
{
	/* GET OUT OF THIS VIEW */
	if(prTr)
	{
		/* RESET && RESTORE DEF TABLE */
		prTr = 0; 
		if(!troubleshoot){diffSorted = 0; }
		document.getElementById('header').removeChild(trpr_THeader);
		document.getElementById('scroll').removeChild(trpr_Table);
		document.getElementById('scroll').appendChild(table);
		document.getElementById('header').appendChild(thead);
		
		/* RESTORE TROUBESHOOTING VIEW */
		if(troubleshoot){troubleshoot = 0; troubleshooting(); document.getElementById("note").style.visibility = "Hidden";}
		
		/* RESTORE PERIOD VIEW */
		if(periodV){periodV = 0; period(); document.getElementById("note").style.visibility = "Visible";}

		return; 			
	}
	/* GET OUT OF THE PREVIOUS VIEW */
	if(periodV) 
	{
		document.getElementById('header').removeChild(theadP); 
		document.getElementById('scroll').removeChild(tableP);
	}
	else if(troubleshoot)
	{
		document.getElementById("scroll").removeChild(trTable); 
		document.getElementById('header').removeChild(trHeader);
	}
	else
	{
		document.getElementById('scroll').removeChild(table);
		document.getElementById('header').removeChild(thead);
	}
	
	troubleshoot = 0; periodV = 0; 
	prTr = 1; 
	currChild = 1; 
	hrefs = new Array();

	/* NO COMPATIBLE SORT SO RESTORE TO ENTRY MASTER ARRAY */
	if(!diffSorted && sorted && sortColName != "statusRunning" && sortColName != "cmGlideinTotal" && sortColName != "statusIdle" && sortColName != "requestIdle" 
	&& sortColName != "cmGlideinJobsIdle")
	{
		tempTotalEntries = totalEntriesMaster;
		tempTotalEntriesP = totalEntriesPMaster; 
		tempTotal = totalMaster; 
		tempTotal = totalPMaster; 
	}
	/* EITHER NO SORT OR NO DIFF SORT */
	else if(!diffSorted) 
	{
		tempTotalEntries = totalEntries; 
		tempTotalEntriesP = totalEntriesP;
		tempTotal = total; 
		tempTotalP = totalP; 
	}
	
	headerText = new Array("Entry Name","", "Period", "Status: Running", "Client: Registered", "Diff(Status: Running, Client: Registered)", "Status: Idle", 
	"Requested: Idle", 
		"Diff(Status: Idle, Requested: Idle)", "Client: User Idle"); 	
	colors = new Array("#DCDCDC", "#F2F2F2", "#FFFAF0", "#FAF0E6", "#CDAF95", "#7D9EC0","#FAF0E6", "#FFDAB9","#7D9EC0", "#CDAF95"); 
	trColumnId = new Array("entryLinks", "downtime","period",  "status", "client","difference", "status", "requested", "difference","client"); 

	/* FRONTEND VIEW */
	if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
		child = new Array(feStatChild, feCMChild, feStatChild, feReqChild, feCMChild);
	/* TOTAL VIEW */ 
	else	 
		child = new Array(totStatChild, totCMChild, totStatChild, totReqChild, totCMChild); 
	
	/* ARRAYS FOR INFO ACCESSING */
	trAttArry = new Array();         	   trChildArry = new Array();	  trFEChildArry = new Array();
	trAttArry.push(xmlAttTotalNumArry[1]); trChildArry.push(totStatChild); trFEChildArry.push(feStatChild);
	trAttArry.push(xmlAttTotalNumArry[16]); trChildArry.push(totCMChild);   trFEChildArry.push(feCMChild);
	trAttArry.push(0);               	   trChildArry.push(0);			  trFEChildArry.push(0);
	trAttArry.push(xmlAttTotalNumArry[2]); trChildArry.push(totStatChild); trFEChildArry.push(feStatChild);
	trAttArry.push(xmlAttTotalNumArry[10]); trChildArry.push(totReqChild);  trFEChildArry.push(feReqChild);  
	trAttArry.push(0); 					   trChildArry.push(0);            trFEChildArry.push(0);
	trAttArry.push(xmlAttTotalNumArry[15]); trChildArry.push(totCMChild);   trFEChildArry.push(feCMChild);

	prAttArry = new Array(); 
	prAttArry.push(xmlAttPeriodNumArry[0]);
	prAttArry.push(xmlAttPeriodNumArry[15]);
	prAttArry.push(0);
	prAttArry.push(xmlAttPeriodNumArry[1]);
	prAttArry.push(xmlAttPeriodNumArry[9]);
	prAttArry.push(0);
	prAttArry.push(xmlAttPeriodNumArry[14]);
	
	rows = new Array(); 
	cols = new Array();
	headerCols = new Array();  
	rowHeader = document.createElement('tr');  
	
	/* SET UP TABLE */	
	trpr_Table = document.createElement('table'); 
	trpr_TBody = document.createElement('tbody'); 
	trpr_Table.setAttribute('id', 'trTable'); 
	trpr_THeader = document.createElement('table'); 
	trpr_THBody = document.createElement('tbody'); 
	trpr_THeader.setAttribute('id', 'trHeader');
	
	/* HEADER */
	for(x = 0; x < 10; x++)
	{
		headerCols[x] = document.createElement('td');
		headerCols[x].setAttribute('bgColor', colors[x]);
		td1Txt = document.createTextNode(headerText[x]);
		headerCols[x].appendChild(td1Txt);
		if(x == 0) headerCols[x].setAttribute("width", "23%");
		if(x == 1) headerCols[x].setAttribute("width", "2%");
		rowHeader.appendChild(headerCols[x]); 
		headerCols[x].style.fontWeight = "bold";
		if(x != 0) headerCols[x].setAttribute("align", "center");
		if(x == 0 && x != 1) headerCols[x].setAttribute('onclick', 'sortAlphabetical()'); 
		if(x > 2 && x != 1) headerCols[x].setAttribute('onclick', 'sortTrCol(this)'); 
	}
	trpr_THBody.appendChild(rowHeader); 
	trpr_THeader.appendChild(trpr_THBody); 
	document.getElementById('header').appendChild(trpr_THeader);
	
	friend = headerText.length; 

	/* BODY */
	for(c = 0; c < tempTotalEntriesP.length * 4; c++)
	{
		rows[c] = document.createElement('tr');	
		rows[c].setAttribute('id', 'entries'); 
		rows[c].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
		rows[c].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 

		/* COLS */
		for(k = 0; k < friend; k++) 
		{
			friend = headerText.length; 
			cols[k] = document.createElement('td');
			if(c % 4 == 0 && k == 0)
			{
				cols[k].setAttribute("bgColor", "#F2F2F2");
				cols[k].setAttribute('rowspan', '4'); 	
			}
			if(c % 4 != 0 && c != 0)
			{
				friend--;  
			}
			
			/* POP UPS */
			if(k > 1)
			{
				if(c > 0 && (k > 2 || k == 1))
				{
					cols[k].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cols[k].setAttribute('id', c); 
					cols[k].setAttribute('onmouseout', 'hidePopUp()');
				}
				else
				{
					cols[k].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cols[k].setAttribute('id', c); 
					cols[k].setAttribute('onmouseout', 'hidePopUp()');
					cols[k - 1].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cols[k - 1].setAttribute('id', c);  				
					cols[k - 1].setAttribute('onmouseout', 'hidePopUp()');
				}
			}
			
			if(k == 0) cols[k].setAttribute('width', '23%'); 
			if(k == 1){ cols[k].setAttribute("width", "2%"); if(c % 4 != 0) cols[k - 1].innerHTML = ""; }
			cont = document.createTextNode(0 + "");
			cols[k].appendChild(cont);		
			rows[c].appendChild(cols[k]);
		}
		trpr_TBody.appendChild(rows[c]);
		tableMade = 1;
	}
	trpr_Table.appendChild(trpr_TBody); 
	document.getElementById('scroll').appendChild(trpr_Table);
	document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 	
	document.getElementById("total").innerHTML= " &bull;" + "View has: " + numberRows + " Total Entries - (" + preFrontEndName + ")"; 

	/* ENTRY NAMES */ 
	count = 0; 
	for(i = 0; i < tempTotalEntriesP.length * 4; i++)
	{
		if(i % 4 == 0)
		{
			y = tempTotalEntriesP[count].attributes.getNamedItem("name").firstChild.data; 
			trpr_Table.rows[i].cells[0].innerHTML = "";
			links[i] = document.createElement('a');
			links[i].setAttribute("id", "entryLinks"); 
			links[i].innerHTML = y; 
			links[i].setAttribute("href", "factoryEntryStatusNow.html?entry=" + y);
			links[i].setAttribute("onclick", "entryClick(this)");
			trpr_Table.rows[i].cells[0].appendChild(links[i]);
			count++;  
		}
	}
	
	/* FILL IN DOWNTIME FIELDS */ 
	for(i = 0; i < totalEntries.length; i++)
	{
		DISPLACE = 4*i;
		if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
		{
			var item = total[i].childNodes[feDTChild].attributes[xmlAttDTNumArry[0]].value;
		}
		else
			var item = totalEntries[i].childNodes[dtChild].attributes[xmlAttDTNumArry[0]].value;
		
		if(item == "True"){ item = "&darr;"; trpr_Table.rows[DISPLACE].cells[1].style.color = "#B0171F";} /* DOWN ARROW*/
		else { item = "&uarr;"; trpr_Table.rows[DISPLACE].cells[1].style.color = "#008B00";  }            /* UP ARROW */
		trpr_Table.rows[DISPLACE].cells[1].innerHTML = item; 
	}
	
	childArry = new Array(0, 3, 5, 1); 
	
	/* PERIOD NAMES */
	count = 0;
	child = 7;
	four = 0; 
	valFinal = 0;   
	for(i = 0; i < trpr_Table.rows.length; i++)
	{
		if(i % 4 != 0)
		{
			valFinal = 0; 
			val = tempTotalEntriesP[count].childNodes[1].childNodes[1].childNodes[childArry[four]].attributes[0].value; 
			val2 = val % 60; /* Remaining seconds */

			/* Minutes */ val3 = val / 60;
			valFinal = val3 + " mins"; 
			
			/* If more than 60 minutes converto hours. */
			if(val3 > 60)
			{
				/* Hours */ val4 = val3 / 60; 
				valFinal = val4 + " hours"; 

				/* If hours more than 24 convert to days. */	
				if(val4 > 24)
				{
					/* Days */ val5 = val4 / 24;
					valFinal = val5 + " days"; 
					
					/* If more than 365 days convert to years. */
					if(val5 > 365)
					{
						/* Years */ val6 = val5/ 365; 
						valFinal = val6 + " years"; 
					}
				}
			}
			
			trpr_Table.rows[i].cells[1].innerHTML = valFinal;
			if(childArry[four] == 3)
			{
				trpr_Table.rows[i].cells[1].setAttribute("bgColor", "#6495ED"); 
			}
			else if(childArry[four] == 5)
			{
				trpr_Table.rows[i].cells[1].setAttribute("bgColor", "#388E8E"); 
			}
			else if(childArry[four] == 1)
			{
				trpr_Table.rows[i].cells[1].setAttribute("bgColor", "#8E388E"); 
			}
			four++; 
			if(four == 4)
			{
				four = 0; 
				count++; 
			}
		}
		else
		{
			if(childArry[four] == 0)
			{
				four++; 
				trpr_Table.rows[i].cells[2].innerHTML = "Now";
				trpr_Table.rows[i].cells[2].setAttribute("bgColor", "#515151"); 
				continue; 
			}
			valFinal = 0; 
			val = tempTotalEntriesP[count].childNodes[1].childNodes[1].childNodes[childArry[four]].attributes[0].value; 
			val2 = val % 60; /* Remaining seconds */

			/* Minutes */ val3 = val / 60;
			valFinal = val3 + " mins"; 
			
			/* If more than 60 minutes converto hours. */
			if(val3 > 60)
			{
				/* Hours */ val4 = val3 / 60; 
				valFinal = val4 + " hours"; 

				/* If hours more than 24 convert to days. */	
				if(val4 > 24)
				{
					/* Days */ val5 = val4 / 24;
					valFinal = val5 + " days"; 
					
					/* If more than 365 days convert to years. */
					if(val5 > 365)
					{
						/* Years */ val6 = val5/ 365; 
						valFinal = val6 + " years"; 
					}
				}
			}
			trpr_Table.rows[i].cells[2].innerHTML = valFinal;
			four++; 
		}	
	}
	
	/* FILL IN REST */
	attCount = 0;
	att2Count = 0; 
	child = 1; 
	count = 0;
	for(i = 0; i < tempTotalEntriesP.length; i++)
	{
		child = 1;
		for(j = 0; j < 4; j++)
		{ 
			for(counter = 3; counter <= 9; counter++)
			{
				if(j == 0)
				{
					/* DIFFERENCES */
					if(counter == 5 || counter == 8)
					{
						/* Period elements have one extra att so when going back to totla noew field we move back att by one sortColNum. */
						if(tempTotal[i].childNodes.length != 0)
						{
							if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
							{	
								try
								{
									trpr_Table.rows[count].cells[counter].innerHTML = tempTotal[i].childNodes[trFEChildArry[counter - 5]].
									attributes[trAttArry[counter - 5]].value - 
									tempTotal[i].childNodes[trFEChildArry[counter - 4]].attributes[trAttArry[counter - 4]].value;
								}
								catch(err)
								{
									trpr_Table.rows[count].cells[counter].innerHTML = 0;
								}
							}
							else
							{
								try
								{
									trpr_Table.rows[count].cells[counter].innerHTML = tempTotal[i].childNodes[trChildArry[counter - 5]].attributes[trAttArry[counter - 5]].
									value - tempTotal[i].childNodes[trChildArry[counter - 4]].attributes[trAttArry[counter - 4]].value;
								}
								catch(err)
								{
									trpr_Table.rows[count].cells[counter].innerHTML = 0;	
								}
							}
						}
						else
							trpr_Table.rows[count].cells[counter].innerHTML = 0;
						continue;			
					}
					/* Period elements have one extra att so when going back to totla noew field we move back att by one sortColNum. */
					if(tempTotal[i].childNodes.length != 0 && tempTotal[i].childNodes.length >= 7 && counter != 5 && counter != 8)
					{
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
							trpr_Table.rows[count].cells[counter].innerHTML = tempTotal[i].childNodes[trFEChildArry[counter - 3]].attributes[trAttArry[counter - 3]].
							value;
						else 
							trpr_Table.rows[count].cells[counter].innerHTML = tempTotal[i].childNodes[trChildArry[counter - 3]].
							attributes[trAttArry[counter - 3]].value;
					}
					else
					{
						trpr_Table.rows[count].cells[counter].innerHTML = 0; 
					}
					continue;
				}
				try
				{
					/* DIFFERENCES */
					if(counter == 5 || counter == 8)
					{
						x = tempTotalP[i].childNodes[1].childNodes[childArry[j]].attributes[prAttArry[counter - 5]].value - 
						tempTotalP[i].childNodes[1].childNodes[childArry[j]].attributes[prAttArry[counter - 4]].value;
						x = Math.round(x * 100)/100; 
				   		trpr_Table.rows[count].cells[counter - 1].innerHTML = x; 
						continue; 
					}
					x = tempTotalP[i].childNodes[1].childNodes[childArry[j]].attributes[prAttArry[counter - 3]].value; 
					x = Math.round(x * 100)/100; 
				   	trpr_Table.rows[count].cells[counter - 1].innerHTML = x; 
				}
				catch(err)
				{
				   	trpr_Table.rows[count].cells[counter - 1].innerHTML = 0; 
				}
			}
			count++; 	
		}
 	}
	document.getElementById("note").style.visibility = "Visible";
	/* REGULAR SORT */
	if(sorted && (sortColName == "statusRunning" || sortColName == "cmGlideinTotal" || sortColName == "statusIdle" || sortColName == "requestIdle" || sortColName 
		== "cmGlideinJobsIdle"))
	{
		trSortSignal(trSortColNum); 	
	}
	/* A DIFF COLUMN SORT */
	if(diffSorted)
	{
		trSortSignal(diffColSort + prTr); 	
	}
}

/* BUILD PERIOD VIEW */
function period()
{
	/* RESTORE TROUBELSHOOT VIEW */
	if(prTr){troubleshoot = 1; periodV = 0; periodTrView();  return;}
	
	/*  
	 * REMOVE PRIOR VIEW'S!-------------------------------------------------------------------------------
	 */
	if(table && !periodV)
	{
		if(troubleshoot){ periodTrView(); return;}
		document.getElementById('scroll').removeChild(table);
		document.getElementById('header').removeChild(thead); 
	}
	else
	{
		document.getElementById('scroll').removeChild(tableP);
		document.getElementById('header').removeChild(theadP);
		document.getElementById('scroll').appendChild(table);
		document.getElementById('header').appendChild(thead);
		periodV = 0;
		document.getElementById("note").style.visibility = "Hidden";
		/* IF SORTED REFILL TABLE */
		if(sorted && !updating){fillIn();}
		return;  
	}
	
	/*
	 *  SET UP EVERYTHING TO BUIILD PERIOD VIEW-------------------------------------------------------------
	 */
	
	periodV = 1;
	tempTotalEntries = totalEntries; 
	tempTotalEntriesP = totalEntriesP;
	tempTotal = total; 
	tempTotalP = totalP;
	document.getElementById("note").style.visibility = "Visible"; 
							
	row=new Array();
	cell=new Array();
	cell2 = new Array();
	row2 = document.createElement('tr'); 

	row_num = totalEntriesP.length; 
	cell_num = columnArray.length + 1; /* THE EXTRA 1 IS FOR PERIOD COL */
	x = 0;

	theadP = document.createElement('table');
	thBodyP = document.createElement('tbody');
	theadP.setAttribute('id', 'thead');

	tableP = document.createElement('table');	
	tBodyP =document.createElement('tbody');
	tableP.setAttribute('id','table');
	colorArry = new Array("#FAF0E6", "#FFDAB9", "#CDAF95"); 
	hArry = new Array("#DCDCDC", "#F2F2F2", "#FFFAF0", "#FAF0E6", "#FFDAB9", "#CDAF95");
	hArry2 = new Array("", "", "Period:", "Status:", "Requested:", "Client Monitor:");
	hArry3 = new Array(1, 1, 1,xmlAttStatNumArry.length, xmlAttReqNumArry.length, xmlAttCMNumArry.length);
	
	/*
	 * BEGIN BUILDING TABLE -------------------------------------------------------------------------------
	 */ 

	/* HEADER */
	for(x = 0; x < 6; x++)
	{
		cell2[x] = document.createElement('td');
		cell2[x].style.fontWeight = "bold";
		cell2[x].setAttribute("align", "center");
		cell2[x].setAttribute('bgColor', hArry[x]);
		txt = document.createTextNode(hArry2[x]);
		if(x == 0) cell2[x].setAttribute("width", "23%");
		if(x == 1) cell2[x].setAttribute("width", "2%");	
		cell2[x].setAttribute('colspan', hArry3[x]);
		cell2[x].appendChild(txt);
		row2.appendChild(cell2[x]); 
	}
	
	thBodyP.appendChild(row2); 
	friend = cell_num; 

	/* BODY (ROWS * 4) */
	for(c = 0; c < row_num * 4 + 1; c++)
	{
		row[c] = document.createElement('tr');	
		row[c].setAttribute('id', 'entries'); 
		if(c > 0)
		{
			row[c].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
			row[c].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 
		}
		/* COLUMNS */
		for(k = 0; k < friend; k++) 
		{
			friend = cell_num; 
			cell[k] = document.createElement('td');
			if((c + 3) % 4 == 0 && k == 0)
			{
				cell[k].setAttribute("bgColor", "#F2F2F2"); 	
			}
			if((c + 3) % 4 != 0 && c != 0)
			{
				friend--;  
			}
			if(((c + 3) % 4 == 0) && k == 0)
			{
				cell[k].setAttribute('rowspan', '4'); 	
			}
			/* MOUSE OVER ADJUSTMENTS */
			if(c > 0 && (k > 2 || k == 1))
			{
				if((c - 1) % 4 == 0)
				{
					cell[k].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cell[k].setAttribute('id', c); 
					cell[k].setAttribute('onmouseout', 'hidePopUp()');
				}
				else
				{
					cell[k].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cell[k].setAttribute('id', c); 
					cell[k].setAttribute('onmouseout', 'hidePopUp()');
					cell[k - 1].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cell[k - 1].setAttribute('id', c);  				
					cell[k - 1].setAttribute('onmouseout', 'hidePopUp()');
				}
			}
			if(c > 0 && k == 0)
			{
				cell[k].setAttribute('width', '23%');  				
			}
			if(c > 0 && k == 1)
			{
				cell[k].setAttribute('width', '2%');
				if((c-1) % 4 != 0) cell[k - 1].innerHTML = "";  
			}
			if(c == 0 && k == 0)
			{
				cont = document.createTextNode("Entry Name")
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', 'entryName'); 
	    		cell[k].setAttribute("onclick", "sortAlphabetical()");
				cell[k].setAttribute('bgColor', '#DCDCDC');  	 
			}
			if(c == 0 && k == 1) cell[k].setAttribute('bgColor', '#F2F2F2');  	 
			if(c == 0 && k == 2)
			{
				cont = document.createTextNode("Name")
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', ''); 
			    cell[k].setAttribute("onclick", ""); 
				cell[k].setAttribute('bgColor', '#FFFAF0'); 	 
			}
			if(c == 0 && k >= 3)
			{
				cont = document.createTextNode(headColArryPR[k - 2])
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', 'k'); 
			    cell[k].setAttribute("onclick", "sortTableDescending(this)"); 
				if(k < 11)
				{
					cell[k].setAttribute('bgColor', colorArry[0]); 
				}
				else if(k < 13)
				{
					cell[k].setAttribute('bgColor', colorArry[1]); 
				}
				else
					cell[k].setAttribute('bgColor', colorArry[2]); 
			}
			if(c > 0)
			{
				cont = document.createTextNode(0 + "")
				cell[k].appendChild(cont);
			}
			row[c].appendChild(cell[k]);
		}
		if(c == 0)
		{
			thBodyP.appendChild(row[c]); 
		}
		else
		{
			tBodyP.appendChild(row[c]);
		}
		tableMade = 1;
	}
	
	/*
	 *  APPEND AND FILL TABLE. ALSO COLOR COLS IF SORT VIEW--------------------------------- 
	 */
	theadP.appendChild(thBodyP); 
	tableP.appendChild(tBodyP); 
	document.getElementById('header').appendChild(theadP); 
	document.getElementById('scroll').appendChild(tableP);
	document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 	
	fillInPeriod();            /* FILL PERIOD TABLE */
	if(sorted){ sortSignal();} /* COLOR SORTED COLS IF SORTED */
}

/* FILL IN PERIOD TABLE */
function fillInPeriod()
{
	problem = 0;
	linkCount = 0;
	 
	/* IF TABLE IS NOT MADE BUILD IT!!! */
	if(tableMade == 0) makeTable();
	/* IF DROP DOWN LIST IS NOT MADE BUILD IT!!! */
	if(listMade == 0) makeList(); 	

	document.getElementById("total").innerHTML= " &bull;" + "View has: " + numberRows + " Total Entries - (" + preFrontEndName + ")"; 
	
	/* FILL IN ENTRY NAMES */
	count = 0; 
	for(i = 0; i < row_num * 4; i++)
	{
		if(i % 4 == 0)
		{
			y = totalEntriesP[count].attributes.getNamedItem("name").firstChild.data; 
			tableP.rows[i].cells[0].innerHTML = "";
			links[i] = document.createElement('a');
			links[i].setAttribute("id", "entryLinks"); 
			links[i].innerHTML = y; 
			links[i].setAttribute("href", "factoryEntryStatusNow.html?entry=" + y);
			links[i].setAttribute("onclick", "entryClick(this)");
			tableP.rows[i].cells[0].appendChild(links[i]);
			count++;  
		}
	}
	childArry = new Array(0, 3, 5, 1); DISPLACE = 0; 
	
	/* FILL IN DOWNTIME FIELDS */ 
	for(i = 0; i < totalEntries.length; i++)
	{
		DISPLACE = 4*i;
		if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
		{
			var item = total[i].childNodes[feDTChild].attributes[xmlAttDTNumArry[0]].value;
		}
		else
			var item = totalEntries[i].childNodes[dtChild].attributes[xmlAttDTNumArry[0]].value;
		
		if(item == "True"){ item = "&darr;"; tableP.rows[DISPLACE].cells[1].style.color = "#B0171F";} /* DOWN ARROW*/
		else { item = "&uarr;"; tableP.rows[DISPLACE].cells[1].style.color = "#008B00";  }            /* UP ARROW */
		tableP.rows[DISPLACE].cells[1].innerHTML = item; 
	}
	
	/* 
	 * FILL IN PERIOD NAMES
	 */
	count = 0;
	child = 7;
	four = 0; 
	valFinal = 0;   
	for(i = 0; i < tableP.rows.length; i++)
	{
		if(i % 4 != 0)
		{
			valFinal = 0; 
			val = totalEntriesP[count].childNodes[1].childNodes[1].childNodes[childArry[four]].attributes[0].value; 
			val2 = val % 60; /* Remaining seconds */

			/* Minutes */ val3 = val / 60;
			valFinal = val3 + " mins"; 
			
			/* If more than 60 minutes converto hours. */
			if(val3 > 60)
			{
				/* Hours */ val4 = val3 / 60; 
				valFinal = val4 + " hours"; 

				/* If hours more than 24 convert to days. */	
				if(val4 > 24)
				{
					/* Days */ val5 = val4 / 24;
					valFinal = val5 + " days"; 
					
					/* If more than 365 days convert to years. */
					if(val5 > 365)
					{
						/* Years */ val6 = val5/ 365; 
						valFinal = val6 + " years"; 
					}
				}
			}
			
			tableP.rows[i].cells[1].innerHTML = valFinal;
			if(childArry[four] == 3)
			{
				tableP.rows[i].cells[1].setAttribute("bgColor", "#6495ED"); 
			}
			else if(childArry[four] == 5)
			{
				tableP.rows[i].cells[1].setAttribute("bgColor", "#388E8E"); 
			}
			else if(childArry[four] == 1)
			{
				tableP.rows[i].cells[1].setAttribute("bgColor", "#8E388E"); 
			}
			four++; 
			if(four == 4)
			{
				four = 0; 
				count++; 
			}
		}
		else
		{
			if(childArry[four] == 0)
			{
				four++; 
				tableP.rows[i].cells[2].innerHTML = "Now";
				tableP.rows[i].cells[2].setAttribute("bgColor", "#515151"); 
				continue; 
			}
			valFinal = 0; 
			val = totalEntriesP[count].childNodes[1].childNodes[1].childNodes[childArry[four]].attributes[0].value; 
			val2 = val % 60; /* Remaining seconds */

			/* Minutes */ val3 = val / 60;
			valFinal = val3 + " mins"; 
			
			/* If more than 60 minutes converto hours. */
			if(val3 > 60)
			{
				/* Hours */ val4 = val3 / 60; 
				valFinal = val4 + " hours"; 

				/* If hours more than 24 convert to days. */	
				if(val4 > 24)
				{
					/* Days */ val5 = val4 / 24;
					valFinal = val5 + " days"; 
					
					/* If more than 365 days convert to years. */
					if(val5 > 365)
					{
						/* Years */ val6 = val5/ 365; 
						valFinal = val6 + " years"; 
					}
				}
			}
			tableP.rows[i].cells[2].innerHTML = valFinal;
			four++; 
		}	
	}
	
	/* 
	 * Fill in STATUS fields.  
	 */
	var attArry = new Array(13,10,16,12,14,15,11,9); 
	var attArry2 = new Array(4,1,7,3,5,6,2,0); 
	attCount = 0;
	att2Count = 0; 
	child = 1; 
	count = 0;
	for(i = 0; i < totalEntriesP.length; i++)
	{
		child = 1;
		for(j = 0; j < 4; j++)
		{ 
			attCount = 0; 
			attCount2 = 0;  
			for(counter = 3; counter <= 10; counter++)
			{
				if(j == 0)
				{
					/* Period elements have one extra att so when going back to totla noew field we move back att by one sortColNum. */
					if(total[i].childNodes.length != 0 && total[i].childNodes.length >= 7)
					{
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
						{	
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[feStatChild].attributes[xmlAttStatusArry[counter - 3]].value;
						}
						else
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[totStatChild].attributes[xmlAttStatusArry[counter - 3]].value;
					}
					else
					{
						tableP.rows[count].cells[counter].innerHTML = 0;
					}
					attCount2++; 
					continue;
				}
				try
				{
					x = totalP[i].childNodes[1].childNodes[childArry[j]].attributes[xmlAttPeriodNumArry[counter - 3]].value; 
					x = Math.round(x * 100)/100; 
				   	tableP.rows[count].cells[counter - 1].innerHTML = x; 
					attCount++; 
				}
				catch(err)
				{
				   	tableP.rows[count].cells[counter - 1].innerHTML = 0; 
					attCount++;
				}
			}
			count++; 	
		}
 	}
	
	/*
	 * Fill in REQ fields. 
	 */
	var attArry = new Array(8,7);
	var attArry2 = new Array(1,0); 
	attCount = 0;
	attCount2 = 0; 
	child = 1; 
	count = 0; 
	for(i = 0; i < totalEntries.length; i++)
	{
		child = 1;
		for(j = 0; j < 4; j++)
		{ 
			attCount = 0; 
			attCount2 = 0;  
			for(counter = 11; counter <= 12; counter++)
			{
				if(j == 0)
				{
					/* Period elements have one extra att so when going back to totla noew field we move back att by one sortColNum. */
					if(total[i].childNodes.length != 0)
					{
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
						{	
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[feReqChild].attributes[xmlAttReqArry[counter - 11]].value;
						}
						else
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[totReqChild].attributes[xmlAttReqArry[counter - 11]].value;					
					}
					else
					{
						tableP.rows[count].cells[counter].innerHTML = 0;
					}
					attCount2++; 
					continue;
				}
				try
				{
					x = totalP[i].childNodes[1].childNodes[childArry[j]].attributes[xmlAttPeriodNumArry[counter - 3]].value;
					x = Math.round(x * 100)/100; 
					tableP.rows[count].cells[counter - 1].innerHTML = x; 
					attCount++; 
				}
				catch(err)
				{
					tableP.rows[count].cells[counter - 1].innerHTML = 0; 
					attCount++; 
				}
				
			}
			count++; 	
		}	
 	}
	
	/* 
     * Fill in CM fields 
 	 */
	var attArry = new Array(2,6,1,5,3,4); 
	var attArry2 = new Array(1,5,0,4,2,3); 
	attCount = 0;
	attCount2 = 0; 
	child = 1; 
	count = 0; 
	for(i = 0; i < totalEntriesP.length; i++)
	{
		child = 1;
		for(j = 0; j < 4; j++)
		{ 
			attCount = 0; 
			attCount2 = 0;  
			for(counter = 13; counter < cell_num; counter++)
			{
				if(j == 0)
				{
					/* Period elements have one extra att so when going back to totla noew field we move back att by one sortColNum. */
					if(total[i].childNodes.length != 0)
					{
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
						{	
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[feCMChild].attributes[xmlAttCMArry[counter - 13]].value;
						}
						else
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[totCMChild].attributes[xmlAttCMArry[counter - 13]].value;					
					}
					else
					{
						tableP.rows[count].cells[counter].innerHTML = 0;
					}
					attCount2++; 
					continue;
				}
				try
				{
					x = totalP[i].childNodes[1].childNodes[childArry[j]].attributes[xmlAttPeriodNumArry[counter - 3]].value;
					x = Math.round(x * 100)/100; 
					tableP.rows[count].cells[counter - 1].innerHTML = x; 
					attCount++;
				}
				catch(err)
				{
					tableP.rows[count].cells[counter - 1].innerHTML = 0; 
					attCount++;
				}
			}
			count++; 	
		}	
 	}
}

/* RESTORE DEFAULT VIEW && URL */
function restoreDefault()
{
	holder = document.URL.split('?');
	document.location.href  = holder[0];
}

</script>
<style = "text/css">

td
{
	border: 2px solid #BBB;
	border-width: thin;
	font-size:12px;
	padding:5px;
}
#pgtitle
{
	color: #000; 	
	font: bold 330%/100% "Times New Roman";
	text-decoration:none;
	left:50%; 
}
#table, #trTable
{
	table-layout: fixed; 
	width: 100%; 
	background-color:#F2F2F2;
}
#total
{
	color:#D00;
}
#entries
{
	font-weight: bold;
}
#thead, #trHeader
{
	table-layout: fixed;
 	width: 99%; 
	text-align:left;
}
#choose 
{
	margin-left:auto;
	margin-right:auto;
	margin: 0;
	padding: 0;
	width: 170px;
}
#select
{
	color:#300;
	font-size:12px;
	font-weight:bold;
}
#update
{
	color: #303;
	font-size:13px;
	text-align: left;  
}
#note
{
	color: #303;
	font-size:13px;
	text-align: left;
	visibility: hidden;
	color:#F00;
	float: inherit;
}
#scroll
{
	overflow: scroll;
	width: auto;
	min-height:90%; 
}
#hoverpopup
{
	visibility:hidden;
	position:absolute; 
	top:0; left:0;
	background-color: #999;
}
#button, #reset
{
	font-weight:bold;
}
#link
{
	font-weight:bold;
    width: 70px;
	float: right;
}
#client, #status, #requested, #difference, #period, #downtime
{
	font-weight:bold;
	text-align:center;
}
#entryLinks
{
	text-decoration:none;
	font-weight:bold;
	color:#000;
}

</style>

</head>

<!-- RESIZE TABLE WHEN WINDOW IS RESIZED --> 
<body onResize = "setHeight()">

<!-- BEGIN SCRIPTING BY LOADING RRD XML -->
<script type = "text/javascript"> loadXMLRRD()  </script>
<div id = "pgtitle"  style="font-size: 40px" > Glidein Factory Status </div>

<!-- GLIDIEN DESTINATION LIST -->
<SELECT id="destination" style="float:right" onchange="goToDestination(this)" >
<OPTION VALUE="" >Choose a Glidein destination...</OPTION>
<OPTION VALUE="factoryEntryStatusNow.html"> Glidein entry. </OPTION>
<OPTION VALUE="factoryStatus.html"> Glidein factory status. </OPTION>
<OPTION VALUE="factoryLogStatus.html"> Glidein factory log status. </OPTION>
<OPTION VALUE="factoryCompletedStats.html"> Glidein factory completed stats. </OPTION>
<OPTION VALUE="factoryRRDBrowse.html"> Glidein factory browse. </OPTION>
<OPTION VALUE="factoryRRDEntryMatrix.html"> Glidein factory entry matrix. </OPTION>
</SELECT>

<h5 id = "total">(Total Entries)</h5>

<!-- SELECT A VIEW CHECK BOXES -->
<div id = "select">Select a view: <input type="checkbox" id = "active" name="option1" value="active" onclick= "selectActive()" > Active only
<input type="checkbox" id = "troubleshoot" name="option2" value="troubleshoot" onclick= "troubleshooting()" > Troubleshoot
<input type="checkbox" id = "period" name="option3" value="troubleshoot" onclick= "period()" > Period <br /> </div> 

<!-- FE + ANY DROP DOWN LIST --> 
<div id = "tempList"></div>                  
<br /><br /><br /><br />

<!-- UPDATE TABLE + GOTO LINK BUTTONS--> 
<form  > <input id = "button" type="button" value="Update Table"  onclick="updateTable()"/><form >  <input type="button" id = "reset" name="option3" value="Reset All Selections" onclick= "restoreDefault()" > </form>
<form  > <input id = "link" type="button" value="Link" onclick="goToLink()" /> </form>

<!-- PERIOD NOTE -->
<br /><div id = "note"> &#8727; Period data averaged over 2h, 24h, and 7d up to this time.</div><div id = "update"> Loading...  </div>

<!-- APPEND TABLES HERE -->
<div id = "header" > </div>
<div id = "scroll"></div> 
<div id = "hoverpopup"></div>
<div id = "monitor_footer"></div>

</body>
</html>
