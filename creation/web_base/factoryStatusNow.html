<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Glidein</title>

<script type="text/javascript">

var hover; 
var loading; 
var frontEndTable; 
var linkShown = 0; 
var loading = 1; 
var updating = 0; 
var col; 
var feArryMaster = new Array(); 
var thead; 
var updated; 
var numberRows = 0; 
var totalEntriesMaster; var totalEntriesPMaster;
var totalEntries; var totalEntriesP;
var totalMaster; var totalPMaster;
var feEntries; var feTotal; var feEntriesP; var feTotalP;  
var total;
var sorted = 0;
var previousSort;
var currentSort; 
var frontEnds; 
var listMade = 0; 
var frontEnd = 0;
var table; var trTable; var tableP; 
var select;
var nameLast;
var txt2 = new Array(1000); 
var count = 0; 
var tableMade = 0;  
var index = 0; 
var active = 0; 
var entryName; 
var troubleshoot = 0; 
var childView;
var frontEndName;  
var trTable; 
var diffSorted;
var tempTotal; 
var tempTotalEntries; 
var diffColNum; 
var trSortCol;  
var trSortAsc;
var periodV; 
var feChild; var feStatChild; var feReqChild; var feCMChild; var totChild; var totStatChild; var totReqChild; var totCMChild; 

var headColArry = new Array("Running", "Idle", "Waiting", "Pending", "Staging in", "Staging out", "Unknown", "Held",
							"Max run", "Idle", 
							"Claimed", "User running", "Unmatched", "User idle", "Registered", "Info age"); 

var columnArray = new Array("statusRunning", "statusIdle", "statusWait", "statusPending", "statusStageIn", "statusStageOut", "statusOther", "statusHeld",
							"requestMax", "requestIdle", 
							"cmGlideinRunning", "cmGlideinJobsRunning", "cmGlideinIdle", "cmGlideinJobsIdle", "cmGlideinTotal", "cmGlideinInfoAge");
						
var columnArry = new Array("statusrunning", "statusidle", "statuswait", "statuspending", "statusstagein", "statusstageout", "statusother", "statusheld",
							"requestmax", "requestidle", 
							"cmglideinrunning", "cmglideinjobsrunning", "cmglideinidle", "cmglideinjobsidle", "cmglideintotal", "cmglideininfoage");
							
var columnSearch = new Array("status_running", "status_idle", "status_wait", "status_pending", "status_stage_in", "status_stage_out", "status_other", "status_held",
							"request_max", "request_idle", 
							"cm_glidein_running", "cm_glidein_jobs_running", "cm_glidein_idle", "cm_glidein_jobs_idle", "cm_glidein_total", "cm_glidein_info_age");;
			
var exactColumns = new Array("Status: Running", "Status: Idle", "Status: Waiting", "Status: Pending", "Status: Stage in", "Status: Stage out", "Status: Unknown",
							 "Status: Held", "Requested: Max run", "Requested : Idle", "Client Monitor: Claimed", "Client Monitor: User Running",  
							 "Client Monitor: Unmatched", "Client Monitor: User idle", "Client Monitor: Registered", "Client Monitor: Info age");  
var trColumns = new Array("Status: Running", "Client Monitor: Registered", "Diff(Status: Running, Client: Registered)", "Status: Idle", "Requested: Idle", 
                           "Diff(Status: Idle, Requested: Idle)", "Client Monitor: User Idle"); 	 
                 
var preFrontEndName = "Total"; 
var links = new Array(); 
var sortedColumn; 


/* Displays the hover pop ups for each entry/attribute in def total table and any view. */
function showPopUp(hoveritem)
{
	child1 = 0; 
	child2 = 0; 
	att1 = 0; 
	att2 = 0;
	
	if(preFrontEndName != "Total" && preFrontEndName != "Any"){return; }
	
	column = hoveritem.cellIndex; 
	if(frontEndTable)
	{
		document.getElementById('hoverpopup').removeChild(frontEndTable);
	}
	if(diffSorted && troubleshoot)
	{
		friend = totalEntries; 
		totalEntries = tempTotalEntries; 
	}
	row = hoveritem.id; 
	frontEndTable = document.createElement('table'); 
	
	entry = totalEntries[row - 1]; 
	hover = document.getElementById("hoverpopup");
	head = document.getElementById("header");
    scrollDiv = document.getElementById("scroll"); 

	/* If no frontends exist. */
	if(entry.childNodes[totChild].childNodes.length == 0)
	{
		tr1 = document.createElement('tr'); 
		tr2 = document.createElement('tr'); 
		tr3 = document.createElement('tr'); 
		td1 = document.createElement('td');
		td2 = document.createElement('td');
		td3 = document.createElement('td'); 
		cont = document.createTextNode(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data);
		if(troubleshoot)
		{
			cont2 = document.createTextNode(trColumns[column - 1]);
		}
		else
		{
			cont2 = document.createTextNode(exactColumns[column - 1]);
		}
		cont3 = document.createTextNode("No Frontends Exist");

		td1.appendChild(cont); 
		td2.appendChild(cont2);
		td3.appendChild(cont3); 

		tr1.appendChild(td1);
		tr2.appendChild(td2);
		tr3.appendChild(td3);
		
		frontEndTable.appendChild(tr1);
		frontEndTable.appendChild(tr2);
		frontEndTable.appendChild(tr3);

		hover.appendChild(frontEndTable); 
		
		if(troubleshoot)
		{
			hover.style.top = head.offsetTop + hoveritem.offsetTop - 45 - scrollDiv.scrollTop + "px";
		}
		else
		{
			hover.style.top = head.offsetTop + hoveritem.offsetTop - 15 - scrollDiv.scrollTop + "px";
		}

		if(column == 16)
		{
			hover.style.left = hoveritem.offsetLeft - 90 + "px";
		}
		else
		{
			hover.style.left = hoveritem.offsetLeft - 70 + "px";
		}

		hover.style.visibility = "Visible";
		return; 
	}
	
	hover.appendChild(frontEndTable); 
	
	tr1 = document.createElement('tr'); 
	tr2 = document.createElement('tr'); 
	td1 = document.createElement('td');
	td2 = document.createElement('td');
	td3 = document.createElement('td');
	td4 = document.createElement('td');
	cont = document.createTextNode(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data);
	if(troubleshoot)
	{
		cont2 = document.createTextNode(trColumns[column - 1]);
	}
	else
	{
		cont2 = document.createTextNode(exactColumns[column - 1]);
	}
	
	if(troubleshoot)
	{
		if(column == 2)
		{
			column = 15; 
		}
		else if(column == 4)
		{
			column = 2; 
		}
		else if(column == 5)
		{
			column = 10; 
		}
		else if(column == 7)
		{
			column = 14; 
		}
		else if(column == 3)
		{
			child1 = feStatChild;
			child2 = feCMChild;
			att1 = 4;
			att2 = 2;
		}
		else if(column == 6)
		{
			child1 = feStatChild;
			child2 = feReqChild; 
			att1 = 1; 
			att2 = 0; 
		}
	}	
	
	td1.appendChild(cont); 
	td2.appendChild(cont2);
	tr1.appendChild(td1);
	tr2.appendChild(td2);
	tr1.appendChild(td3);
	tr2.appendChild(td4);
	frontEndTable.appendChild(tr1);
	frontEndTable.appendChild(tr2);

	numFE = totalEntries[row -1].childNodes[feChild].childNodes.length; /* How many front ends the specified entry has. */
	ends = totalEntries[row -1].childNodes[feChild]; /* The front ends the specifed entry has. */
	
	var unsortedFE = new Array(); 
	var sortedFE = new Array();
	 
	for(i = 1; i < numFE; i+=2)
	{
		unsortedFE.push(ends.childNodes[i]); 
	}
	for(i = 0; i< feArryMaster.length; i++)
	{
		for(j = 0; j < unsortedFE.length; j++)
		{
			if(feArryMaster[i].attributes[0].nodeValue == unsortedFE[j].attributes[0].nodeValue)
			{
				sortedFE.push(unsortedFE[j]); 	
			}
		}
	}
	if(numFE == 0)
	{
		tr3 = document.createElement('tr');
		td3 = document.createElement('td'); 
		cont3 = document.createTextNode("No Frontends Exist");
		td3.appendChild(cont3);
		tr3.appendChild(td3);
		frontEndTable.appendChild(tr3);
	}
	else
	{   i = 0;
		x = 0; 
		while(i < sortedFE.length)
		{ 
			tr = document.createElement('tr'); 
			td = document.createElement('td'); 
			txt = document.createTextNode(sortedFE[i].attributes[0].nodeValue + ":");
			td2 = document.createElement('td');

			if((column == 3 || column == 6) && troubleshoot)
			{
				val1 = 0; 
				val2 = 0; 
				diff = 0; 
				try{ val1 = parseInt(sortedFE[i].childNodes[child1].attributes[att1].nodeValue); } catch(err){}
				try{ val2 = parseInt(sortedFE[i].childNodes[child2].attributes[att2].nodeValue); } catch(err){}
				diff = val1 - val2; 
				txt2 = document.createTextNode(diff);
			}
			else if(column > 0 && column < 9)
			{
				if(sortedFE[i].childNodes.length >= 7)
				{
					var attArry = new Array(4,1,7,3,5,6,2,0);
					txt2 = document.createTextNode(sortedFE[i].childNodes[feStatChild].attributes[attArry[column - 1]].nodeValue);
				}
				else
				{
					txt2 = document.createTextNode(0);
				}
			} 
			else if(column == 9 || column == 10)
			{
				if(sortedFE[i].childNodes.length >= 5)
				{
					var attArry = new Array(1,0);
					txt2 = document.createTextNode(sortedFE[i].childNodes[feReqChild].attributes[attArry[column - 9]].nodeValue);
				}
				else
				{
					txt2 = document.createTextNode(0);
				}
			}
			else	
			{
				if(sortedFE[i].childNodes.length >= 3)
				{
					var attArry = new Array(1,5,0,4,2,3);
					txt2 = document.createTextNode(sortedFE[i].childNodes[feCMChild].attributes[attArry[column - 11]].nodeValue);
				}
				else
				{
					txt2 = document.createTextNode(0);
				}
			}
 	
			td.appendChild(txt); 
			tr.appendChild(td);
			td2.appendChild(txt2);
			td2.setAttribute('align', 'right');  
			tr.appendChild(td2); 
			frontEndTable.appendChild(tr); 
			i++; 
			if(i > 1)
			{
				x++; 
			}
		}	
	}
	
	/* Adjust hover pop ups position and visibility. */
	hover.appendChild(frontEndTable);
	if(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data.length > 26 && column == 15){hover.style.left = hoveritem.offsetLeft - 150 + "px";}
	else if(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data.length > 31 && column == 16){hover.style.left = hoveritem.offsetLeft - 190 + "px";}
	else if(totalEntries[row-1].attributes.getNamedItem("name").firstChild.data.length > 21 && column == 16){hover.style.left = hoveritem.offsetLeft - 130 + "px";}
	else hover.style.left = hoveritem.offsetLeft - 110 + "px";
	if(troubleshoot){hover.style.top = head.offsetTop + hoveritem.offsetTop - 45 - (30 * x) - scrollDiv.scrollTop + "px";}
	else hover.style.top = head.offsetTop + hoveritem.offsetTop - 20 - (25 * x) - scrollDiv.scrollTop + "px";	
	hover.style.visibility = "Visible";	
	if(diffSorted && troubleshoot){totalEntries = friend;}

}
/* Shows pop ups for period table. */
function showPopUpPeriod(hoveritem)
{ 
	trStatArry = new Array(13,10,16,12,14,15,11,9); 
	trReqArry = new Array(8,7);
	trCMArry = new Array(2,6,1,5,3,4); 
    prFEChild = 0; 
	child1 = 0; 
	child2 = 0; 
	att1 = 0; 
	att2 = 0;
	pr = 0; /* Period fe info?*/
	timeFrame = " (Now)"; 
	
	/* If not in total view escape! */
	if(preFrontEndName != "Total" && preFrontEndName != "Any"){return;}
	
	/* Retrieve selection specs. */
	row = hoveritem.id; row--; 
	column = hoveritem.cellIndex; if(row % 4 == 0){column-=2;}else{column--;}   
	row2 = Math.floor(row/4); 
	if(row/4 != row2)
	{ 
		if((row - 1)/4 - row2 == 0)
		{
			timeFrame = " (2 Hours)"; pr = 3;  
		}
		else if((row - 1)/4 - row2 == 0.25)
		{
			timeFrame = " (24 Hours)"; pr = 5;
		}
		else
		{
			timeFrame = " (7 Days)"; pr = 1;
		}
	}
	row = Math.floor(row/4); 
 	 
	/* If hover object exists get rid of it. */
	if(frontEndTable){ document.getElementById('hoverpopup').removeChild(frontEndTable);}

	frontEndTable = document.createElement('table'); /* Create hover table. */
	
	entry = totalEntries[row]; 
	hover = document.getElementById("hoverpopup");
	head = document.getElementById("header");
    scrollDiv = document.getElementById("scroll"); 
	
	/* If no frontends exist. */
	if(entry.childNodes[totChild].childNodes.length == 0)
	{
		tr1 = document.createElement('tr'); 
		tr2 = document.createElement('tr'); 
		tr3 = document.createElement('tr'); 
		td1 = document.createElement('td');
		td2 = document.createElement('td');
		td3 = document.createElement('td'); 
		cont = document.createTextNode(totalEntries[row].attributes.getNamedItem("name").firstChild.data);
		cont2 = document.createTextNode(exactColumns[column] + timeFrame);
		cont3 = document.createTextNode("No Frontends Exist");

		td1.appendChild(cont); 
		td2.appendChild(cont2);
		td3.appendChild(cont3); 

		tr1.appendChild(td1);
		tr2.appendChild(td2);
		tr3.appendChild(td3);
		
		frontEndTable.appendChild(tr1);
		frontEndTable.appendChild(tr2);
		frontEndTable.appendChild(tr3);

		hover.appendChild(frontEndTable); 
		hover.style.top = head.offsetTop + hoveritem.offsetTop - 15 - scrollDiv.scrollTop + "px";

		if(column == 16)
		{
			hover.style.left = hoveritem.offsetLeft - 90 + "px";
		}
		else
		{
			hover.style.left = hoveritem.offsetLeft - 70 + "px";
		}

		hover.style.visibility = "Visible";
		return; 
	}
	
	hover.appendChild(frontEndTable); 
	tr1 = document.createElement('tr'); 
	tr2 = document.createElement('tr'); 
	td1 = document.createElement('td');
	td2 = document.createElement('td');
	td3 = document.createElement('td');
	td4 = document.createElement('td');
	cont = document.createTextNode(totalEntries[row].attributes.getNamedItem("name").firstChild.data);
	cont2 = document.createTextNode(exactColumns[column] + timeFrame);
	
	td1.appendChild(cont); 
	td2.appendChild(cont2);
	tr1.appendChild(td1);
	tr2.appendChild(td2);
	tr1.appendChild(td3);
	tr2.appendChild(td4);
	frontEndTable.appendChild(tr1);
	frontEndTable.appendChild(tr2);

	numFE = totalEntries[row].childNodes[feChild].childNodes.length; /* How many front ends the specified entry has. */
	ends = totalEntries[row].childNodes[feChild]; /* The front ends the specifed entry has. */
	
	unsortedFE = new Array(); 
	sortedFE = new Array();
	 
	for(i = 1; i < numFE; i+=2)
	{
		unsortedFE.push(ends.childNodes[i]); 
	}
	for(i = 0; i< feArryMaster.length; i++)
	{
		for(j = 0; j < unsortedFE.length; j++)
		{
			if(feArryMaster[i].attributes[0].nodeValue == unsortedFE[j].attributes[0].nodeValue)
			{
				sortedFE.push(unsortedFE[j]); 	
			}
		}
	}
	if(numFE == 0)
	{
		tr3 = document.createElement('tr');
		td3 = document.createElement('td'); 
		cont3 = document.createTextNode("No Frontends Exist");
		td3.appendChild(cont3);
		tr3.appendChild(td3);
		frontEndTable.appendChild(tr3);
	}
	else
	{   i = 0;
		x = 0; 
		while(i < sortedFE.length)
		{ 
			if(pr)
			{
				for(j = 1; i < totalEntriesP[row].childNodes[3].childNodes.length; j+=2)
				{
					if(totalEntriesP[row].childNodes[3].childNodes[j].attributes[0].nodeValue == ("frontend_" + sortedFE[i].attributes[0].nodeValue))
					{
						prFEChild = j; break;  
					}
				}
			}
			tr = document.createElement('tr'); 
			td = document.createElement('td'); 
			txt = document.createTextNode(sortedFE[i].attributes[0].nodeValue + ":");
			td2 = document.createElement('td');

			if(column < 8)
			{
				if(sortedFE[i].childNodes.length >= 7)				 
				{
					attArry = new Array(4,1,7,3,5,6,2,0);
					if(!pr){txt2 = document.createTextNode(sortedFE[i].childNodes[feStatChild].attributes[attArry[column]].nodeValue);}
					else{txt2 = document.createTextNode(Math.round(totalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[trStatArry[column]].nodeValue * 100)/100);}
				}
				else
					txt2 = document.createTextNode(0);
			} 
			else if(column == 8 || column == 9)
			{
				if(sortedFE[i].childNodes.length >= 5)
				{
					attArry = new Array(1,0);
					if(!pr){txt2 = document.createTextNode(sortedFE[i].childNodes[feReqChild].attributes[attArry[column - 8]].nodeValue);}
					else{txt2 = document.createTextNode(Math.round(totalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[trReqArry[column - 8]].nodeValue * 100)/100);}
				}
				else
					txt2 = document.createTextNode(0);
			}
			else	
			{
				if(sortedFE[i].childNodes.length >= 3)
				{
					attArry = new Array(1,5,0,4,2,3);
					if(!pr){txt2 = document.createTextNode(sortedFE[i].childNodes[feCMChild].attributes[attArry[column - 10]].nodeValue);}
					else{txt2 = document.createTextNode(Math.round(totalEntriesP[row].childNodes[3].childNodes[prFEChild].childNodes[1].childNodes[pr].
					attributes[trCMArry[column - 10]].nodeValue * 100)/100);}
				}
				else
					txt2 = document.createTextNode(0);
			}
 	
			td.appendChild(txt); 
			tr.appendChild(td);
			td2.appendChild(txt2);
			td2.setAttribute('align', 'right');  
			tr.appendChild(td2); 
			frontEndTable.appendChild(tr); 
			i++; 
			if(i > 1)
			{
				x++; 
			}
		}	
	}
	
	/* Adjust hover pop ups position and visibility. */
	hover.appendChild(frontEndTable);
	if(totalEntries[row].attributes.getNamedItem("name").firstChild.data.length > 26 && column == 15){hover.style.left = hoveritem.offsetLeft - 150 + "px";}
	else if(totalEntries[row].attributes.getNamedItem("name").firstChild.data.length > 31 && column == 16){hover.style.left = hoveritem.offsetLeft - 190 + "px";}
	else if(totalEntries[row].attributes.getNamedItem("name").firstChild.data.length > 21 && column == 16){hover.style.left = hoveritem.offsetLeft - 130 + "px";}
	else hover.style.left = hoveritem.offsetLeft - 110 + "px";
	hover.style.top = head.offsetTop + hoveritem.offsetTop - 20 - (25 * x) - scrollDiv.scrollTop + "px";
	hover.style.visibility = "Visible";	
}
function hidePopUp()
{
	if(preFrontEndName != "Total" && preFrontEndName != "Any")
	{
		return; 
	}
	hover = document.getElementById("hoverpopup");
	hover.style.visibility = "Hidden";
}

function showErr()
{
	alert("The Glidein tool is currently only fully functional on the latest browsers. Update your browser and try again. We apologize for the inconvenience."); 	
	window.close(); 
}
function showTime()
{
	updated = updated[0].childNodes[1].attributes[3].firstChild.nodeValue;	
	document.getElementById("update").innerHTML= "XML last update:   " + updated; 	
}
function sortAlphabetical()
{	
	trSortAsc = 0; /* Reset to initially sort descending. */
	/* No longer sorted! */
	diffSorted = 0; 
	sorted = 0;
	currentSort; 
	index = -2; 
	
	/* Take out tr table to reset everything. */
	if(troubleshoot){troubleshooting(); troubleshoot = 1;}

	/* Remove period table for time being. */
	if(periodV){period(); periodV = 1;}

	sortSignal(); /* Take out sort colors. */
	
	/* If in Total view. */
	if(frontEnd == 0)
	{
		/* Reset everything for regular table. */
		totalEntries = totalEntriesMaster;
		total = totalMaster; 
		totalEntriesP = totalEntriesPMaster;
		totalP = totalPMaster; 
		numberRows = totalEntries.length;
		
		if(active)
		{	
			active = 0; 
			friend = troubleshoot; troubleshoot = 0; 
			friend2 = periodV; periodV = 0; 
			selectActive(); 
			troubleshoot = friend; 
			periodV = friend2; 
		} 
		
		/* Restore default table. */
		fillIn();
		
		/* If in period view restore view. */ 
		if(periodV){periodV = 0; period(); fillInPeriod();}
		
		/* Put in the tr table with the update information. */
		if(troubleshoot)
		{
			troubleshoot = 0; 			
			troubleshooting(); 
		}
	}
	else /* If in one of the frontend or Any views. */
	{
		if(troubleshoot)
		{	
			troubleshoot = 0; 
			loadFrontEnd(nameLast); 
			troubleshoot = 1;
		}
		else
		{
			/* Restore to unsorted. */
			friend = periodV; periodV = 0; 
			friend2 = active; active = 0; 
			loadFrontEnd(nameLast);  
			periodV = friend; 
			active = friend2; 
		}
		
		if(active)
		{	
			active = 0; 
			friend = troubleshoot; troubleshoot = 0; 
			friend2 = periodV; periodV = 0; 
			selectActive(); 
			troubleshoot = friend; 
			periodV = friend2; 
		} 
		
		/* If in period view restore view. */ 
		if(periodV){periodV = 0; period(); fillInPeriod();}
		
		if(troubleshoot)
		{
			troubleshoot = 0; 			
			troubleshooting(); 
		}
	}
}
function makeList()
{
	var feArry = new Array(); 
    feArryMaster = feArry; 
	if(select)
	{
		document.getElementById('tempList').removeChild(select);
	}
	select = document.createElement("select");
	select.setAttribute('id','choose');
	select.setAttribute("onchange", "loadFrontEnd(document.getElementById('choose').value)"); 
	var def = document.createElement("option"); 
	defTxt = document.createTextNode("Total (Default)");
	var any = document.createElement("option"); 
	anyTxt = document.createTextNode("Any");
	def.appendChild(defTxt); 
	select.appendChild(def); 
	any.appendChild(anyTxt); 
	select.appendChild(any); 
	
	for(i = 0; i < frontEnds.length; i++)
	{
		if(i == 0)
		{
			feArry.push(frontEnds[i]); 
			fe = document.createElement("option"); 
			txt1 = frontEnds[i].attributes.getNamedItem("name").firstChild.data;
			feTxt = document.createTextNode(txt1);
			fe.appendChild(feTxt); 
			select.appendChild(fe); 
			continue; 	
		}
		for(j = 0; j< feArry.length; j++)
		{
			if(feArry[j].attributes.getNamedItem("name").firstChild.data == frontEnds[i].attributes.getNamedItem("name").firstChild.data)
			{
				break; 	
			}
			if( j == (feArry.length - 1) && feArry[j].attributes.getNamedItem("name").firstChild.data != frontEnds[i].attributes.getNamedItem("name").firstChild.data)
			{
				feArry.push(frontEnds[i]); 
				fe = document.createElement("option"); 
				txt2[count] = frontEnds[i].attributes.getNamedItem("name").firstChild.data;
				feTxt = document.createTextNode(txt2[count]);
				fe.appendChild(feTxt);		
				select.appendChild(fe); 
				count++; 	
				break; 
			}
		}
	}
	
	listMade = 1;
	document.getElementById('tempList').appendChild(select);


}
function checkUrl()
{
	var url = window.location.search;
	var contents = new Array();
	var temp; 
	var pairsEqSplit = new Array();  
	if(url) 
	{
		url = url.substring(1); 
		var pairsAndSplit = url.split("&");
	 
	   // Load the key/values of the return collection
	 
	    for (var i = 0; i < pairsAndSplit.length; i++)
		{
        	pairsEqSplit[i] = pairsAndSplit[i].split("=");
   		}
		for(i = 0; i< pairsEqSplit.length; i++)
		{
			contents[i] = pairsEqSplit[i];
		}
		for(i = 0; i< contents.length; i++)
		{
			temp = contents[i]; 
			for(j = 0; j < temp.length; j++)
			{
				if(temp[j].search(/view/i) >= 0)
				{
					if(temp[j+1].search(/total/i) >= 0)
					{
						if(temp[j+1] == "total+active+troubleshoot")
						{
							active = 0; 
							selectActive(); 
							troubleshooting(); 
							document.getElementById("troubleshoot").checked = true; 
							document.getElementById("active").checked = true; 
						}
						else if(temp[j+1] == "total+active")
						{
							active = 0; 
							troubleshoot = 0; 
							periodV = 0; 
							selectActive(); 
							document.getElementById("active").checked = true;
						}
						else if(temp[j+1] == "total+period")
						{
							active = 0; 
							troubleshoot = 0; 
							period(); 
							document.getElementById("period").checked = true;
						}
						else if(temp[j+1] == "total+active+period")
						{
							active = 0; 
							troubleshoot = 0; 
							selectActive(); 
							period(); 
							document.getElementById("active").checked = true;
							document.getElementById("period").checked = true;
						}
						else if(temp[j+1] == "total+troubleshoot")
						{
							troubleshooting(); 
							document.getElementById("troubleshoot").checked = true; 
						}
						else
						{
							continue;
						}
					} 
					if(temp[j+1] == "Any")
					{
						loadFrontEnd("Any"); 
						troubleshoot = 0; 
						select.selectedIndex += 1   	
					}
					if(temp[j+1] == "Any+active")
					{
						loadFrontEnd("Any"); 
						select.selectedIndex += 1
						active = 0;
						troubleshoot = 0; 
						selectActive(); 
						document.getElementById("active").checked = true;    	
					}
					if(temp[j+1] == "Any+active+period")
					{
						loadFrontEnd("Any"); 
						select.selectedIndex += 1
						active = 0;
						troubleshoot = 0; 
						selectActive(); 
						period(); 
						document.getElementById("active").checked = true;  
						document.getElementById("period").checked = true; 
					}	
					if(temp[j+1] == "Any+active+troubleshoot")
					{
						loadFrontEnd("Any"); 
						select.selectedIndex += 1
						active = 0; 
						selectActive(); 
						troubleshooting(); 
						document.getElementById("active").checked = true; 
						document.getElementById("troubleshoot").checked = true; 
					}
					if(temp[j+1] == "Any+troubleshoot")
					{
						loadFrontEnd("Any"); 
						select.selectedIndex += 1
						troubleshooting(); 
						document.getElementById("troubleshoot").checked = true; 
					}
					else if(temp[j+1] == "Any+period")
					{
						loadFrontEnd("Any"); 
						select.selectedIndex += 1
						period();  
						document.getElementById("period").checked = true;
						return;  
					}
					else
					{
						for(z = 0; z < feArryMaster.length; z++)
						{
							if(temp[j+1] == feArryMaster[z].attributes.getNamedItem("name").firstChild.data)	
							{
								loadFrontEnd(temp[j+1]);
								select.selectedIndex = z + 2;
								troubleshoot = 0; 
							}
							else if(temp[j+1] == (feArryMaster[z].attributes.getNamedItem("name").firstChild.data + "+active+troubleshoot"))
							{	
								loadFrontEnd(feArryMaster[z].attributes.getNamedItem("name").firstChild.data);
								select.selectedIndex = z + 2;
								active = 0; 
								selectActive(); 
								troubleshooting(); 
								document.getElementById("active").checked = true;  
								document.getElementById("troubleshoot").checked = true;  
							}
							else if(temp[j+1] == (feArryMaster[z].attributes.getNamedItem("name").firstChild.data + "+active+period"))
							{
								loadFrontEnd(feArryMaster[z].attributes.getNamedItem("name").firstChild.data);
								select.selectedIndex = z + 2;
								active = 0; 
								period(); 
								selectActive(); 
								troubleshoot = 0; 
								document.getElementById("period").checked = true;  
								document.getElementById("active").checked = true;  
							}
							else if(temp[j+1] == (feArryMaster[z].attributes.getNamedItem("name").firstChild.data + "+active"))
							{
								loadFrontEnd(feArryMaster[z].attributes.getNamedItem("name").firstChild.data);
								select.selectedIndex = z + 2;
								active = 0; 
								selectActive(); 
								troubleshoot = 0; 
								document.getElementById("active").checked = true;  
							}
							else if(temp[j+1] == (feArryMaster[z].attributes.getNamedItem("name").firstChild.data + "+troubleshoot"))
							{
								loadFrontEnd(feArryMaster[z].attributes.getNamedItem("name").firstChild.data);
								select.selectedIndex = z + 2;
								troubleshooting(); 
								document.getElementById("troubleshoot").checked = true; 
							}
							else if(temp[j+1] == (feArryMaster[z].attributes.getNamedItem("name").firstChild.data + "+period"))
							{
								loadFrontEnd(feArryMaster[z].attributes.getNamedItem("name").firstChild.data);
								select.selectedIndex = z + 2;
								active = 0; 
								period(); 
								troubleshoot = 0; 
								document.getElementById("period").checked = true;  
							}
						}	
					}
					break; 			
				}
				if(temp[j].search(/sort/i) >= 0)
				{
					for(l = 0; l < columnArray.length; l++)
					{
						temp[j+1] = temp[j+1].toLowerCase(); 
						if(temp[j+1].search(columnSearch[l]) >= 0 || temp[j+1].search(columnArry[l]) >= 0)
						{
							if(periodV){period(); periodV = 1;} /* Reset table. */
							if(troubleshoot)
							{
								troubleshoot = 1; 
								troubleshooting();
								troubleshoot = 1;  
							}
							friend = periodV; periodV = 0; 
							sortTableDescending(columnArray[l]);
							periodV = friend; 
							if(troubleshoot)
							{
								troubleshoot = 0; 
								troubleshooting(); 
								trSortSignal(trSortCol);
							}
							if(periodV){periodV = 0; period(); fillInPeriod();} /* Put period table back. */
							return;   
						}
						else
						{
							if(troubleshoot)
							{				
								if(temp[j + 1] == "diff(status:running,client:registered)")
								{
									sortTrCol("Diff(Status: Running, Client: Registered)");
									trSortSignal(3); 
									return; 	
								}
								else if(temp[j + 1] == "diff(status:idle,requested:idle)")
								{
									sortTrCol("Diff(Status: Idle, Requested: Idle)");
									trSortSignal(6); 
									return; 	
								}
							}
						}
					}
				}
			}			
		}
	}
}

function loadFrontEnd(name)
{
	frontEndName = name; 
	preFrontEndName = name;
	currChild = 1; 

	/* If in period mode reset to def to load the front ends table. */
	if(periodV){period(); periodV = 1;}
	
	/* Remove tr table to reset all information. */ 
	if(troubleshoot)
	{
		if(diffSorted)
		{
			friend = diffSorted; 
			troubleshooting(); 
			diffSorted = friend; 
		}
		else
		{
			troubleshooting(); 
		}
		troubleshoot = 1; 
	}
	if(diffSorted)
	{
		diffSorted = 1; 	
	}
	
	/* If Total view! */
	if(name == "Total (Default)")
	{
		/* Reset everything. */
		childView = null;  
		preFrontEndName = "Total"; 
		totalEntries = totalEntriesMaster; 
		total = totalMaster;
		totalEntriesP = totalEntriesPMaster; 
		totalP = totalPMaster;
		numberRows = totalEntries.length;
 		makeTable(); 
		frontEnd = 0;
		
		if(sorted == 1 && currentSort == "ascending")
		{
			tableMade = 0;
			sorted = 0; 
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
			} 
			friend = periodV; 
			periodV = 0; 
			sortTableDescending(sortedColumn); 
			sortTableAscending(sortedColumn);
			periodV = friend; 
			if(troubleshoot)
			{
				troubleshoot = 0; 	
				troubleshooting(); 
			}
			/* Restore period table. */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return; 
		}
		else if(sorted == 1 && currentSort == "descending")
		{
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
			}
			tableMade = 0;
			sorted = 0;
			friend = periodV;
			periodV = 0; 
			sortTableDescending(sortedColumn); 
			periodV = friend; 
			if(troubleshoot)
			{
				troubleshoot = 0; 	
				troubleshooting(); 
			} 
			/* Restore period table. */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return; 
		}
		else
		{
			if(active) /* If in an active view! */
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
				
				/* Place the tr table back on the screen. s*/
				if(troubleshoot)
				{
					troubleshoot = 0;
					friend = diffSorted; 
					diffSorted = 0;  	
					troubleshooting(); 
					diffSorted = friend; 
				} 
				/* If a sort is specified. */
				if(diffSorted)
				{
					diffSorted--; 
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)");
					}
					else
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)");
					}
				}
			}
			else /* If no view specs. */
			{
				fillIn(); 
				if(troubleshoot) /* Restore the tr table if no sort spec. */
				{
					troubleshoot = 0;
					friend = diffSorted; 
					diffSorted = 0;  	
					troubleshooting(); 
					diffSorted = friend; 
				}
				/* If a sort is specified. */
				if(diffSorted)
				{
					diffSorted--; 
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)");
					}
					else
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)");
					}
				}
			}
		}
	}
	else /* If in a frontend or Any view! */
	{
   		nameLast = name; 
		feEntries = new Array();
		feTotal = new Array();
		feEntriesP = new Array();
		feTotalP = new Array();
		
		/* Reset everything before we find the frontends we are looking for. */
		totalEntries = totalEntriesMaster; 
		total = totalMaster; 
		totalEntriesP = totalEntriesPMaster; 
		totalP = totalPMaster; 
		tableMade = 0;   
		if(name == "Any")
		{
			childView = null; 
			for(i = 0; i< totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[feChild].childNodes.length > 1)
				{
					if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes.length > 0)
					{
						feEntries.push(totalEntries[i]); 
						feTotal.push(total[i]);
						feEntriesP.push(totalEntriesP[i]); 
						feTotalP.push(totalP[i]); 
					}
				}
			}			
		}	
		else
		{
			for(i = 0; i< totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[feChild].childNodes.length != 0)
				{
					for(j = 1; j< totalEntries[i].childNodes[feChild].childNodes.length; j+=2)
					{
						if(totalEntries[i].childNodes[feChild].childNodes[j].attributes.getNamedItem("name").firstChild.data == name)
						{	
							childView = j; 
							feEntries.push(totalEntries[i]); 
							feTotal.push(totalEntries[i].childNodes[feChild].childNodes[j]); 
							feEntriesP.push(totalEntriesP[i]);
							feTotalP.push(totalEntriesP[i].childNodes[3].childNodes[j]);
						}
					}
				}
			}			
		}
		frontEnd = 1;
		totalEntries = feEntries;
		totalEntriesP = feEntriesP;
		feTotal.push(1);
		total = feTotal;
		feTotalP.push(1);
		totalP = feTotalP;
		numberRows = totalEntries.length; 
		count = 0;
		
		if(sorted == 1 && currentSort == "ascending")
		{
			sorted = 0; 
			currentSort;
			makeTable();  
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
			}
			friend = periodV; 
			periodV = 0;
			sortTableDescending(sortedColumn); 
			sortTableAscending(sortedColumn);
			periodV = friend; 
			if(troubleshoot)
			{
				troubleshoot = 0; 	
				troubleshooting(); 
			}
			/* Restore period table. */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return;   	
		}
		else if(sorted == 1 && currentSort == "descending")
		{
			sorted = 0; 
			currentSort;
			makeTable();
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
			}
			friend = periodV; 
			periodV = 0; 
			sortTableDescending(sortedColumn); 
			periodV = friend; 
			if(troubleshoot)
			{	
				troubleshoot = 0; 	
				troubleshooting(); 
			} 			
			/* Restore period table. */
			if(periodV){periodV = 0; period();}
			sortSignal();
			return; 
		}
		else /* If no default table compatible sort. */
		{
			if(active)
			{
				
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 

				if(troubleshoot)
				{
					if(diffSorted)
					{
						friend = diffSorted; 
						troubleshoot = 0; 
						diffSorted = 0; 
						troubleshooting();
						diffSorted = friend; 
						diffSorted--; 
						if(diffColNum == 1)
						{
							sortTrCol("Diff(Status: Running, Client: Registered)"); 
						}
						else if(diffColNum == 2)
						{
							sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
						}						
					} 
					else /* If no sort! */
					{
						troubleshoot = 0;
						troubleshooting();	
					}
				} 
				if(periodV){periodV = 0; period(); }
				return; 	
			}
			fillIn();
		}
		if(troubleshoot) /* If not active but troubleshoot mode. */
		{
			if(diffSorted)
			{	
				friend = diffSorted;
				troubleshoot = 0; 
				diffSorted = 0; 
				troubleshooting();
				diffSorted = friend - 1; 
				
				if(diffColNum == 1)
				{
					sortTrCol("Diff(Status: Running, Client: Registered)"); 
				}
				else if(diffColNum == 2)
				{
					sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
				}
			}
			else
			{
				troubleshoot = 0; 	
				troubleshooting(); 
			}
		}
	}
	if(periodV){periodV = 0; period();}
}
function updateTable()
{ 
	updating = 1; 
	loadXML2(); 
}

function entryClick(entry)
{
	entryName = entry;
	entryName = entryName.childNodes[0].wholeText; 
	document.location.href = "http://glidein-1.t2.ucsd.edu:8319/glidefactory/monitor/glidein_Production_v3_1/factoryEntryStatusNow.html?view=" + entryName; 
}

function fillIn()
{
	problem = 0;
	linkCount = 0;
	currChild = 1; 
	 
	if(tableMade == 0)
	{
		makeTable();
	}
	if(listMade == 0)
	{
		makeList(); 	
	}
	
	document.getElementById("total").innerHTML= " &bull;" + "View has: " + numberRows + " Total Entries - (" + preFrontEndName + ")"; 
	var table = document.getElementById("table"); //Access to the entire table

	
	//Fill in entries 
	for( i = 0; i< numberRows; i++)
	{
		var y = totalEntries[i].attributes.getNamedItem("name").firstChild.data; 
		table.rows[i].cells[0].innerHTML = "";
		links[i] = document.createElement('a');
		links[i].setAttribute("id", "entryLinks"); 
		links[i].innerHTML = y; 
		links[i].setAttribute("href", "factoryEntryStatusNow.html?entry=" + y);
		links[i].setAttribute("onclick", "entryClick(this)");
		table.rows[i].cells[0].appendChild(links[i]); 
	}
		
	
	//fill in the for non running entries. 
	for(j = 1; j < 17 ; j++)
	{	
		for(i = 0; i< total.length -1; i++)
		{
			if(total[i].childNodes.length == 0)
			{
				//fill in everything except the first column with 0 if entry is not doing anything.
				table.rows[i].cells[j].innerHTML = "0";					
			}	
		}
	}
	
	/* 
	 * Fill in status fields.  
	 */
	var attArry = new Array(4,1,7,3,5,6,2,0); 
	attCount = 0;
	for(var counter = 1; counter<= 8; counter++)
	{
		for(var i = 0; i< totalEntries.length; i++)
		{
			if(total[i].childNodes.length >= 7 && total[i].childNodes.length != 0)
			{
				if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
				{
					var item = total[i].childNodes[feStatChild].attributes[attArry[attCount]].nodeValue;
				}
				else
					var item = total[i].childNodes[totStatChild].attributes[attArry[attCount]].nodeValue;
				table.rows[i].cells[counter].innerHTML = item; 
			}
			else
			{
				table.rows[i].cells[counter].innerHTML = 0; 
			}
		}	
		attCount++; 
 	}
	
	
	/*
	 * Fill in requested fields. 
	 */
	var attArry = new Array(1,0); 
	var attCount = 0; 
	for(var counter = 9; counter <= 10; counter++)
	{
		for(var i = 0; i< totalEntries.length; i++)
		{
			if(total[i].childNodes.length >= 5 && total[i].childNodes.length != 0)
			{
				if(frontEnd)
				{
					var item = total[i].childNodes[feReqChild].attributes[attArry[attCount]].nodeValue; 
				}
				else
					var item = total[i].childNodes[totReqChild].attributes[attArry[attCount]].nodeValue; 
				table.rows[i].cells[counter].innerHTML = item; 
			}
		}
		attCount++; 	
	}
	
	/* 
     * Fill in client monitor fields 
 	 */
	var attArry = new Array(1,5,0,4,2,3); 
	attCount = 0; 
	for(var counter = 11; counter <= 16; counter++)
	{
		for(i = 0; i< totalEntries.length; i++)
		{	
			if(total[i].childNodes.length >= 3 && total[i].childNodes.length != 0)
			{
				if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
				{
					item = total[i].childNodes[feCMChild].attributes[attArry[attCount]].nodeValue;
				}
				else
					item = total[i].childNodes[totCMChild].attributes[attArry[attCount]].nodeValue;
				table.rows[i].cells[counter].innerHTML = item; 
			}
		}
		attCount++; 
	}
}
function loadXML2()
{
	if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp=new XMLHttpRequest();
	}
	else
	{// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
		
	xmlhttp.onreadystatechange=function()
	{
		if(xmlhttp.readyState==4) //If 4 it it is ready. 
    	{
			totalEntriesPMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			totalPMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			frontEndsP = xmlhttp.responseXML.documentElement.getElementsByTagName("frontend"); 
			totalEntriesP = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			totalP = xmlhttp.responseXML.documentElement.getElementsByTagName("total"); 
			loadXMLDoc(); 
		}
	}
	xmlhttp.open("GET", "rrd_Status_Attributes.xml",true);
	xmlhttp.send(null);
}
function loadXMLDoc()
{	
	if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		xmlhttp=new XMLHttpRequest();
	}
	else
	{// code for IE6, IE5
		xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
	  
	//Wait for server to reply that it is ready.   
	xmlhttp.onreadystatechange=function()
	{	
	
		if(!active)
		{
			document.getElementById("active").checked = false; /* Reset active check box. */
		}
		if(!updating && !troubleshoot)
		{
			document.getElementById("troubleshoot").checked = false; /* Reset troubleshoot box. */
		}
		if(!periodV)
		{
			document.getElementById("period").checked = false; /* Reset active check box. */
		}
		
		if(xmlhttp.readyState==4) //If 4 it it is ready. 
    	{
			/* Reset period table. */
			if(periodV){ period(); periodV = 1;}
			updated = xmlhttp.responseXML.documentElement.getElementsByTagName("updated"); 
			showTime(); 
			totalEntriesMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			totalMaster = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			frontEnds = xmlhttp.responseXML.documentElement.getElementsByTagName("frontend"); 
			totalEntries = xmlhttp.responseXML.documentElement.getElementsByTagName("entry");
			total = xmlhttp.responseXML.documentElement.getElementsByTagName("total");     
			totalEntriesHold = totalEntries; 
			numberRows = totalEntries.length;
			totalHold = total;
			
			/*
			 * Find all the child nodes for everything.
			 */ 
			for(i = 0; i < totalEntries.length; i++)
			{
				for(m = 1; m < totalEntries[i].childNodes.length; m+=2)
				{
					if(totalEntries[i].childNodes[m].tagName == "total")
					{
						totChild = m; 
						continue; 
					}
					else if(totalEntries[i].childNodes[m].tagName == "frontends")
					{
						feChild = m;
						continue;  
					}
				}
				if(totChild && feChild)
				{
					break; 	
				}
			} 

			for(i = 0; i < totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[totChild].childNodes.length != 0)
				{
					for(k = 1; k < totalEntries[i].childNodes[totChild].childNodes.length; k+=2)
					{
						if(totalEntries[i].childNodes[totChild].childNodes[k].tagName == "Status")
						{
							totStatChild = k; 	
						}
						else if(totalEntries[i].childNodes[totChild].childNodes[k].tagName == "ClientMonitor")
						{
							totCMChild = k; 	
						}
						else if(totalEntries[i].childNodes[totChild].childNodes[k].tagName == "Requested")
						{
							totReqChild = k; 	
						}
					}
					break; 
				}	
			}
		 
			for(i = 0; i < totalEntries.length; i++)
			{
				if(totalEntries[i].childNodes[feChild].childNodes.length > 1)
				{
					for(k = 1; k < totalEntries[i].childNodes[feChild].childNodes[1].childNodes.length; k+=2)
					{
						if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes[k].tagName == "Status")
						{
							feStatChild = k; 	
						}
						else if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes[k].tagName == "ClientMonitor")
						{
							feCMChild = k; 	
						}
						else if(totalEntries[i].childNodes[feChild].childNodes[1].childNodes[k].tagName == "Requested")
						{
							feReqChild = k; 	
						}
					}
					break; 
				}	
			}
			if(updating == 1)
			{
				if(troubleshoot)
				{
					friend = diffSorted; 
					troubleshooting(); 
					troubleshoot = 1; 
					diffSorted = friend; 
				}
				/* Update table in default view, descending sort. (WORKS) */
				if(sorted != 0 && currentSort == 'descending' && frontEnd == 0)
				{ 
					currentSort;
					sorted = 0;
					updating = 0;
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						document.getElementById("active").checked = true; 
					} 
					else
					{
						makeTable();
					}
					tableMade = 0;  
					friend = periodV; periodV = 0; 
					sortTableDescending(sortedColumn);
					periodV = friend;  
					sortSignal();
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(periodV){periodV = 0; period();} /* Return to period view. */
					return; 
				}
				/* Update table in default view, ascending sort. (WORKS) */
				else if(sorted != 0 && currentSort == 'ascending' && frontEnd == 0)
				{
					currentSort;
					sorted = 0;
					updating = 0; 
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						document.getElementById("active").checked = true; 
					}
					else
					{
						makeTable();
					}
					tableMade = 0; 
					friend = periodV; periodV = 0; 
					sortTableDescending(sortedColumn);
					sortTableAscending(sortedColumn);
					periodV = friend; 
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(periodV){periodV = 0; period();} /* Return to period view. */
					return; 
				}
				/* (WORKS) */
				else if(sorted == 0 && frontEnd != 0)
				{
					frontEnd = 0;
					updating = 0;
					makeTable();
					friend = troubleshoot; troubleshoot = 0;
					friend2 = periodV; periodV = 0;
					friend3 = active; active = 0;   
					loadFrontEnd(preFrontEndName);
					periodV = friend2; 
					troubleshoot = friend; 
					active = friend3; 
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						document.getElementById("active").checked = true; 
					} 
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
						if(diffSorted)
						{
							diffSorted--; 
							if(diffColNum == 1)
							{
								sortTrCol("Diff(Status: Running, Client: Registered)"); 
							}
							else if(diffColNum == 2)
							{
								sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
							}
						}
					}
					if(periodV){periodV = 0; period();}
					return; 
				}
				/**/
				else if(sorted != 0 && currentSort == 'ascending' && frontEnd != 0)
				{
					currentSort;
					sorted = 0; 
					frontEnd = 0; 
					updating = 0;
					friend = troubleshoot; troubleshoot = 0; 
					friend2 = periodV; periodV = 0; 
					friend3 = active; active = 0; 
					loadFrontEnd(preFrontEndName);
					active = friend3; 
					periodV = friend2; 
					troubleshoot = friend;
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						document.getElementById("active").checked = true; 
					} 
					tableMade = 0; 
					friend = periodV; periodV = 0; 
					sortTableDescending(sortedColumn); 
					sortTableAscending(sortedColumn);
					periodV = friend; 
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(periodV){periodV = 0; period(); }
					return; 
				}
				else if(sorted != 0 && currentSort == 'descending' && frontEnd != 0)
				{
					currentSort;
					sorted = 0; 
					frontEnd = 0;
					updating = 0; 
					friend = troubleshoot; troubleshoot = 0; 
					friend2 = periodV; periodV = 0;
					friend3 = active; active = 0; 
					loadFrontEnd(preFrontEndName);
					periodV = friend2; 
					active = friend3; 
					troubleshoot = friend;
					if(active)
					{	
						active = 0; 
						friend = troubleshoot; troubleshoot = 0; 
						friend2 = periodV; periodV = 0; 
						selectActive(); 
						troubleshoot = friend; 
						periodV = friend2; 
						document.getElementById("active").checked = true; 
					}
					tableMade = 0; 
					friend = periodV; periodV = 0; 
					sortTableDescending(sortedColumn);
					periodV = friend; 
					sortSignal();
					if(troubleshoot)
					{
						troubleshoot = 0; 
						troubleshooting();
					}
					if(periodV){periodV = 0; period(); }
					return; 
				}
			}
			if(active)
			{	
				active = 0; 
				friend = troubleshoot; troubleshoot = 0; 
				friend2 = periodV; periodV = 0; 
				selectActive(); 
				troubleshoot = friend; 
				periodV = friend2; 
				document.getElementById("active").checked = true; 
			}
			preFrontEndName = "Total"; 
			tableMade = 0; 
    		frontEnd = 0; 
			sorted = 0;
			listMade = 0; 
			currentSort;
			document.getElementById("destination").selectedIndex = 0; 
			fillIn(); /* Fill in all the values. */
			if(troubleshoot)
			{
				troubleshoot = 0; 
				troubleshooting();
				document.getElementById("troubleshoot").checked = true; 
				if(diffSorted)
				{
					diffSorted--; 
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)"); 
					}
					else if(diffColNum == 2)
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
					}
				}
			}
			if(periodV){periodV = 0; period();}
			if(!updating){checkUrl();}
			updating = 0; 
		} 
			 
	}
	xmlhttp.open("GET", "schedd_status.xml",true);
	xmlhttp.send(null);
}
function makeTable() 
{
if(table)
{
	document.getElementById('scroll').removeChild(table);
	document.getElementById('header').removeChild(thead); 
}

var row=new Array();
var cell=new Array();
var cell2 = new Array();
row2 = document.createElement('tr'); 

var row_num=numberRows+1; //edit this value to suit
var cell_num=17; //edit this value to suit
var x = 0; 

thead = document.createElement('table');
thBody = document.createElement('tbody');
thead.setAttribute('id', 'thead');

table = document.createElement('table');
tBody=document.createElement('tbody');
table.setAttribute('id','table');

for(x = 0; x < 4; x++)
{
	if(x == 0)
	{
		cell2[x] = document.createElement('td');
		cell2[x].setAttribute('bgColor', '#DCDCDC');
		cell2[x].setAttribute('id', 'empty');
		cell2[x].setAttribute("colspan", "1");
		cell2[x].setAttribute("width", "23%");
	}
	if( x== 1)
	{
		cell2[x] = document.createElement('td');
		cell2[x].setAttribute("colspan", "8"); 
		cell2[x].setAttribute('bgColor', '#FAF0E6');
		td1Txt = document.createTextNode("Status: ");
		cell2[x].appendChild(td1Txt);
		cell2[x].setAttribute('id', 'requested'); 
	}
	if(x == 2)
	{
		cell2[x] = document.createElement('td');
		cell2[x].setAttribute("colspan", "2"); 
		cell2[x].setAttribute('bgColor', '#FFDAB9');
		td1Txt = document.createTextNode("Requested: ");
		cell2[x].appendChild(td1Txt);
		cell2[x].setAttribute('id', 'status'); 
	}
	if( x == 3)
	{
		cell2[x] = document.createElement('td');
		cell2[x].setAttribute("colspan", "6");
		cell2[x].setAttribute('bgColor', '#CDAF95'); 
		td3Txt = document.createTextNode("Client Monitor: "); 	
		cell2[x].appendChild(td3Txt);
		cell2[x].setAttribute('id', 'client');
	}

	row2.appendChild(cell2[x]); 
}
thBody.appendChild(row2); 


for(c = 0; c < row_num; c++)
{
	row[c] = document.createElement('tr');
	
	row[c].setAttribute('id', 'entries'); 
	if(c > 0)
	{
		row[c].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
		row[c].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 
	}
	for(k = 0; k < cell_num; k++) 
	{
		cell[k] = document.createElement('td');
	
		if(c > 0 && k> 0)
		{
			cell[k].setAttribute('onmouseover', 'showPopUp(this)');
			cell[k].setAttribute('onmouseout', 'hidePopUp()');
			cell[k].setAttribute('id', c);  				
		}
		if(c > 0 && k == 0)
		{
			cell[k].setAttribute('width', '23%');  				
		}
	
		if(c == 0 && k == 0)
		{
			cont = document.createTextNode("Entry Name")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'entryName'); 
	    	cell[k].setAttribute("onclick", "sortAlphabetical()");
			cell[k].setAttribute('bgColor', '#DCDCDC');  	 
		}
		if( c == 0 && k == 1)
		{
			cont = document.createTextNode("Running")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusRunning'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusRunning') "); 
			cell[k].setAttribute('bgColor', '#FAF0E6'); 	 
		}
		if( c == 0 && k == 2)
		{
			cont = document.createTextNode("Idle")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusIdle'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusIdle') "); 
			cell[k].setAttribute('bgColor', '#FAF0E6');
		}
		if( c == 0 && k == 3)
		{
			cont = document.createTextNode("Waiting")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusWait'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusWait') ");
			cell[k].setAttribute('bgColor', '#FAF0E6');
		}
		if( c == 0 && k == 4)
		{
			cont = document.createTextNode("Pending")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusPending'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusPending') ");
			cell[k].setAttribute('bgColor', '#FAF0E6'); 
		}
		if( c == 0 && k == 5)
		{
			cont = document.createTextNode("Staging in")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusStageIn'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusStageIn') ");
			cell[k].setAttribute('bgColor', '#FAF0E6'); 
		}
		if( c == 0 && k == 6)
		{ 
			cont = document.createTextNode("Staging out")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusStageOut'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusStageOut') ");
			cell[k].setAttribute('bgColor', '#FAF0E6');
		}
		if( c == 0 && k == 7)
		{ 
			cont = document.createTextNode("Unknown");
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusOther'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusOther') "); 
			cell[k].setAttribute('bgColor', '#FAF0E6');
		}
		if( c == 0 && k == 8)
		{
			cont = document.createTextNode("Held")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'statusHeld'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('statusHeld') ");
			cell[k].setAttribute('bgColor', '#FAF0E6'); 
		}
		if( c == 0 && k == 9)
		{
			cont = document.createTextNode("Max run")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'requestIdle');
		    cell[k].setAttribute("onclick", "sortTableDescending('requestMax') "); 
			cell[k].setAttribute('bgColor', '#FFDAB9'); 
		}
		if( c == 0 && k == 10)
		{
			cont = document.createTextNode("Idle")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'requestIdle'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('requestIdle') "); 
			cell[k].setAttribute('bgColor', '#FFDAB9'); 	 
		}
		if( c == 0 && k == 11)
		{
			cont = document.createTextNode("Claimed")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinRunning'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinRunning') ");
			cell[k].setAttribute('bgColor', '#CDAF95'); 
		}
		if( c == 0 && k == 12)
		{
			cont = document.createTextNode("User running")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinJobsRunning'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinJobsRunning')"); 
			cell[k].setAttribute('bgColor', '#CDAF95'); 
		}
		if( c == 0 && k == 13)
		{ 
			cont = document.createTextNode("Unmatched")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinIdle'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinIdle') ");
			cell[k].setAttribute('bgColor', '#CDAF95');
		}
		if( c == 0 && k == 14)
		{
			cont = document.createTextNode("User idle")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinJobsIdle'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinJobsIdle') ");
			cell[k].setAttribute('bgColor', '#CDAF95');
		}
		if( c == 0 && k == 15)
		{
			cont = document.createTextNode("Registered")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinTotal'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinTotal') "); 
			cell[k].setAttribute('bgColor', '#CDAF95');
		}
		if( c == 0 && k == 16)
		{
			cont = document.createTextNode("Info age")
			cell[k].appendChild(cont);
			cell[k].setAttribute('id', 'cmGlideinInfoAge'); 
		    cell[k].setAttribute("onclick", "sortTableDescending('cmGlideinInfoAge') ");
			cell[k].setAttribute('bgColor', '#CDAF95'); 
		}
		
		if( c > 0 )
		{
			cont = document.createTextNode(0+"")
			cell[k].appendChild(cont);
		}
		
		row[c].appendChild(cell[k]);
	}
	if(c == 0)
	{
		thBody.appendChild(row[c]); 
	}
	else
	{
		tBody.appendChild(row[c]);
	}
	tableMade = 1;
}

thead.appendChild(thBody); 
table.appendChild(tBody); 
document.getElementById('header').appendChild(thead); 
document.getElementById('scroll').appendChild(table);
document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 
} 

function setHeight()
{
	document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 
}

/* Change bg color of sorted columns. */
function sortSignal()
{
	/* Restore bg colors of table. */
	for(i = 0; i < 17; i++)
	{
		for(j = 0; j< totalEntries.length; j++)
		{
			if(i != (index + 1))
			{
				table.rows[j].cells[i].bgColor = "#F2F2F2";  
			}
		}
	}
    if(index == -2)
	{
	   return; 	
	}
	/* Color selected column. */
	for(i = 0; i< totalEntries.length; i++)
	{
		if(index + 1 >  0 && index + 1 < 9)
		{
			table.rows[i].cells[index + 1].bgColor =  "#FAF0E6";
		}
		else if(index + 1 == 9 || index + 1 == 10)
		{
			table.rows[i].cells[index + 1].bgColor =  "#FFDAB9";
		}
		else
			table.rows[i].cells[index + 1].bgColor =  "#CDAF95"; 
	}
	
	/* Color columns if period table is available. */
	if(periodV)
	{
		/* Restore bg colors of table. */
		for(i = 0; i < 16; i++)
		{
			for(j = 0; j < totalEntriesP.length * 4; j++)
			{
				if(i != index)
				{
					if(j % 4 == 0)
					{
						tableP.rows[j].cells[i + 2].bgColor = "#F2F2F2"; 
					}
					else
						tableP.rows[j].cells[i + 1].bgColor = "#F2F2F2";  
				}
			}
		}
		if(index == -2)
		{
		   return; 	
		}
		/* Color selected column. */
		for(i = 0; i< totalEntries.length * 4; i++)
		{
			if(index >= 0 && index < 8)
			{
				if(i % 4 == 0)
				{
					tableP.rows[i].cells[index + 2].bgColor = "#FAF0E6"; 
				}
				else
					tableP.rows[i].cells[index + 1].bgColor = "#FAF0E6";
			}
			else if(index == 8 || index == 9)
			{
				if(i % 4 == 0)
				{
					tableP.rows[i].cells[index + 2].bgColor = "#FFDAB9"; 
				}
				else
					tableP.rows[i].cells[index + 1].bgColor = "#FFDAB9";
			}
			else
			{
				if(i % 4 == 0)
				{
					tableP.rows[i].cells[index + 2].bgColor = "#CDAF95"; 
				}
				else
					tableP.rows[i].cells[index + 1].bgColor = "#CDAF95";
			}
		}	
	}
}

function sortTableAscending(column)
{
	total.splice(total.length - 1, 1)
	total.reverse(); 
	totalEntries.reverse(); 
	totalP.splice(totalP.length - 1, 1)
	totalP.reverse();  
	totalEntriesP.reverse(); 
	total.push(0); 
	totalP.push(0); 
	currentSort = "ascending"; 
	previousSort = column;
	sorted = 1;
	fillIn();
	if(periodV){fillInPeriod();}
}
function sortTableDescending(column)
{
	if(periodV){ column = columnArray[column.cellIndex - 2]; }
	
	sortedColumn = column; 
	lengthArry = new Array(7,7,7,7,7,7,7,7,5,5,3,3,3,3,3,3); 
	attArry = new Array(4,1,7,3,5,6,2,0,1,0,1,5,0,4,2,3);
	trSortColArry = new Array(1,4,0,0,0,0,0,0,0,5,0,0,0,7,2,0); 
	feChildArry = new Array(feStatChild, feReqChild, feCMChild); 
	totChildArry = new Array(totStatChild, totReqChild, totCMChild); 
 	
	if(previousSort != column)
	{
		sorted = 0; 
	}
	if(sorted == 1 && currentSort != "ascending")
	{
		sorted = 0; 
 		sortTableAscending(column); //replace sortTableDescending(column) 
   		return; 
	}

	newTotal = new Array(); 
	newEntries = new Array();
	newTotalP = new Array(); 
	newEntriesP = new Array();

	/* Appropriately set the information for the column being sorted. */
	for(i = 0; i < columnArray.length; i++)
	{
		if(column == columnArray[i])
		{
			length = lengthArry[i]; att = attArry[i]; index = i; trSortCol = trSortColArry[i]; sortSignal();
			if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			{
				if(i < 8){child = feChildArry[0];}else if(i < 10){child = feChildArry[1];}else{child = feChildArry[2];}
			}
			else
				if(i < 8){child = totChildArry[0];}else if(i < 10){child = totChildArry[1];}else{child = totChildArry[2];}
			break;  
		}
	}
	
	/* Get everything that is not 0 and exists. */
	for(var i = 0; i< totalEntries.length; i++)
	{
		if(total[i].childNodes.length != 0 && total[i].childNodes.length >= length)
		{
		   if(total[i].childNodes[child].attributes[att].nodeValue > 0)
		   {
			   newTotal.push(total[i]); 
			   newEntries.push(totalEntries[i]); 
			  
			   newTotalP.push(totalP[i]); 
			   newEntriesP.push(totalEntriesP[i]); 
		   }	
		}
	}

	/* Sort all all non zero elements. */	
	for(var i = 0; i< newTotal.length - 1; i++)    // element to be compared
	{
   		for(var j = i + 1; j < newTotal.length; j++)   // rest of the elements
   	 	{
			if(parseInt(newTotal[i].childNodes[child].attributes[att].nodeValue) <= parseInt(newTotal[j].childNodes[child].attributes[att].nodeValue))          
       		 {
       	    	temp = newTotal[i];              // swap
				newTotal[i] = newTotal[j];
        	    newTotal[j] = temp;
				temp = newEntries[i];            // swap
				newEntries[i] = newEntries[j];
    	       	newEntries[j] = temp;
				
				temp = newTotalP[i];              // swap
				newTotalP[i] = newTotalP[j];
        	    newTotalP[j] = temp;
				temp = newEntriesP[i];            // swap
				newEntriesP[i] = newEntriesP[j];
    	       	newEntriesP[j] = temp;
        	}
		}
	}

	/* Get entries that are 0. */
	for(var i = totalEntries.length - 1; i >= 0; i--)
	{	
		if(total[i].childNodes.length != 0 && total[i].childNodes.length >= length)
		{
			if(parseInt(total[i].childNodes[child].attributes[att].nodeValue) == 0)
			{
				newTotal.push(total[i]); 
				newEntries.push(totalEntries[i]); 
				
				newTotalP.push(totalP[i]); 
				newEntriesP.push(totalEntriesP[i]);
			}
		}
	}
	
	/* Empty entries. */
	for(var i = totalEntries.length -1; i >= 0; i--)
	{
		if(total[i].childNodes.length == 0 || total[i].childNodes.length < length)
		{		
			newTotal.push(total[i]); 
			newEntries.push(totalEntries[i]); 
			
			newTotalP.push(totalP[i]); 
			newEntriesP.push(totalEntriesP[i]); 		
		}
	}
	
	/* Make sure the whole column is not all 0's. */
	for(i = 0 ; i < newTotal.length; i++)
	{
		if(newTotal[i].childNodes.length != 0 && newTotal[i].childNodes.length >= length)
		{ 
			if(newTotal[i].childNodes[child].attributes[att].nodeValue != 0)
			{
				break;
			}
		}
		if(i == newTotal.length - 1)
		{
			return; 	
		}
	}

	currentSort = "descending";
	newTotal.push(1);
	newTotalP.push(1);
	previousSort = column; 
	total = newTotal; 
	totalEntries = newEntries;
	totalP = newTotalP; 
	totalEntriesP = newEntriesP;
	sorted = 1; 
	fillIn();
	if(periodV){fillInPeriod();}
}
function goToLink()
{
	var constructed;
	var holder = document.URL.split('?');
	
	/* If we are in a frontend view and there is some kind of sort going on. */
	if(frontEnd != 0 && (sorted != 0 || diffSorted))
	{
		/* If active and troubleshoot view specified. */
		if(active && troubleshoot && !periodV)
		{
			/* If in troubleshoot view difference columsn are being sorted. */
			if(diffSorted)
			{
				/* If first diff cols is being sorted. */
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot" + "&sort=diff(Status:Running,Client:Registered)";
				}
				else /* If second diff cols is being sorted. */
					constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot" + "&sort=diff(Status:Idle,Requested:Idle)";
			}
			else /* Else if normal column sort is going on. */
				constructed = holder[0] + "?view=" + preFrontEndName + "+active+troubleshoot" + "&sort=" + sortedColumn;
		}
		/* If active but not in troubleshoot mode. */
		else if(active && !troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "+active" + "&sort=" + sortedColumn;
		}
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "+active+period&sort=" + sortedColumn;// + "&sort=" + col;
		}
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "+period&sort=" + sortedColumn;//&sort=" + col;
		}
		/* If not active but in troubleshoot mode. */
		else if(!active && troubleshoot && !periodV)
		{
			/* If in troubleshoot view difference columsn are being sorted. */
			if(diffSorted)
			{
				/* If first diff cols is being sorted. */
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot" + "&sort=diff(Status:Running,Client:Registered)";
				}
				else /* If second diff cols is being sorted. */
					constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot" + "&sort=diff(Status:Idle,Requested:Idle)";
			}
			else /* Else if normal column sort is going on. */
				constructed = holder[0] + "?view=" + preFrontEndName + "+troubleshoot" + "&sort=" + sortedColumn;
		}
		else /* If neither. */
		{
			constructed = holder[0] + "?view=" + preFrontEndName + "&sort=" + sortedColumn;
		}
	}
	/* If no sort but in frontend mode. */
	else if(frontEnd != 0 && sorted == 0)
	{
		if(active && troubleshoot && !periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+active+troubleshoot";
		}
		else if(active && !troubleshoot && !periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+active";
		}
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+active+period";
		}
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+period";
		}
		else if(!active && troubleshoot && !periodV)
		{
			constructed = holder[0]+ "?view=" + preFrontEndName + "+troubleshoot";
		}
		else
		{
			constructed = holder[0]+ "?view=" + preFrontEndName;
		}
	}
	
	/* If no frontend mode but there is a sort. */
	else if(frontEnd == 0 && (sorted != 0 || diffSorted))
	{
		if(active && troubleshoot && !periodV)
		{
			/* If in troubleshoot view difference columsn are being sorted. */
			if(diffSorted)
			{
				/* If first diff cols is being sorted. */
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=total+active+troubleshoot&sort=diff(Status:Running,Client:Registered)";
				}
				else /* If second diff cols is being sorted. */
					constructed = holder[0] + "?view=total+active+troubleshoot&sort=diff(Status:Idle,Requested:Idle)";
			}
			else /* Else if normal column sort is going on. */
				constructed = holder[0] + "?view=total+active+troubleshoot&sort=" + sortedColumn;
		}
		else if(active && !troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=total+active&sort=" + sortedColumn;
		}
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+active+period&sort=" + sortedColumn;
		}
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+period&sort=" + sortedColumn;
		}
		else if(!active && troubleshoot && !periodV)
		{
			/* If in troubleshoot view difference columsn are being sorted. */
			if(diffSorted)
			{
				/* If first diff cols is being sorted. */
				if(diffColNum == 1)
				{
					constructed = holder[0] + "?view=total+troubleshoot&sort=diff(Status:Running,Client:Registered)";
				}
				else /* If second diff cols is being sorted. */
					constructed = holder[0] + "?view=total+troubleshoot&sort=diff(Status:Idle,Requested:Idle)";
			}
			else /* Else if normal column sort is going on. */
				constructed = holder[0] + "?view=total+troubleshoot&sort=" + sortedColumn;
		}
		else
		{
			constructed = holder[0] + "?sort=" + sortedColumn;
		}
	}
	else /* If no sort and no frontend view. s*/
	{
		if(active && troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=total+active+troubleshoot";
		}
		else if(!active && troubleshoot && !periodV)
		{
			constructed = holder[0] + "?view=total+troubleshoot";
		}
		else if(active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+active+period";
		}
		else if(!active && !troubleshoot && periodV)
		{
			constructed = holder[0] + "?view=total+period";
		}
		else
		{
			constructed = holder[0];
		}
	}
	document.location.href = constructed;
			
}

function selectActive()
{
	found = 0; activeEntries = new Array(); activeTotal = new Array(); activeEntriesP = new Array(); activeTotalP = new Array(); currChild = 0; 
	
	/* Remove the table. */
	if(troubleshoot)
	{
		if(diffSorted)
		{
			troubleshooting(); 
			troubleshoot = 1;
			diffSorted = 1; 
		}
		else
		{
			troubleshooting(); 
			troubleshoot = 1;
		}
	}
	
	if(active)
	{
		if(frontEnd)
		{
			/* Reset to def table. */
			if(periodV){period(); periodV = 1; }
			
			totalEntries = feEntries;
			totalEntriesP = feEntriesP;
			total = feTotal;
			totalP = feTotalP;
			tableMade = 0; 
			numberRows = totalEntries.length;		
			fillIn(); 
			active = 0; 
			if(sorted != 0 && currentSort == 'descending')
			{
				currentSort;
				sorted = 0; 
				tableMade = 0; 
				friend = periodV; periodV = 0; 
				sortTableDescending(sortedColumn);
				sortSignal();	
				periodV = friend; 
			}
			else if(sorted != 0 && currentSort == 'ascending')
			{
				currentSort;
				sorted = 0;
				tableMade = 0; 
				friend = periodV; periodV = 0; 
				sortTableDescending(sortedColumn);
				sortTableAscending(sortedColumn);
				periodV = friend; 
			}
			if(troubleshoot)
			{ 
			    /* First make the tr table. */
				tempTotalEntries = totalEntries; 
				troubleshoot = 0; 
				troubleshooting();
				
				/* If a sort is necessary. */
				if(diffSorted)
				{
					diffSorted--; 	
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)"); 
					}
					else if(diffColNum == 2)
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
					}
				}		
			}
			/* Reset to def table. */
			if(periodV){periodV = 0; period(); }
			return;	
		}
		else
		{
			/* Reset everything back to total. */
			totalEntries = totalEntriesMaster;
			totalEntriesP = totalEntriesPMaster;
			total = totalMaster;
			totalP = totalPMaster;
			tableMade = 0; 
			numberRows = totalEntries.length;
			
			/* Reset to def table. */
			if(periodV){period(); periodV = 1;}
					
			fillIn(); 
			active = 0;
			if(sorted != 0 && currentSort == 'descending')
			{
				currentSort;
				sorted = 0; 
				tableMade = 0; 
				friend = periodV; periodV = 0; 
				sortTableDescending(sortedColumn);
				sortSignal();
				periodV = friend; 
				if(troubleshoot == 1) /* Restore table if needed. */
				{
					troubleshoot = 0; 
					troubleshooting(); 	
				}
				if(periodV){periodV = 0; period();} 
				return; 
			}
			if(sorted != 0 && currentSort == 'ascending')
			{
				currentSort;
				sorted = 0;
				tableMade = 0;  
				friend = periodV; periodV = 0; 
				sortTableDescending(sortedColumn);
				sortTableAscending(sortedColumn);
				periodV = friend; 
				if(troubleshoot == 1) /* Restore table if needed. */
				{
					troubleshoot = 0; 
					troubleshooting(); 	
				} 
				if(periodV){periodV = 0; period(); 	} 
				return; 
			} 
			if(troubleshoot)
			{ 
			    /* First make the tr table. */
				tempTotalEntries = totalEntries; 
				troubleshoot = 0; 
				troubleshooting();
				
				/* If a sort is necessary. */
				if(diffSorted)
				{
					diffSorted--; 	
					if(diffColNum == 1)
					{
						sortTrCol("Diff(Status: Running, Client: Registered)"); 
					}
					else if(diffColNum == 2)
					{
						sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
					}
				}		
			}
			
			/*If originally in period view return back to period view. */
			if(periodV)
			{
				periodV = 0; 
				period(); 	
			}
			return;
		}
	}
	
	for(i = 0; i < totalEntries.length; i++)
	{
		found = 0; 
		if(total[i].childNodes.length != 0)
		{
			if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			{
				currChild = feCMChild; 
			}
			else
				currChild = totCMChild; 
			for(j = 0; j < total[i].childNodes[currChild].attributes.length; j++)
			{
				if(j == 3)
				{
					continue; 	
				}
				if(parseInt(total[i].childNodes[currChild].attributes[j].value) != 0)
				{
					activeEntries.push(totalEntries[i]);
					activeTotal.push(total[i]);
					activeEntriesP.push(totalEntriesP[i]);
					activeTotalP.push(totalP[i]);
					found = 1; 
					break;
				}
			}	
			if(found)
			{
				continue; 	
			}
			if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			{
				currChild = feReqChild; 
			}
			else
				currChild = totReqChild;
			for(k = 0; k < total[i].childNodes[currChild].attributes.length; k++)
			{
				if(k == 1)
				{
					continue; 	
				}
				if(parseInt(total[i].childNodes[currChild].attributes[k].value) != 0)
				{
					activeEntries.push(totalEntries[i]);
					activeTotal.push(total[i]);
					activeEntriesP.push(totalEntriesP[i]);
					activeTotalP.push(totalP[i]);
					found = 1; 
					break;
				}
			}
			if(found)
			{
				continue; 	
			}
			if(total[i].childNodes.length != 7)
			{
				continue; 	
			}
			if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
			{
				currChild = feStatChild; 
			}
			else
				currChild = totStatChild;
			for(l = 0; l < total[i].childNodes[currChild].attributes.length; l++)
			{
				if(parseInt(total[i].childNodes[currChild].attributes[l].value) != 0)
				{
					activeEntries.push(totalEntries[i]);
					activeTotal.push(total[i]);
					activeEntriesP.push(totalEntriesP[i]);
					activeTotalP.push(totalP[i]);
					break;
				}
			}
		}
	}
	
	active = 1;
	activeTotal.push(1);
	activeTotalP.push(1);
	total = activeTotal; 
	totalEntries = activeEntries;
	totalP = activeTotalP; 
	totalEntriesP = activeEntriesP;
	numberRows = totalEntries.length;	
	
	/* Take period table off so total table can be updated. */
	if(periodV){period(); periodV = 1; 	}
	
	tableMade = 0; 
	fillIn(); 
	
	if(sorted != 0 && currentSort == 'descending')
	{
		currentSort;
		sorted = 0; 
		tableMade = 0; 
		friend = periodV; periodV = 0; 
		sortTableDescending(sortedColumn);
		periodV = friend; 
		sortSignal();
					
	}
	else if(sorted != 0 && currentSort == 'ascending')
	{
		currentSort;
		sorted = 0;
		tableMade = 0; 
		friend = periodV; periodV = 0; 
		sortTableDescending(sortedColumn);
		sortTableAscending(sortedColumn);
		periodV = friend; 
	}
	if(troubleshoot)
	{ 
    	/* First make the tr table. */
		troubleshoot = 0; 
		troubleshooting();
		
		/* If a sort is necessary. */
		if(diffSorted)
		{
			diffSorted--; 	
			if(diffColNum == 1)
			{
				sortTrCol("Diff(Status: Running, Client: Registered)"); 
			}
			else if(diffColNum == 2)
			{
				sortTrCol("Diff(Status: Idle, Requested: Idle)"); 
			}
		}		
	}
	/* 
	 * If originally in period view reset period indicator and create the period table.
	 */
	if(periodV)
	{
		periodV = 0;   
		period(); 	
	}
}
function goToDestination(option)
{
	document.location.href = option.value; 
	document.getElementById("destination").selectedIndex = 0;
}
function troubleshooting()
{	
	if(periodV){return;}
	currChild = 1; 
	hrefs = new Array(); 
	if(troubleshoot == 0)
	{
		document.getElementById("period").style.visibility = "Hidden";
		if(!diffSorted && sorted && sortedColumn != "statusRunning" && sortedColumn != "cmGlideinTotal" && sortedColumn != "statusIdle" && sortedColumn != "requestIdle" && 
		sortedColumn != "cmGlideinJobsIdle")
		{
			tempTotalEntries = totalEntriesMaster; 
		}
		else if(!diffSorted)
		{
			tempTotalEntries = totalEntries; 
		}
		
		troubleshoot = 1; 
		document.getElementById("scroll").removeChild(table); 
		document.getElementById('header').removeChild(thead);
		columnText = new Array("Entry Name", "Status: Running", "Client: Registered", "Diff(Status: Running, Client: Registered)", "Status: Idle", "Requested: Idle", 
		"Diff(Status: Idle, Requested: Idle)", "Client: User Idle"); 
		columnId = new Array("entryLinks", "status", "client","difference", "status", "requested", "difference","client"); 
		colors = new Array("#DCDCDC","#FAF0E6", "#CDAF95", "#7D9EC0","#FAF0E6", "#FFDAB9","#7D9EC0", "#CDAF95"); 
		if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
		{
			child = new Array(feStatChild, feCMChild, feStatChild, feReqChild, feCMChild); 
		}	 
		else	 
			child = new Array(totStatChild, totCMChild, totStatChild, totReqChild, totCMChild); 
		count = 0; 
		att = new Array(4, 2, 1, 0, 4); 
		rows = new Array(); 
		cols = new Array();
		trTable = document.createElement('table'); 
		trTable.setAttribute('id', 'trTable'); 
		trHeader = document.createElement('table'); 
		trHeader.setAttribute('id', 'trHeader'); 
		
		for(i = 0; i < tempTotalEntries.length + 1; i++) //rows
		{
			if(childView && i > 0)
			{
				for(n = 1; n < tempTotalEntries[i - 1].childNodes[feChild].childNodes.length; n+=2)
				{
					if(tempTotalEntries[i - 1].childNodes[feChild].childNodes[n].attributes[0].value == frontEndName)
					{
						childView = n; 
						break; 	
					}
				}
			}
			count = 0; 
			rows[i] = document.createElement('tr');
			rows[i].setAttribute('id', 'entries'); 
			if(i != 0)
			{
				rows[i].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
				rows[i].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 
			}
			for(j = 0; j < 8; j++) //cols
			{
				cols[j] = document.createElement('td'); 
				if(i > 0 && j > 0)
				{
					cols[j].setAttribute('onmouseover', 'showPopUp(this)');
					cols[j].setAttribute('onmouseout', 'hidePopUp()');
					cols[j].setAttribute('id', i); 
				}
				if(i == 0)
				{
					cols[j].appendChild(document.createTextNode(columnText[j]));
					cols[j].setAttribute('id', columnId[j]); 
					cols[j].setAttribute('bgColor', colors[j]);
					if(j == 0)
					{
						cols[j].setAttribute('onclick', 'sortAlphabetical()'); 
					}
					if(j > 0)
					{ 
						cols[j].setAttribute('onclick', 'sortTrCol(this)'); 
					}
				}
				else
				{
					if(j == 0)
					{						
						y = tempTotalEntries[i - 1].attributes.getNamedItem("name").firstChild.data; 
						hrefs[i - 1] = document.createElement('a');
						hrefs[i - 1].setAttribute("id", "entryLinks"); 
						hrefs[i - 1].innerHTML = y; 
						hrefs[i - 1].setAttribute("href", "factoryEntryStatusNow.html?entry=" + y);
						hrefs[i - 1].setAttribute("onclick", "entryClick(this)");
						cols[j].appendChild(hrefs[i - 1]); 
					}
					else
					{
						var val1; 
						var val2; 
						var one = 1;
						var two = 1;  
						if(j == 3 || j == 6)
						{
							if(!childView)
							{
								if((tempTotalEntries[i - 1].childNodes[totChild].childNodes.length < 7 && child[count - 2] == totStatChild) || 
								tempTotalEntries[i - 1].childNodes[totChild].childNodes.length == 0)
								{
									val1 = 0;
									one = 0;  
								}
								if((tempTotalEntries[i - 1].childNodes[totChild].childNodes.length < 7 && child[count - 1] == totStatChild) || 
								tempTotalEntries[i - 1].childNodes[totChild].childNodes.length == 0)
								{
									val2 = 0;
									two = 0;   
								}
							}
							else
							{
								if((tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length < 7 && child[count - 2] == feStatChild) || 
								tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length == 0)
								{
									val1 = 0;
									one = 0;  
								}
								if((tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length < 7 && child[count - 1] == feStatChild) || 
								tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length == 0)
								{
									val2 = 0;
									two = 0;   
								}
								
							}
							if(one && two)
							{
								if(!childView)
								{
									val1 = parseInt(tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count - 2]].attributes[att[count - 2]].value); 
									val2 = parseInt(tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count - 1]].attributes[att[count - 1]].value);
								}
								else
								{
									val1 = parseInt(tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count - 2]].attributes[att[count - 2
									]].
									value); 
									val2 = parseInt(tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count - 1]].attributes[att[count - 1
									]].
									value);	
								}
							}
							else if(one && !two)
							{
								if(!childView)
								{
									val1 = parseInt(tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count - 2]].attributes[att[count - 2]].value);
								}
								else
								{
									val1 = parseInt(tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count - 2]].attributes[att[count - 2
									]].
									value);
								}
							}
							else if(!one && two)
							{
								if(!childView)
								{
									val2 = parseInt(tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count - 1]].attributes[att[count - 1]].value);
								}
								else
								{
									val2 = parseInt(tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count - 1]].attributes[att[count - 1
									]].
									value);
								}
							}
							diff = val1 - val2; 
							if(val1 == 0 && val2 == 0)
							{
								cols[j].appendChild(document.createTextNode("0"));
							}
							else
							{
								cols[j].appendChild(document.createTextNode(diff));
							}
						}
						else
						{
							if(!childView)
							{
								if((tempTotalEntries[i - 1].childNodes[totChild].childNodes.length < 7 && child[count] == totStatChild) || tempTotalEntries[i - 1].
								childNodes[totChild].childNodes.length == 0)	
								{
									cols[j].appendChild(document.createTextNode("0"));
								}
								else
								{
									val = tempTotalEntries[i - 1].childNodes[totChild].childNodes[child[count]].attributes[att[count]].value; 
									cols[j].appendChild(document.createTextNode(val));
								}	
							}
							else
							{
								if((tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length < 7 && child[count] == feStatChild) || 
								tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes.length == 0)	
								{
									cols[j].appendChild(document.createTextNode("0"));
								}
								else
								{
									val = tempTotalEntries[i - 1].childNodes[feChild].childNodes[childView].childNodes[child[count]].attributes[att[count]].value; 
									cols[j].appendChild(document.createTextNode(val));
								}	
							}
							count++; 
						}
					}
				}
				if(j == 0)
				{
					cols[j].setAttribute('width', '25%'); 	
				}
				rows[i].appendChild(cols[j]); 
			}
			if(i == 0)
			{
				trHeader.appendChild(rows[i]); 	
			}
			else
			{
				trTable.appendChild(rows[i]); 
			}	
		}
		
		document.getElementById("scroll").appendChild(trTable); 
		document.getElementById('header').appendChild(trHeader);
		if(sorted && (sortedColumn == "statusRunning" || sortedColumn == "cmGlideinTotal" || sortedColumn == "statusIdle" || sortedColumn == "requestIdle" || sortedColumn == "cmGlideinJobsIdle"))
		{
			trSortSignal(trSortCol); 	
		}
	}
	else
	{
		/* Reset everything. */
		document.getElementById("period").style.visibility = "Visible";
		troubleshoot = 0; 
		diffSorted = 0; 
		trSortAsc = 0; 
		document.getElementById("scroll").removeChild(trTable); 
		document.getElementById('header').removeChild(trHeader);
		document.getElementById("scroll").appendChild(table); 
		document.getElementById('header').appendChild(thead);
		if(!diffSorted && sorted && sortedColumn != "statusRunning" && sortedColumn != "cmGlideinTotal" && sortedColumn != "statusIdle" && sortedColumn != "requestIdle" && sortedColumn != "cmGlideinJobsIdle")
		{
			sortAlphabetical();
		}
	}
}
function sortTrCol(col)
{
	diffArry = new Array;
	exists = 0;  
	if(diffSorted)
	{
		friend = diffSorted; 
		troubleshoot = 1; 
		troubleshooting();
		diffSorted = friend; 
	}
	else
	{
		troubleshoot = 1; 
		troubleshooting();	
	}

	if(col.innerHTML)
	{
		col = col.innerHTML;
	}
	
	entryLog = new Array(); 
	tempTotal = new Array(); 
	colMaster = new Array("Status: Running", "Client: Registered", "diff", "Status: Idle", "Requested: Idle", "diff", "Client: User Idle");
	sortCol = new Array("statusRunning", "cmGlideinTotal", "diff", "statusIdle", "requestIdle", "diff", "cmGlideinJobsIdle"); 
	diffCol = new Array("Diff(Status: Running, Client: Registered)", "Diff(Status: Idle, Requested: Idle)");
	diffCell = new Array(3, 6);
	if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
	{
		child = new Array(feStatChild, feCMChild, feStatChild, feReqChild); 
	} 
	else	 
		child = new Array(totStatChild, totCMChild, totStatChild, totReqChild); 
	att = new Array(4, 2, 1, 0); 
	cellSort = 0; 

	for(i = 0; i < colMaster.length; i++)
	{
		if(col == colMaster[i])
		{
			friend = i; 
			sortTableDescending(sortCol[i]);
 			diffSorted = 0;
			troubleshooting(); 
			i = friend; 
			trSortSignal(i + 1); 
		}
		else
		{
			for(j = 0; j < diffCol.length; j++)
			{
				if(col == diffCol[j])
				{
					cellSort = diffCell[j];
					if(diffColNum != (j + 1))
					{			
						diffSorted = 0; 
						diffColNum = (j + 1); 	
					}
					if(!diffSorted)
					{
						tempTotalEntries = new Array(); 
					}
					for(k = 0; k < trTable.rows.length; k++)
					{
						diffArry.push(parseInt(trTable.rows[k].cells[diffCell[j]].innerHTML));
					}
					diffArry.sort(sortNumber);
					if(diffSorted != 1 && diffSorted != 2)
					{
						diffSorted = 1; 	
					}
					else if(diffSorted == 1)
					{
						tempTotalEntries.reverse();
						troubleshoot = 0; 
						troubleshooting();
						sorted = 0; 
						trSortSignal(cellSort);
						diffSorted = 2; 
						return; 
					}
					else if(diffSorted == 2)
					{
						tempTotalEntries.reverse(); 
						troubleshoot = 0; 
						troubleshooting(); 
						sorted = 0; 
						trSortSignal(cellSort);
						diffSorted = 1;
						return;  
					} 
					diffColNum = (j + 1); 
	
					for(l = 0; l < diffArry.length; l++)
					{
						/* Now sort the actual entries. */
						for(k = 0; k < totalEntries.length; k++)
						{
							if(childView)
							{
								for(n = 1; n < totalEntries[k].childNodes[feChild].childNodes.length; n+=2)
								{
									if(totalEntries[k].childNodes[feChild].childNodes[n].attributes[0].value == frontEndName)
									{
										childView = n; 
										break; 	
									}
								}
							}
							if(childView)
							{ 
								val1 = 0; 
								val2 = 0; 
								helper = j; 
								if(helper == 1)
								{
									helper++; 	
								} 
								try
								{
									val1 = parseInt(totalEntries[k].childNodes[feChild].childNodes[childView].childNodes[child[helper]].attributes[att[helper]].value); 
								}
								catch(err){}
								try
								{
									val2 = 	parseInt(totalEntries[k].childNodes[feChild].childNodes[childView].childNodes[child[helper + 1]].attributes[att[helper + 1]].
									value); 
								}
								catch(err){}
								diff =  val1 - val2; 
								if(val1 == 0 && val2 == 0)
								{
									diff = 0; 	
								}
								if(diff == diffArry[l])
								{
									for(p = 0; p < entryLog.length; p++)
									{
										if(k == entryLog[p])
										{
											exists = 1; 
											break; 	
										}	
									}
									if(exists == 1)
									{
										exists = 0; 
										continue; 	
									}
									entryLog.push(k);
									tempTotalEntries.push(totalEntries[k]);
									tempTotal.push(total[k]);
									break;  
								}	
							}	
							else	
							{
								val1 = 0; 
								val2 = 0;
								helper = j; 
								if(helper == 1)
								{
									helper++; 	
								} 
								try
								{
									val1 = parseInt(totalEntries[k].childNodes[totChild].childNodes[child[helper]].attributes[att[helper]].value); 
								}
								catch(err){}
								try
								{
									val2 = 	parseInt(totalEntries[k].childNodes[totChild].childNodes[child[helper + 1]].attributes[att[helper + 1]].value); 
								}
								catch(err){}
								diff =  val1 - val2;
								if(val1 == 0 && val2 == 0)
								{
									diff = 0; 	
								}
								if(diff == diffArry[l])
								{
									for(p = 0; p < entryLog.length; p++)
									{
										if(k == entryLog[p])
										{
											exists = 1; 
											break; 	
										}	
									}
									if(exists == 1)
									{
										exists = 0; 
										continue; 	
									}
									entryLog.push(k);
									tempTotalEntries.push(totalEntries[k]);
									tempTotal.push(total[k]);
									break;  
								}
							}
						}
					}
					tempTotal.push(1); 
					troubleshoot = 0; 
					troubleshooting();
					sorted = 0; 
					trSortSignal(cellSort);
					return;  
				}
			}
		}
	}
}
function sortNumber(a, b)
{
	return b - a; 
}
function trSortSignal(col)
{
	if(col > 7)
	{
		return; 
	}
	 
	for(i = 0; i < 8; i++)
	{
		for(j = 0; j < trTable.rows.length; j++)
		{
			if(i == col)
			{
				if(i == 1 || i == 4)
				{
					trTable.rows[j].cells[i].bgColor = "#FAF0E6";
				}
				else if(i == 2 || i == 7)
				{
					trTable.rows[j].cells[i].bgColor = "#CDAF95";
				}
				else if(i == 3 || i == 6)
				{
					trTable.rows[j].cells[i].bgColor = "#7D9EC0";
				}
				else if(i == 5)
				{
					trTable.rows[j].cells[i].bgColor = "#FFDAB9";
				}
			}
			else
			{
				trTable.rows[j].cells[i].bgColor = "#F2F2F2";
			}
		}
	}
}
function period()
{
	if(table && !periodV)
	{
		if(troubleshoot){return;}
		document.getElementById('scroll').removeChild(table);
		document.getElementById('header').removeChild(thead); 
		document.getElementById('troubleshoot').style.visibility = "Hidden";
	}
	else
	{
		document.getElementById('scroll').removeChild(tableP);
		document.getElementById('header').removeChild(theadP);
		document.getElementById('scroll').appendChild(table);
		document.getElementById('header').appendChild(thead);
		document.getElementById('troubleshoot').style.visibility = "Visible";
		periodV = 0;
		/* If sorted just re fill in table. */
		if(sorted){fillIn();}
		return;  
	}
	periodV = 1; 
							
	row=new Array();
	cell=new Array();
	cell2 = new Array();
	row2 = document.createElement('tr'); 

	row_num = totalEntriesP.length; //edit this value to suit	
	cell_num = 18; //edit this value to suit
	x = 0;

	theadP = document.createElement('table');
	thBodyP = document.createElement('tbody');
	theadP.setAttribute('id', 'thead');

	tableP = document.createElement('table');	
	tBodyP =document.createElement('tbody');
	tableP.setAttribute('id','table');
	colorArry = new Array("#FAF0E6", "#FFDAB9", "#CDAF95"); 

	for(x = 0; x < 5; x++)
	{
		if(x == 0)
		{
			cell2[x] = document.createElement('td');
			cell2[x].setAttribute('bgColor', '#DCDCDC');
			cell2[x].setAttribute('id', 'periodH');
			cell2[x].setAttribute("colspan", "1");
			td1Txt = document.createTextNode("");
			cell2[x].appendChild(td1Txt);
			cell2[x].setAttribute("width", "23%");
		}
		if(x == 1)
		{
			cell2[x] = document.createElement('td');
			cell2[x].setAttribute("colspan", ""); 
			cell2[x].setAttribute('bgColor', '#FFFAF0');
			td1Txt = document.createTextNode("Period:");
			cell2[x].appendChild(td1Txt);
			cell2[x].setAttribute('id', 'periodH');
		}
		if(x == 2)
		{
			cell2[x] = document.createElement('td');
			cell2[x].setAttribute("colspan", "8"); 
			cell2[x].setAttribute('bgColor', '#FAF0E6');
			td1Txt = document.createTextNode("Status:");
			cell2[x].appendChild(td1Txt);
			cell2[x].setAttribute('id', 'periodH'); 
		}
		if(x == 3)
		{
			cell2[x] = document.createElement('td');
			cell2[x].setAttribute("colspan", "2"); 
			cell2[x].setAttribute('bgColor', '#FFDAB9');
			td1Txt = document.createTextNode("Requested:");
			cell2[x].appendChild(td1Txt);
			cell2[x].setAttribute('id', 'periodH'); 
		}
		if( x == 4)
		{
			cell2[x] = document.createElement('td');
			cell2[x].setAttribute("colspan", "6");
			cell2[x].setAttribute('bgColor', '#CDAF95'); 
			td3Txt = document.createTextNode("Client Monitor:"); 	
			cell2[x].appendChild(td3Txt);
			cell2[x].setAttribute('id', 'periodH');
		}
		row2.appendChild(cell2[x]); 
	}
	
	thBodyP.appendChild(row2); 
	friend = cell_num; 

	for(c = 0; c < row_num * 4 + 1; c++)
	{
		row[c] = document.createElement('tr');	
		row[c].setAttribute('id', 'entries'); 
		if(c > 0)
		{
			row[c].setAttribute('onmouseover', "this.bgColor='#FFFF66'");
			row[c].setAttribute('onmouseout', "this.bgColor='#F2F2F2'"); 
		}
		for(k = 0; k < friend; k++) 
		{
			friend = cell_num; 
			cell[k] = document.createElement('td');
			if((c + 3) % 4 == 0 && k == 0)
			{
				cell[k].setAttribute("bgColor", "#F2F2F2"); 	
			}
			if((c + 3) % 4 != 0 && c != 0)
			{
				friend--;  
			}
			
			if(((c + 3) % 4 == 0) && k == 0)
			{
				cell[k].setAttribute('rowspan', '4'); 	
			}
	
			/* For the part of the table that contains integer values. */
			if(c > 0 && k > 1)
			{
				if((c - 1) % 4 == 0)
				{
					cell[k].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cell[k].setAttribute('id', c); 
					cell[k].setAttribute('onmouseout', 'hidePopUp()');
				}
				else
				{
					cell[k].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cell[k].setAttribute('id', c); 
					cell[k].setAttribute('onmouseout', 'hidePopUp()');
					cell[k - 1].setAttribute('onmouseover', 'showPopUpPeriod(this)');
					cell[k - 1].setAttribute('id', c);  				
					cell[k - 1].setAttribute('onmouseout', 'hidePopUp()');
				}
			}
			
			/* Set the width entry name cells to 23% to fit longer names. */
			if(c > 0 && k == 0)
			{
				cell[k].setAttribute('width', '23%');  				
			}
		
			if(c == 0 && k == 0)
			{
				cont = document.createTextNode("Entry Name")
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', 'entryName'); 
	    		cell[k].setAttribute("onclick", "sortAlphabetical()");
				cell[k].setAttribute('bgColor', '#DCDCDC');  	 
			}
			if(c == 0 && k == 1)
			{
				cont = document.createTextNode("Name")
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', ''); 
			    cell[k].setAttribute("onclick", ""); 
				cell[k].setAttribute('bgColor', '#FFFAF0'); 	 
			}
			if(c == 0 && k >= 2)
			{
				cont = document.createTextNode(headColArry[k - 2])
				cell[k].appendChild(cont);
				cell[k].setAttribute('id', 'k'); 
			    cell[k].setAttribute("onclick", "sortTableDescending(this)"); 
				if(k < 10)
				{
					cell[k].setAttribute('bgColor', colorArry[0]); 
				}
				else if(k < 12)
				{
					cell[k].setAttribute('bgColor', colorArry[1]); 
				}
				else
					cell[k].setAttribute('bgColor', colorArry[2]); 
			}
			if(c > 0)
			{
				cont = document.createTextNode(0 + "")
				cell[k].appendChild(cont);
			}
			
			row[c].appendChild(cell[k]);
		}
		if(c == 0)
		{
			thBodyP.appendChild(row[c]); 
		}
		else
		{
			tBodyP.appendChild(row[c]);
		}
		tableMade = 1;
	}

	theadP.appendChild(thBodyP); 
	tableP.appendChild(tBodyP); 
	document.getElementById('header').appendChild(theadP); 
	document.getElementById('scroll').appendChild(tableP);
	document.getElementById('scroll').style.height = (window.innerHeight - 74) + "px"; 	
	fillInPeriod();
	if(sorted){sortSignal();} /* Color the sorted column. */
}
function fillInPeriod()
{
	problem = 0;
	linkCount = 0;
	 
	if(tableMade == 0)
	{
		makeTable();
	}
	if(listMade == 0)
	{
		makeList(); 	
	}
	
	document.getElementById("total").innerHTML= " &bull;" + "View has: " + numberRows + " Total Entries - (" + preFrontEndName + ")"; 
	
	//Fill in entries 
	count = 0; 
	for( i = 0; i < row_num * 4; i++)
	{
		if(i % 4 == 0)
		{
			y = totalEntriesP[count].attributes.getNamedItem("name").firstChild.data; 
			tableP.rows[i].cells[0].innerHTML = "";
			links[i] = document.createElement('a');
			links[i].setAttribute("id", "entryLinks"); 
			links[i].innerHTML = y; 
			links[i].setAttribute("href", "factoryEntryStatusNow.html?entry=" + y);
			links[i].setAttribute("onclick", "entryClick(this)");
			tableP.rows[i].cells[0].appendChild(links[i]);
			count++;  
		}
	}
	childArry = new Array(0, 3, 5, 1); 
	
	/* 
	 * Fill in the period names.
	 */
	count = 0;
	child = 7;
	four = 0; 
	valFinal = 0;   
	for(i = 0; i < tableP.rows.length; i++)
	{
		if(i % 4 != 0)
		{
			valFinal = 0; 
			val = totalEntriesP[count].childNodes[1].childNodes[1].childNodes[childArry[four]].attributes[0].value; 
			val2 = val % 60; /* Remaining seconds */

			/* Minutes */ val3 = val / 60;
			valFinal = val3 + " mins"; 
			
			/* If more than 60 minutes converto hours. */
			if(val3 > 60)
			{
				/* Hours */ val4 = val3 / 60; 
				valFinal = val4 + " hours"; 

				/* If hours more than 24 convert to days. */	
				if(val4 > 24)
				{
					/* Days */ val5 = val4 / 24;
					valFinal = val5 + " days"; 
					
					/* If more than 365 days convert to years. */
					if(val5 > 365)
					{
						/* Years */ val6 = val5/ 365; 
						valFinal = val6 + " years"; 
					}
				}
			}
			
			tableP.rows[i].cells[0].innerHTML = valFinal;
			if(childArry[four] == 3)
			{
				tableP.rows[i].cells[0].setAttribute("bgColor", "#6495ED"); 
			}
			else if(childArry[four] == 5)
			{
				tableP.rows[i].cells[0].setAttribute("bgColor", "#388E8E"); 
			}
			else if(childArry[four] == 1)
			{
				tableP.rows[i].cells[0].setAttribute("bgColor", "#8E388E"); 
			}
			four++; 
			if(four == 4)
			{
				four = 0; 
				count++; 
			}
		}
		else
		{
			if(childArry[four] == 0)
			{
				four++; 
				tableP.rows[i].cells[1].innerHTML = "Now";
				tableP.rows[i].cells[1].setAttribute("bgColor", "#515151"); 
				continue; 
			}
			valFinal = 0; 
			val = totalEntriesP[count].childNodes[1].childNodes[1].childNodes[childArry[four]].attributes[0].value; 
			val2 = val % 60; /* Remaining seconds */

			/* Minutes */ val3 = val / 60;
			valFinal = val3 + " mins"; 
			
			/* If more than 60 minutes converto hours. */
			if(val3 > 60)
			{
				/* Hours */ val4 = val3 / 60; 
				valFinal = val4 + " hours"; 

				/* If hours more than 24 convert to days. */	
				if(val4 > 24)
				{
					/* Days */ val5 = val4 / 24;
					valFinal = val5 + " days"; 
					
					/* If more than 365 days convert to years. */
					if(val5 > 365)
					{
						/* Years */ val6 = val5/ 365; 
						valFinal = val6 + " years"; 
					}
				}
			}
			tableP.rows[i].cells[1].innerHTML = valFinal;
			four++; 
		}	
	}
	
	/* 
	 * Fill in status fields.  
	 */
	var attArry = new Array(13,10,16,12,14,15,11,9); 
	var attArry2 = new Array(4,1,7,3,5,6,2,0); 
	attCount = 0;
	att2Count = 0; 
	child = 1; 
	count = 0;
	for(i = 0; i < totalEntriesP.length; i++)
	{
		child = 1;
		for(j = 0; j < 4; j++)
		{ 
			attCount = 0; 
			attCount2 = 0;  
			for(counter = 2; counter <= 9; counter++)
			{
				if(j == 0)
				{
					/* Period elements have one extra att so when going back to totla noew field we move back att by one index. */
					if(total[i].childNodes.length != 0)
					{
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
						{	
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[feStatChild].attributes[attArry2[attCount2]].nodeValue;
						}
						else
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[totStatChild].attributes[attArry2[attCount2]].nodeValue;
					}
					else
					{
						tableP.rows[count].cells[counter].innerHTML = 0;
					}
					attCount2++; 
					continue;
				}
				try
				{
					x = totalP[i].childNodes[1].childNodes[childArry[j]].attributes[attArry[attCount]].nodeValue; 
					x = Math.round(x * 100)/100; 
				   	tableP.rows[count].cells[counter - 1].innerHTML = x; 
					attCount++; 
				}
				catch(err)
				{
				   	tableP.rows[count].cells[counter - 1].innerHTML = 0; 
					attCount++;
				}
			}
			count++; 	
		}
 	}
	
	/*
	 * Fill in requested fields. 
	 */
	var attArry = new Array(8,7);
	var attArry2 = new Array(1,0); 
	attCount = 0;
	attCount2 = 0; 
	child = 1; 
	count = 0; 
	for(i = 0; i < totalEntries.length; i++)
	{
		child = 1;
		for(j = 0; j < 4; j++)
		{ 
			attCount = 0; 
			attCount2 = 0;  
			for(counter = 10; counter <= 11; counter++)
			{
				if(j == 0)
				{
					/* Period elements have one extra att so when going back to totla noew field we move back att by one index. */
					if(total[i].childNodes.length != 0)
					{
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
						{	
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[feReqChild].attributes[attArry2[attCount2]].nodeValue;
						}
						else
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[totReqChild].attributes[attArry2[attCount2]].nodeValue;					
					}
					else
					{
						tableP.rows[count].cells[counter].innerHTML = 0;
					}
					attCount2++; 
					continue;
				}
				try
				{
					x = totalP[i].childNodes[1].childNodes[childArry[j]].attributes[attArry[attCount]].nodeValue;
					x = Math.round(x * 100)/100; 
					tableP.rows[count].cells[counter - 1].innerHTML = x; 
					attCount++; 
				}
				catch(err)
				{
					tableP.rows[count].cells[counter - 1].innerHTML = 0; 
					attCount++; 
				}
				
			}
			count++; 	
		}	
 	}
	
	/* 
     * Fill in client monitor fields 
 	 */
	var attArry = new Array(2,6,1,5,3,4); 
	var attArry2 = new Array(1,5,0,4,2,3); 
	attCount = 0;
	attCount2 = 0; 
	child = 1; 
	count = 0; 
	for(i = 0; i < totalEntriesP.length; i++)
	{
		child = 1;
		for(j = 0; j < 4; j++)
		{ 
			attCount = 0; 
			attCount2 = 0;  
			for(counter = 12; counter <= 17; counter++)
			{
				if(j == 0)
				{
					/* Period elements have one extra att so when going back to totla noew field we move back att by one index. */
					if(total[i].childNodes.length != 0)
					{
						if(frontEnd && frontEndName != "Any" && frontEndName != "Total")
						{	
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[feCMChild].attributes[attArry2[attCount2]].nodeValue;
						}
						else
							tableP.rows[count].cells[counter].innerHTML = total[i].childNodes[totCMChild].attributes[attArry2[attCount2]].nodeValue;					
					}
					else
					{
						tableP.rows[count].cells[counter].innerHTML = 0;
					}
					attCount2++; 
					continue;
				}
				try
				{
					x = totalP[i].childNodes[1].childNodes[childArry[j]].attributes[attArry[attCount]].nodeValue;
					x = Math.round(x * 100)/100; 
					tableP.rows[count].cells[counter - 1].innerHTML = x; 
					attCount++;
				}
				catch(err)
				{
					tableP.rows[count].cells[counter - 1].innerHTML = 0; 
					attCount++;
				}
			}
			count++; 	
		}	
 	}
}
</script>
<style = "text/css">

td
{
	border: 2px solid #BBB;
	border-width: thin;
	font-size:12px;
	padding:5px;
}
#title
{
	color: #000; 	
	font: bold 330%/100% "Times New Roman";
	text-decoration:none;
	left:50%; 
}
#table, #trTable
{
	table-layout: fixed; 
	width: 100%; 
	background-color:#F2F2F2;
}
#total
{
	color:#D00;
}
#entries
{
	font-weight: bold;
}
#thead, #trHeader
{
	table-layout: fixed;
 	width: 99%; 
	text-align:left;
}
#button
{
   font-family:Lucida Console,monospace;  
   font-weight:bold;
   color: #330000;
   width: 110px;
}
#choose 
{
	margin-left:auto;
	margin-right:auto;
	margin: 0;
	padding: 0;
	width: 170px;
}
#select
{
	color:#300;
	font-size:12px;
	font-weight:bold;
}
#update
{
	color: #303;
	font-size:13px;
	text-align: left;  
}
#scroll
{
	overflow: scroll;
	width: auto;
	min-height:90%; 
}
#hoverpopup
{
	visibility:hidden;
	position:absolute; 
	top:0; left:0;
	background-color: #999;
}
#link
{
	font-family:Lucida Console,monospace;   
	font-weight:bold;
	color: #330000;
    width: 70px;
	float:right;
}
#client, #status, #requested, #difference
{
	font-weight:bold;
	text-align:center;
}
#entryLinks
{
	text-decoration:none;
	font-weight:bold;
	color:#000;
}
#gptions
{
	float:right;
}
#periodH
{
	font-weight:bold;
	text-align:center;
}
</style>

</head>
<body onResize="setHeight()">
<script type = "text/javascript"> loadXML2()  </script>
<a id = "title"  style="font-size: 40px" > Glidein Factory Status </a>

<SELECT id="destination" style="float:right" onchange="goToDestination(this)" >
<OPTION VALUE="" >Choose a Glidein destination...</OPTION>
<OPTION VALUE="factoryEntryStatusNow.html"> Glidein entry. </OPTION>
<OPTION VALUE="factoryStatus.html"> Glidein factory status. </OPTION>
<OPTION VALUE="factoryLogStatus.html"> Glidein factory log status. </OPTION>
<OPTION VALUE="factoryCompletedStats.html"> Glidein factory completed stats. </OPTION>
<OPTION VALUE="factoryRRDBrowse.html"> Glidein factory browse. </OPTION>
<OPTION VALUE="factoryRRDEntryMatrix.html"> Glidein factory entry matrix. </OPTION>
</SELECT>

<h5 id = "total">(Total Entries)</h5>

<div id = "select">Select a view: <input type="checkbox" id = "active" name="option1" value="active" onclick= "selectActive()" >Active only
<input type="checkbox" id = "troubleshoot" name="option2" value="troubleshoot" onclick= "troubleshooting()" > Troubleshoot
<input type="checkbox" id = "period" name="option3" value="troubleshoot" onclick= "period()" > Period <br /> </div> 

<div id = "tempList"></div>
                      
<br /><br /><br /><br />

<form  > <input id = "button" type="button" value="Update Table"  onclick="updateTable()"/> </form>
<form  > <input id = "link" type="button" value="Link" onclick="goToLink()" /> </form>

<br /><div id = "update"> Loading...  </div>
<div id = "preHeader"> </div>
<div id = "header" > </div>
<div id = "scroll"></div> 
<div id = "hoverpopup"></div>


</body>
</html>
