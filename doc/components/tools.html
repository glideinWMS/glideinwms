<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
  <title>glideinWMS Tools</title>
  <link rel="stylesheet" type="text/css" href="../common/glideinWMS.css" media="screen, projection" />
</head>

<body lang="en-US" dir="ltr">
    <h1>
        <a href="index.html">GlideinWMS</a>
	<span>The Glidein-based Workflow Management System</span>
    </h1>
    <ul class="breadcrumbs">
        <li><a href="../index.html">Home</a></li>
        <li><a href="./index.html">Components</a></li>
        <li>Tools</li>
    </ul>
    <div class="clear" />
    <div class="leftmenu">
        <ul class="components">
	        <li> <a href="../index.html">Home</a></li>
	        <li> <a href="../download.html">Download</a></li>
	        <li> <a href="../frontend/index.html">Glidein Frontend</a></li>
            <li> <a href="../corral.html">Corral Frontend</a></li>
	        <li> <a href="../factory/index.html">WMS Factory</a></li>
	        <li> <a href="../components/index.html" >Components</a></li>
	        <li> <a href="../components/faq.html" class="last">FAQ</a></li>
        </ul>
        <div class="search">
            <div id="cse-search-form" style="width: 100%;">Loading</div>
            <script src="http://www.google.com/jsapi" type="text/javascript"></script>
            <script src="../common/glidein.js" type="text/javascript"></script>
            <script type="text/javascript">
            google.load('search', '1', {language : 'en', style : google.loader.themes.MINIMALIST});
            google.setOnLoadCallback(onLoad);
            </script>
        </div>
    </div>
    <div id="searchcontent"><h2>Search Results</h2><div id="cse"></div> </div>
<div class="content">
    <div class="heading">

    <img align="right" width="280px" border="0px"
        src="../images/simple_diagram.png" usemap="#rightimage">
    <map name="rightimage">
        <area shape="rect" coords="90,3,177,60" href="../frontend/index.html" />
        <area shape="rect" coords="5,88,118,146" href="../components/collector_install.html" />
        <area shape="rect" coords="134,88,275,146" href="../factory/index.html" />
        <area shape="rect" coords="189,3,274,60" target="_blank" href="../corral.html" />
    </map>


    <h2>Components</h2>
	<ul class="subcomponents">
	     <li> Overview</li>
	     <li> <a href="./prerequisites.html">Prerequisites</a></li>
	     <li> <a href="./collector_install.html">User Pool</a></li>
	     <li> <a href="./pool_install.html">User Schedd</a></li>
         <li> <a href="./gsi.html">GSI</a></li>
	     <li class="last"> <a href="./condor.html">HTCondor</a></li>
	</ul>
        <h3>Tools</h3>
	</div>
<div class="jump">
<u>Jump to:</u>
<ol>
        <li><a href="#glidecondor_addDN">
                Add a DN to the Condor mapfile<br/>
                (glidecondor_addDN)</a>
        <li><a href="#glidecondor_createSecSched">
                Add secondary Condor schedds<br/>
                (glidecondor_createSecSched)</a>
        <li><a href="#glidecondor_createSecCol">
                Add Condor collectors <br/>
                (glidecondor_createSecCol)</a>
        <li><a href="#create_condor_tarball">
                Adding Condor tarballs<br/>
                (create_condor_tarball)</a>
</ol>
</div>
<div class="related">
Related Links: <br/>
<!--
<ul>
        <LI><A HREF="./custom_scripts.html">Custom Scripts</A></li>
        <LI><A HREF="./custom_vars.html">Custom Variables</A></li>
</ul>
-->
</div>

<!-- -------------------------------------------------------- -->
<hr width="90%"/>
<div class="section">
<a name="glidecondor_addDN"/><h4><b>glidecondor_addDN</b></h4>
<p>
The <tt>glidecondor_addDN</tt> script (found in the ./install directory of 
the glideinWMS tree) can help manage Condor mapfiles.  The management of 
DNs and authorization to specific users can be confusing and this utility
can help.
</p>
<p>
It has two usage modes:
<ol>
<li> Add a single DN:<br>
<blockquote>
 glidecondor_addDN <i>[options]</i> [-daemon <i>comment</i>] <i>DN_or_certfile</i> <i>user</i>
</blockquote>
</li>
<li> Add DNs from a list file:<br>
<blockquote>
  glidecondor_addDN <i>[options]</i> -import <i>listfile</i>*
</blockquote>
</li>
</ol>
</p>
<p>
Where <i>[options]</i> is any combination of:
<table class="requirements">
 <tr><td>-m <i>fname</i></td>
     <td>By default, the script will find the certificate_mapfile by invoking
         <blockquote>
           condor_config_val CERTIFICATE_MAPFILE
         </blockquote>
         Use this option to specify a different file name (mostly useful for prototyping).</td></tr>
 <tr><td>-d <i>fname</i></td>
     <td>By default, the script will put the daemon DNs into <tt>90_gwms_dns.config</tt> in the Condor's <tt>LOCAL_CONFIG_DIR</tt> (obtained via <tt>condor_config_val</tt>).<br>
         Use this option to specify a different file name (mostly useful for prototyping).</td></tr>
 <tr><td>-allow-alterate</td>
     <td>If present, the tool will look for alternate config files (e.g. condor_config.local)
         to put daemon DNs into.</td></tr>
 <tr><td>-disable-checks</td><td>Without it, valid config files must already be present.</td></tr>
 <tr><td>-recreate</td>
     <td>By default, the tool will add to existing files.<br>
         If this option is present, it will destroy any existing configuration files, and create new ones instead.</td></tr>
 <tr><td>-allow-others</td>
     <td>By default when <tt>-recreate</tt> is used, the new config files will override any existing DN attributes (i.e. <i>GSI_DAEMON_NAME</i>).<br>
         If you want to preserve the settings from other config files, use this option.</td></tr>
 <tr><td>-q</td><td>Quiet operation.</td></tr>
</table>
</p>
<p>
In both operation modes, the tool will add properly encoded (DN,username) entries in the certificate mapfile,
and, iif the DN is tagged as belonging to a trusted daemon, also in the DN config file.
</p>
<p>
In both modes, the DN can be the actual DN string, or a certificate from which to extract the string from.
The tool will try to guess which one you are using, but you can also force it by prepending it with either
<tt>dn:</tt> or <tt>file:</tt>.
</p>
<p>
The <i>listfile</i> contains one DN per line; lines starting with a hash (#) or that are completely empty, are ignored.<br>
Each line must have exactly three columns, separated by any number of spaces:
<blockquote>
<i>user type DN_or_certfile</i>
</blockquote>
</p>
<p>
The <i>DN_or_cerfile</i> can contain spaces, and <b>MUST NOT</b> be quoted.
</p>
<p>
The <i>type</i> columns must be either <tt>daemon</tt> or <tt>client</tt>.
</p>
<p>
Example of the first type:
</p>
<blockquote>
   glidecondor_addDN -daemon "My own host certificate DN" file:/etc/grid-security/hostcert.pem condor
</blockquote>
<p>
Example of the second type:
</p>
<blockquote>
   cat pool_dns.list
<pre>
# This file contains the pool DNs
# Format           
# user type   DN
condor daemon file:/etc/grid-security/hostcert.pem
ce2    daemon /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=osg-glidein-ce-2.example.edu
ce1    daemon dn:/DC=org/DC=doegrids/OU=Services/CN=osg-glidein-ce.example.edu
pilot1 daemon /DC=org/DC=doegrids/OU=Services/CN=osgpilot01/osg-glidein-fe.example.gov
fe1    client /DC=org/DC=doegrids/OU=Services/CN=osg-glidein-fe.example.gov
</pre>
   glidecondor_addDN -recreate -disable-checks -import pool_dns.list
</blockquote>
</div>

<!-- -------------------------------------------------------- -->
<hr width="90%"/>
<div class="section">
<a name="glidecondor_createSecSched"/><h4><b>glidecondor_createSecSched</b></h4>
<p>
The <tt>glidecondor_createSecSched</tt> script (found in the ./install directory of 
the glideinWMS tree) can help manage the HTCondor's secondary schedds. It can be used
when HTCondor's configuration is stored in 
<a href="http://research.cs.wisc.edu/htcondor/manual/v7.8/3_3Configuration.html#param:LocalConfigDir">LOCAL_CONFIG_DIR</a>.
</p>
<p>
Usage:
</p>
<blockquote>
   glidecondor_createSecSched [-commonlog] [-nocreatedirs] </i>scheddlist</i>
</blockquote>
<p>
This script will re-create the <tt>11_gwms_secondary_schedds.config</tt> file at each invocation.
The node admin can thus easily change the number of secondary schedds as needed.
</p>
<p>
By default, each secondary schedd will have its own log file. 
If a shared log is desired, use <tt>-commonlog</tt>.<br>
Please <b>note</b> that the tool does not try to guess what the existing config, if any, is using.
</p>
<p>
By default, the tool will create any needed directories. 
If you are sure the directories are already in place, e.g. beacuse you are just reducing the number of secondary schedds,
you can use <tt>-nocreatedirs</tt> to speed it up.
</p>
<p>
Example:
</p>
<blockquote>
   glidecondor_createSecSched schedd_glideins1,schedd_glideins2
</blockquote>
</div>

<!-- -------------------------------------------------------- -->
<hr width="90%"/>
<div class="section">
<a name="glidecondor_createSecCol"><h4><b>glidecondor_createSecCol</b></h4>
 <p>
The <tt>glidecondor_createSecCol</tt> script (found in the ./install directory of 
the glideinWMS tree) can help manage the HTCondor's secondary collectors. It can be used
when HTCondor's configuration is stored in 
<a href="http://research.cs.wisc.edu/htcondor/manual/v7.8/3_3Configuration.html#param:LocalConfigDir">LOCAL_CONFIG_DIR</a>.
</p>
<p>
Usage:
</p>
<blockquote>
   glidecondor_createSecCol [-useportasname] [-commonlog] <i>portrange</i>
</blockquote>
<p>
This script will re-create the <tt>11_gwms_secondary_collectors.config file</tt> file at each invocation.
The node admin can thus easily change the number of secondary collectors as needed.
</p>
<p>
Since each Condor Daemon needs a unique name, each collector will be called COLLECTOR<i>xxx</i>.
By default, the numbering starts with 0 for the first collector in the port range, and is incremented by one for each additional one.<br>
If <tt>-useportasname</tt> is used, <i>xxx</i> is instread defined as the port number used by the collector.<br>
Please <b>note</b> that the tool does not try to guess what the existing config, if any, is using.
</p>
<p>
By default, each secondary collector will have its own log file. 
If a shared log is desired, use <tt>-commonlog</tt>.<br>
Please <b>note</b> that the tool does not try to guess what the existing config, if any, is using.
</p>
<p>
Example:
</p>
<blockquote>
   glidecondor_createSecCol 9620-9639
</blockquote>
</div>

<!-- -------------------------------------------------------- -->
<hr width="90%"/>
<div class="section">
<a name="create_condor_tarball"><h4><b>create_condor_tarball</b></h4>
 <p>
The <tt>create_condor_tarball</tt> script 
(found in the ./factory/creation directory of the glideinWMS tree) 
can help reduce the disk space needs on the factory node.
<p/>
It can be used to create a condor tarball for use by the glideinwms pilot process for various entry points.  
The glideinwms pilot does not need all the files/processes contained in a normal HTCondor tarfile.  
This utility extracts only the needed processes/libraries thereby reducing the space needed on your factory node.
</p>
<pre>
Usage: create_condor_tarball output_filename input_tarfile_or_dir

   output_filename - file name of the output tarball created

   input_tarfile_or_dir - this is the source tarfile or if already expanded,
                          the top level directory.
</pre>
Once the output condor tarball is created, additional configuration is required in 
the factory configuration file.  Refer to the 
<a href="../factory/configuration.html#tarballs">Multiple Condor Tarballs section of the Factory Configuration</a> document for details.

<p>
</p>
<p>
Example:
</p>
<blockquote>
  create_condor_tarball   /tmp/condor-7.7.5     condor-7.7.5-x86_64_rhap_5-stripped.tar.gz
</blockquote>
</div>


<!-- -------------------------------------------------------- -->
<hr width="90%"/>
<div class="section">
<h4><b>Other monitoring tools</b></h4>
<p>
The tools <tt>analyze_entries</tt>,<tt>analyze_queues</tt>, and 
<tt>analyze_frontends</tt> exist in the <tt>factory/tools</tt> directory.
They can be used to monitor recent status of the factory, entries,
and connected frontends. See <a href="../factory/monitoring.html#analyze_entries">Factory monitoring</a> for more details.
</p>
</div>
<div class="footer">
Banner image by
<a href="http://www.flickr.com/people/leafwarbler/">Madhusudan Katti</a>
used under Creative Commons license.<br>
Original Home URL: <a href="http://glideinwms.fnal.gov">http://glideinwms.fnal.gov</a>.
glideinWMS email support: glideinwms-support at fnal.gov
</div>
</div>
</body>
</html>
